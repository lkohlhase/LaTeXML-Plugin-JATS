<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/lnk/Desktop/LaTeXML-Plugin-JATS/development"?>
<?latexml class="IEEEtran" options="journal"?>
<?latexml package="ulem"?>
<!-- %“usepackage–cite˝ -->
<!-- %“MidlineHeight=0.4ex -->
<!-- %“UMOlineThickness=0.2ex -->
<!-- %“usepackage[dvipdfmx]–graphicx˝ -->
<?latexml package="graphicx" options="dvips"?>
<?latexml package="bm"?>
<?latexml package="times"?>
<?latexml package="amsmath"?>
<?latexml package="amssymb"?>
<?latexml package="algorithm"?>
<?latexml package="algorithmic"?>
<!-- %**** ieee˙daa.tex Line 25 **** -->
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line" xml:id="Document">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <resource src="ltx-ulem.css" type="text/css"/>
  <title fontsize="172%" font="bold">Nonparametic Bayesian Double Articulation Analyzer<break/>for Direct Language Acquisition from Continuous Speech Signals</title>
  <creator role="author">
    <personname>Tadahiro Taniguchi<Math mode="inline" xml:id="m1" tex="{}^{1}" text="^1" fragid="m1"><XMath><XMApp role="FLOATSUPERSCRIPT" scriptpos="3"><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math></personname>
    <contact role="thanks">This research was partially supported by a Grant-in-Aid for Young Scientists (B) 2012-2014 (24700233) funded by the Ministry of Education,
Culture, Sports, Science, and Technology, Japan.</contact>
    <contact role="thanks"><Math mode="inline" xml:id="m2" tex="{}^{1}" text="^1" fragid="m2"><XMath><XMApp role="FLOATSUPERSCRIPT" scriptpos="4"><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>T. Taniguchi is with College of Information Science and Engineering, Ritsumeikan University, 1-1-1 Noji Higashi, Kusatsu, Shiga 525-8577, Japan <text fontsize="90%" font="typewriter">taniguchi@em.ci.ritsumei.ac.jp</text></contact>
  </creator>
  <creator role="author" before="  ">
    <personname> Shogo Nagasaka<Math mode="inline" xml:id="m3" tex="{}^{2}" text="^2" fragid="m3"><XMath><XMApp role="FLOATSUPERSCRIPT" scriptpos="3"><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math></personname>
    <contact role="thanks"><Math mode="inline" xml:id="m4" tex="{}^{1}" text="^1" fragid="m4"><XMath><XMApp role="FLOATSUPERSCRIPT" scriptpos="4"><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>S. Nagasaka and R. Nakashima are with the Graduate School of Information Science and Engineering, Ritsumeikan University, 1-1-1 Noji Higashi, Kusatsu, Shiga 525-8577, Japan <text fontsize="90%">{<text font="typewriter"> s.nagasaka, nakashima</text>}<text font="typewriter">@em.ci.ritsumei.ac.jp</text></text></contact>
  </creator>
  <creator role="author" before="  ">
    <personname> Ryo Nakashima<Math mode="inline" xml:id="m5" tex="{}^{2}" text="^2" fragid="m5"><XMath><XMApp role="FLOATSUPERSCRIPT" scriptpos="3"><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math></personname>
  </creator>
  <abstract name="Abstract">
    <p>Human infants can discover words directly from unsegmented speech signals without any explicitly labeled data. In this paper, we develop a novel machine learning method called nonparametric Bayesian double articulation analyzer (NPB-DAA) that can directly acquire language and acoustic models from observed continuous speech signals. For this purpose, we propose an integrative generative model that combines a language model and an acoustic model into a single generative model called the “hierarchical Dirichlet process hidden language model” (HDP-HLM). The HDP-HLM is obtained by extending the hierarchical Dirichlet process hidden semi-Markov model (HDP-HSMM) proposed by Johnson et al. An inference procedure for the HDP-HLM is derived using the blocked Gibbs sampler originally proposed for the HDP-HSMM. This procedure enables the simultaneous and direct inference of language and acoustic models from continuous speech signals. Based on the HDP-HLM and its inference procedure, we developed a novel double articulation analyzer.
By assuming HDP-HLM as a generative model of observed time series data, and by inferring latent variables of the model, the method can analyze latent double articulation structure, i.e., hierarchically organized latent words and phonemes, of the data in an unsupervised manner.
The novel unsupervised double articulation analyzer is called NPB-DAA.
The NPB-DAA can automatically estimate double articulation structure embedded in speech signals. We also carried out two evaluation experiments using synthetic data and actual human continuous speech signals representing Japanese vowel sequences. In the word acquisition and phoneme categorization tasks, the NPB-DAA outperformed a conventional double articulation analyzer (DAA) and baseline automatic speech recognition system whose acoustic model was trained in a supervised manner.</p>
  </abstract>
  <!-- %**** ieee˙daa.tex Line 50 **** -->
  <ERROR class="undefined">{IEEEkeywords}</ERROR>
  <para xml:id="p1" fragid="p1">
    <p>Language acquisition, child development, Bayesian nonparametrics, latent variable model</p>
  </para>
  <ERROR class="undefined">\IEEEpeerreviewmaketitle</ERROR>
  <section refnum="1" xml:id="S1" labels="LABEL:sec1" fragid="S1">
    <title><tag close=" ">1</tag>INTRODUCTION</title>
    <ERROR class="undefined">\IEEEPARstart</ERROR>
    <para xml:id="S1.p1" fragid="S1.p1">
      <p>INFANTS must solve the word segmentation problem in order to acquire language from the continuous speech signals to which they are exposed. The word segmentation problem is that of identifying word boundaries in continuous speech. If the speech signals are given to infants as isolated words, the task is easy for them. However, it has been known that a relatively small number of infant-directed utterances consist of an isolated word <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Aslin1996" title="Aslin1996">Aslin1996</ref>]</cite>.
If infants had knowledge about words and phonemes innately, the problem could be solved relatively easily.
However, the fact that each language has different lists of phonemes and words clearly shows that infants have to acquire them through developmental processes.</p>
    </para>
    <para xml:id="S1.p2" fragid="S1.p2">
      <p>From the viewpoint of statistical learning, the learning problem, i.e., direct language acquisition from continuous speech signals, is very difficult because infants do not have access to the truth labels of speech recognition results. In other words, the language acquisition process must be completely unsupervised, in contrast with most current automatic speech recognition (ASR) systems.</p>
    </para>
    <para xml:id="S1.p3" fragid="S1.p3">
      <p>Most modern ASR systems have a language model that represents knowledge about words and their distributional probabilities as well as an acoustic model that represents knowledge about phonemes and their acoustic features. Both are usually trained using large transcribed speech datasets and linguistic corpora through supervised learning. However, infants do not have access to such explicitly labeled datasets.
They have to acquire both language and acoustic models from raw acoustic speech signals in an unsupervised manner.</p>
    </para>
    <para xml:id="S1.p4" fragid="S1.p4">
      <p>The question about what kind of cues human infants utilize to discover words from continuous speech signals arises.
Saffran et al. listed three types of cues for word segmentation: prosodic, distributional, and co-occurrence <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Saffran1996a" title="Saffran1996a">Saffran1996a</ref>]</cite>.
<!-- %**** ieee˙daa.tex Line 75 **** -->Prosodic cues rely on acoustic information, such as post-utterance pauses, stressed syllables, and acoustically distinctive final syllables.
Distributional cues represent the statistical relationships between neighboring speech sounds.
Co-occurrence cues are used by children to learn words by detecting which sounds co-occurs with entities in the environment.
Although many researchers had considered the distributional cues to be too complex for infants to use,
Saffran reported that word segmentation from fluent speech can be accomplished by 8-month-old infants based on solely on distributional cues <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Saffran1996" title="Saffran1996">Saffran1996</ref>]</cite>. It is also reported that the distributional cues seem to be used
by infants by the age of 7 months, which is earlier than most other cues <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Thiessen2003" title="Thiessen2003">Thiessen2003</ref>]</cite>.
These results imply that infants have a fundamental mechanism that can estimate word segments using distributional cues. In addition to this fundamental segmentation mechanism using distributional cues, the prosodic and co-occurrence cues are believed to help the word segmentation task only as
supplemental cues. In addition, from the viewpoint of phonemic category acquisition, distributional patterns of sounds have been considered to provide infants with clues about the phonemic structure of a language <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Kuhl2007" title="Kuhl2007">Kuhl2007</ref>]</cite>.</p>
    </para>
    <para xml:id="S1.p5" fragid="S1.p5">
      <p>Based on these findings, in this paper, we focus on distributional cues.
We explore the fundamental computational mechanism that can discover words from speech signals using only distributional cues, and develop an unsupervised machine learning method which can discover phonemes and words directly from unsegmented speech signals</p>
    </para>
    <para xml:id="S1.p6" fragid="S1.p6">
      <p>In this paper, we propose an unsupervised learning method called the nonparametric Bayesian double articulation analyzer (NPB-DAA) which can automatically estimate double articulation structure, i.e., hierarchically organized latent words and phonemes, embedded in speech signals. We proposed it as a computationally feasible explanation for the simultaneous acquisition of language and acoustic models. To develop the NPB-DAA, we newly introduce probabilistic generative model called the hierarchical Dirichlet process hidden language model (HDP-HLM) and its inference algorithm.</p>
    </para>
    <para xml:id="S1.p7" fragid="S1.p7">
      <p>The remainder of this paper is organized as follows.
Section <ref labelref="LABEL:sec2" href="#S2" title="2 Background ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">2</text></ref> describes the background of the proposed method.
Section <ref labelref="LABEL:sec3" href="#S3" title="3 Generative model ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">3</text></ref> presents the HDP-HLM by extending hierarchical Dirichlet process-hidden semi-Markov model (HDP-HSMM) proposed by Johnson et al. <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>. The HDP-HLM is an probabilistic generative model that integrates acoustic and language models for continuous speech signals.
Section <ref labelref="LABEL:sec4" href="#S4" title="4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4</text></ref> describes the inference procedure of HDP-HLM, and our proposed NPB-DAA. Sections <ref labelref="LABEL:sec5" href="#S5" title="5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">5</text></ref> and <ref labelref="LABEL:sec6" href="#S6" title="6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">6</text></ref> evaluate the effectiveness of the proposed method using synthetic data and actual sequential vowel speech signals. Section <ref labelref="LABEL:sec7" href="#S7" title="7 Conclusion ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">7</text></ref> concludes this paper.</p>
    </para>
  </section>
  <section refnum="2" xml:id="S2" labels="LABEL:sec2" fragid="S2">
    <title><tag close=" ">2</tag>Background</title>
    <subsection refnum="2.1" xml:id="S2.SS1" fragid="S2.SS1">
      <title><tag close=" ">2.1</tag>Word segmentation using distributional cues in transcribed data</title>
      <para xml:id="S2.SS1.p1" fragid="S2.SS1.p1">
        <p>With respect to statistical computational models, many kinds of unsupervised machine learning methods for word segmentation have been proposed in the last two decades <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Brent1999" title="Brent1999">Brent1999</ref>, <ref class="ltx_missing_citation" idref="Venkataraman2001" title="Venkataraman2001">Venkataraman2001</ref>, <ref class="ltx_missing_citation" idref="Goldwater2008" title="Goldwater2008">Goldwater2008</ref>, <ref class="ltx_missing_citation" idref="Goldwater2009" title="Goldwater2009">Goldwater2009</ref>, <ref class="ltx_missing_citation" idref="Mochihashi2009" title="Mochihashi2009">Mochihashi2009</ref>, <ref class="ltx_missing_citation" idref="Johnson2009" title="Johnson2009">Johnson2009</ref>, <ref class="ltx_missing_citation" idref="Chen2014" title="Chen2014">Chen2014</ref>, <ref class="ltx_missing_citation" idref="Magistry2012" title="Magistry2012">Magistry2012</ref>, <ref class="ltx_missing_citation" idref="Sakti2011" title="Sakti2011">Sakti2011</ref>]</cite>.
Brent proposed model-based dynamic programming 1 (MBDP-1) for recovering deleted word boundaries in a natural-language text <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Brent1999" title="Brent1999">Brent1999</ref>]</cite>. The MBDP-1 presumes that there is an information source generating the text explicitly and segments the target text so as to maximize the text’s probability. Venkataraman proposed a statistical model for segmentation and word discovery from phoneme sequences by improving Brent’s algorithm <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Venkataraman2001" title="Venkataraman2001">Venkataraman2001</ref>]</cite>.
<!-- %**** ieee˙daa.tex Line 100 **** --></p>
      </para>
      <para xml:id="S2.SS1.p2" fragid="S2.SS1.p2">
        <p>Recently, Bayesian nonparametrics, including the hierarchical Dirichlet process and hierarchical Pitman-Yor process, have enabled more sophisticated methods for word segmentation. These models have fully Bayesian generative models and make it possible to calculate the appropriately smoothed n-gram probability for a word that has a long context. Theoretically, they can treat an infinite number of possible words.
Goldwater proposed an HDP-based word segmentation method and showed that taking context into account is important for statistical word segmentation <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Goldwater2008" title="Goldwater2008">Goldwater2008</ref>, <ref class="ltx_missing_citation" idref="Goldwater2009" title="Goldwater2009">Goldwater2009</ref>]</cite>.
Mochihashi et al. proposed a nested Pitman-Yor language model (NPYLM), in which a letter n-gram model based on a hierarchical Pitman-Yor language model is embedded in the word n-gram model. They also developed the forward filtering backward sampling procedure to achieve efficient blocked Gibbs sampling and hence infer word boundaries <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Mochihashi2009" title="Mochihashi2009">Mochihashi2009</ref>]</cite>.</p>
      </para>
      <para xml:id="S2.SS1.p3" fragid="S2.SS1.p3">
        <p>However, all of the above mentioned word segmentation methods presume that transcribed phoneme sequences or text data without any recognition errors can be obtained by the learning system.
However, in practice, before acquiring a language model containing an inventory of words, a learning system, i.e., an infant, has to recognize speech signals without any knowledge of words, only with the knowledge of phonemes and/or syllables in an acoustic model. In such a recognition task, the phoneme recognition error rate inevitably becomes high.
To overcome this problem, several researchers have proposed word discovery methods utilizing co-occurrence cues.</p>
      </para>
    </subsection>
    <subsection refnum="2.2" xml:id="S2.SS2" fragid="S2.SS2">
      <title><tag close=" ">2.2</tag>Lexical acquisition using co-occurrence cues</title>
      <para xml:id="S2.SS2.p1" fragid="S2.SS2.p1">
        <p>Roy et al. ambitiously implemented a computational model that enables a robot to autonomously discover words from raw multimodal sensory input <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Roy2002a" title="Roy2002a">Roy2002a</ref>]</cite>. Their results were imperfect compared with recent state-of-art results. However, their results showed it was possible to develop cognitive models that can process raw sensor data and acquire a lexicon without the need for human transcription or labeling.</p>
      </para>
      <para xml:id="S2.SS2.p2" fragid="S2.SS2.p2">
        <p>Iwahashi et al. implemented an interactive learning method for a robot to acquire spoken words through human-robot interaction using audio-visual interfaces <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Iwahashi2008" title="Iwahashi2008">Iwahashi2008</ref>]</cite>. Their learning process was carried out on-line, incrementally, actively, and in an unsupervised manner.
Iwahashi et al. also proposed a method that enables a robot to learn linguistic knowledge through human-robot communication in an unsupervised manner <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Iwahashi2003" title="Iwahashi2003">Iwahashi2003</ref>]</cite>.
The model combines speech, visual, and behavioral information in a probabilistic framework.
Though its performance was still limited, the model is considered to be a more sophisticated model than that proposed in Roy et al.’s previous study from the viewpoint of statistical machine learning <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Roy2002a" title="Roy2002a">Roy2002a</ref>]</cite>.
On the basis of this work, Iwahashi et al. developed an integrated online machine learning system combining speech, visual, and tactile information obtained through interaction. It enabled robots to learn beliefs regarding speech units, words, the concepts of objects, motions, grammar, and pragmatic and communicative capabilities <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Iwahashi2010" title="Iwahashi2010">Iwahashi2010</ref>]</cite>.
They called the system LCore.</p>
      </para>
      <para xml:id="S2.SS2.p3" fragid="S2.SS2.p3">
        <p>Araki et al. built a robot that formed object categories and acquired their names by combining a multimodal latent Dirichlet allocation (MLDA) and the NPYLM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Araki2012" title="Araki2012">Araki2012</ref>]</cite>. They showed that the iterative learning of MLDA and NPYLM increases word segmentation performance by using distributional cues and co-occurrence cues simultaneously, but they reported that the prediction accuracy decreases as the phoneme recognition error rate increases.
To overcome this problem, Nakamura et al. integrated statistical models for word segmentation and multimodal categorization. They showed that a robot can autonomously form object categories and related words from continuous speech signals and continuous visual, auditory, and haptic information by updating its language and categorization models iteratively <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Nakamura2014" title="Nakamura2014">Nakamura2014</ref>]</cite>.</p>
      </para>
      <para xml:id="S2.SS2.p4" fragid="S2.SS2.p4">
        <p>Not only object information, but also place information can be used as co-occurrence cues.
Taguchi et al. proposed a method for the unsupervised learning of place-names from information pairs that consist of spoken utterances and the mobile robot’s estimated current location without any prior linguistic knowledge other than a phoneme acoustic model <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Taguchi2011" title="Taguchi2011">Taguchi2011</ref>]</cite>. They optimized a word list using a model selection method based on description length criterion.
Taniguchi et al. combined NPYLM and Monte Carlo localization (MCL) methods and developed simultaneous localization and word discovery methods for a robot. Their model updates language model and speech recognition results iteratively by referring to the robot’s location information, as estimated by MCL <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Akira2015" title="Akira2015">Akira2015</ref>]</cite>.
<!-- %**** ieee˙daa.tex Line 125 **** --></p>
      </para>
    </subsection>
    <subsection refnum="2.3" xml:id="S2.SS3" fragid="S2.SS3">
      <title><tag close=" ">2.3</tag>Word segmentation using distributional cues in noisy input</title>
      <para xml:id="S2.SS3.p1" fragid="S2.SS3.p1">
        <p>As described above, it becomes clear that using co-occurrence cues can mitigate the ill effects of phoneme recognition errors in a word discovery task. However, whether or not the word discovery task can be achieved solely from raw speech signals is still an open question.
Neubig et al. extended the unsupervised morphological analyzer proposed by Mochihashi et al. and enabled it to analyze phoneme lattices <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Neubig2012" title="Neubig2012">Neubig2012</ref>]</cite>. Heymann et al. modified Neubig et al.’s algorithm and proposed a suboptimal two-stage algorithm <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Heymann2013" title="Heymann2013">Heymann2013</ref>]</cite>. Heymann et al. reported that their proposed method outperformed the original method in an experiment that used lattice input generated artificially from text input. In addition, they used the discovered language model for phoneme recognition in an iterative manner and reported that recognition performance was improved <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Heymann2014" title="Heymann2014">Heymann2014</ref>]</cite>.
Elsner et al. proposed a computational model that jointly performs word segmentation and learns an explicit model of phonetic variation <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Elsner2013" title="Elsner2013">Elsner2013</ref>]</cite>. However, they did not start with acoustic sound, but with dictated noisy text, i.e., recognized phoneme sequences with errors. Their model does not include acoustic model learning.</p>
      </para>
      <figure frefnum="Figure 1" placement="t" refnum="1" xml:id="S2.F1" labels="LABEL:fig:daa" fragid="S2.F1">
        <graphics candidates="daa3.eps" graphic="daa3.eps" options="width=346.896pt" xml:id="S2.F1.g1" class="ltx_centering" fragid="S2.F1.g1" imagesrc="x98.png" imagewidth="540" imageheight="339"/>
        <toccaption class="ltx_centering"><tag close=" ">1</tag>Overview of unsupervised learning of language and acoustic models through human-robot interaction, and the generative process of speech signal assumed in the DAA</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 1</tag>Overview of unsupervised learning of language and acoustic models through human-robot interaction, and the generative process of speech signal assumed in the DAA</caption>
      </figure>
      <para xml:id="S2.SS3.p2" fragid="S2.SS3.p2">
        <p>They showed that the ill effect of phoneme recognition errors can be mitigated to some extent by using distributional information more appropriately.
However, all of these methods, except for Iwahashi et al., used an acoustic model previously trained in a supervised manner. Therefore, these models are insufficient as a constructive model for language acquisition from raw speech signals. Hence, the unsupervised learning of an acoustic model is also an important problem.</p>
      </para>
    </subsection>
    <subsection refnum="2.4" xml:id="S2.SS4" fragid="S2.SS4">
      <title><tag close=" ">2.4</tag>Unsupervised learning of an acoustic model</title>
      <para xml:id="S2.SS4.p1" fragid="S2.SS4.p1">
        <p>In contrast with the word segmentation task, the acquisition of an acoustic model is basically a categorization task of the feature vectors transformed from continuous speech signals.
Mixture models, including hidden Markov models (HMMs) and Gaussian mixture models, have been used to model phoneme category acquisition. For example, Lake et al. used an online mixture estimation model for vowel category learning <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Lake2009" title="Lake2009">Lake2009</ref>]</cite>.
However, the phoneme acquisition has proven to be complex categorization task in a feature space.
<!-- %**** ieee˙daa.tex Line 150 **** -->The distribution of the feature vectors of each phoneme overlap with each other, and the actual sound of the phoneme depends on its context.
Feldman et al. pointed out that feedback information from segmented words is important for phonetic category acquisition. They demonstrated this effect through simulations using Bayesian models <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Feldman2013" title="Feldman2013">Feldman2013</ref>]</cite>.</p>
      </para>
      <para xml:id="S2.SS4.p2" fragid="S2.SS4.p2">
        <p>Lee et al. proposed a hierarchical Bayesian model that can discover a proper set of sub-word units and an acoustic model in an unsupervised manner <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Lee2012" title="Lee2012">Lee2012</ref>]</cite>. However, their model did not estimate the language model.
Lee et al. also proposed a hierarchical Bayesian model simultaneously discovering the phonetic inventory and the Letter-to-Sound mapping rules on the basis of transcribed data only <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Lee2013a" title="Lee2013a">Lee2013a</ref>]</cite>.
The method is not a completely unsupervised learning method from raw speech signals, but does automatically determine relations between sounds and transcribed alphabets and forms an acoustic model in an unsupervised manner.</p>
      </para>
      <para xml:id="S2.SS4.p3" fragid="S2.SS4.p3">
        <p>There have been several studies about the simultaneous unsupervised learning of acoustic and language models.
However, a very small number of statistical learning methods that can simultaneously acquire integrated acoustic and language models have been proposed.
Brandl et al. attempted to develop an unsupervised learning method that enables a robot to simultaneously obtain phonemes, syllables, and words from acoustic speech <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Brandl2008" title="Brandl2008">Brandl2008</ref>]</cite>. They did not successfully build such a system, but reported their preliminary results.
Walter et al. proposed a word discovery method that uses an HMM-based method for finding acoustic unit descriptors in parallel with a dynamic time warping technique for finding word segments <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Walter2013" title="Walter2013">Walter2013</ref>]</cite>. However, their model is still heuristic from the viewpoint of probabilistic computational models.
As Feldman et al. pointed out, word segmentation and phonetic category acquisition are undoubtedly mutually dependent. Therefore, a theoretically integrated probabilistic generative model for the simultaneous acquisition of language and acoustic models is desirable.
To develop such an integrated theoretical model, the authors introduced the general concept of double articulation analysis.</p>
      </para>
    </subsection>
    <subsection refnum="2.5" xml:id="S2.SS5" fragid="S2.SS5">
      <title><tag close=" ">2.5</tag>Double articulation analysis</title>
      <para xml:id="S2.SS5.p1" fragid="S2.SS5.p1">
        <p>From a general point of view, unsupervised word discovery from raw speech signals is regarded as a double articulation analysis of the time series data representing a speech signal.
The double articulation structure is a well-known two-layer hierarchical structure, i.e., a word sequence is generated from a language model, a word is a sequence of phonemes, and each phoneme outputs observation data during the period it persists. The word discovery problem becomes a general problem about analyzing the time series data that potentially have a double articulation structure by estimating the latent acoustic model as well as the latent language model.</p>
      </para>
      <para xml:id="S2.SS5.p2" fragid="S2.SS5.p2">
        <p>Taniguchi et al. proposed a double articulation analyzer (DAA) by combining the sticky HDP-HMM and the NPYLM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Taniguchi2011" title="Taniguchi2011">Taniguchi2011</ref>]</cite>. The sticky HDP-HMM proposed by Fox et al. is an nonparametric Bayesian extension of HMM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Fox2009" title="Fox2009">Fox2009</ref>]</cite>.
They applied the DAA to human motion data to extract unit motion from unsegmented human motion data.
However, they simply used the two nonparametric Bayesian methods sequentially. They did not integrated the two models into a single generative model. Therefore, if there are many recognition or categorization errors in the result of the first latent letter recognition process, i.e., segmentation process by the sticky HDP-HMM, the performance of the subsequent process, i.e., unsupervised chunking by the NPYLM, deteriorates.
In the terminology of a DAA, a latent letter and a latent word basically correspond to a phoneme and a word in speech signals, respectively.
In this paper, we call this method “conventional DAA” in order to differentiate it from the DAA newly proposed in this paper, i.e., NPB-DAA. Conventional DAA has been successfully applied to human motion data and driving behavior data, which were also considered to potentially have a double articulation structure. Conventional DAA has been used for various purposes, e.g., segmentation <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="takenaka12iros" title="takenaka12iros">takenaka12iros</ref>]</cite>, prediction <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="taniguchi12iv" title="taniguchi12iv">taniguchi12iv</ref>, <ref class="ltx_missing_citation" idref="IEEE-ITS" title="IEEE-ITS">IEEE-ITS</ref>]</cite>, data mining <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="genki12sii" title="genki12sii">genki12sii</ref>]</cite>, topic modeling <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="bando13iv" title="bando13iv">bando13iv</ref>, <ref class="ltx_missing_citation" idref="bando13iros" title="bando13iros">bando13iros</ref>]</cite>, and video summarization <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="takenaka12mm" title="takenaka12mm">takenaka12mm</ref>]</cite>.
<!-- %**** ieee˙daa.tex Line 175 **** -->Conventional DAA owes its successful result with respect to driving behavior data to the fact that driving behavior data were continuous and smooth compared with raw speech signals. For a driving letter, which corresponds to a phoneme in continuous speech signals, the recognition error rate was still low.
However, it is expected that a straightforward application of the conventional DAA to raw speech signals will inevitably turn out badly.<!-- %, as it did when applied to driving behavior data. --></p>
      </para>
      <para xml:id="S2.SS5.p3" fragid="S2.SS5.p3">
        <p>Therefore, based on the background mentioned above, in this paper, we propose an integrated probabilistic generative model, HDP-HLM, representing a latent double articulation structure that contains both a language model and an acoustic model. By assuming HDP-HLM as a generative model of observed time series data, and by inferring latent variables of the model, we can analyze latent double articulation structure of the data in an unsupervised manner. A novel double articulation analyzer is developed on the basis of the HDP-HLM and its inference algorithm.
This HDP-HLM-based double articulation analysis method is called NPB-DAA.</p>
      </para>
    </subsection>
  </section>
  <section refnum="3" xml:id="S3" labels="LABEL:sec3" fragid="S3">
    <title><tag close=" ">3</tag>Generative model</title>
    <para xml:id="S3.p1" fragid="S3.p1">
      <p>In this section, we propose a novel generative model, the HDP-HLM, for time series data that potentially has a double articulation structure, by extending HDP-HSMM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>.
As indicated in its name, HDP-HLM latently contains a language model. In contrast with the conventional case where a latent state transits to the next state on the basis of a Markov process in the HDP-HMM, a latent word in the HDP-HLM transits to the next latent word on the basis of a language model.
An illustrative overview of the proposed method and the target task are shown in Fig. <ref labelref="LABEL:fig:daa" href="#S2.F1" title="Figure 1 ‣ 2.3 Word segmentation using distributional cues in noisy input ‣ 2 Background ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">1</text></ref>.
We can naturally derive an inference procedure for the HDP-HLM based on the blocked Gibbs sampler. First, we briefly describe the HDP-HSMM. We then describe the HDP-HLM.</p>
    </para>
    <subsection refnum="3.1" xml:id="S3.SS1" fragid="S3.SS1">
      <title><tag close=" ">3.1</tag>HDP-HSMM</title>
      <para xml:id="S3.SS1.p1" fragid="S3.SS1.p1">
        <p>HDP-HSMM is a nonparametric Bayesian extension of the conventional hidden semi-Markov model (HSMM) <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>, <ref class="ltx_missing_citation" idref="HSMM" title="HSMM">HSMM</ref>]</cite>. Unlike HDP-HMM, which is an nonparametric Bayesian extension of conventional hidden Markov model (HMM) <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Fox2009" title="Fox2009">Fox2009</ref>, <ref class="ltx_missing_citation" idref="teh2006" title="teh2006">teh2006</ref>]</cite>, the HDP-HSMM explicitly models the duration time of a hidden state.
A graphical model of the HDP-HSMM is shown in Fig. <ref labelref="LABEL:fig:graphical_model_of_hdp-hmm" href="#S3.F2" title="Figure 2 ‣ 3.1 HDP-HSMM ‣ 3 Generative model ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">2</text></ref>.</p>
      </para>
      <figure frefnum="Figure 2" placement="t" refnum="2" xml:id="S3.F2" labels="LABEL:fig:graphical_model_of_hdp-hmm" fragid="S3.F2">
        <graphics candidates="gm_hdp_hmm_2.eps" graphic="gm_hdp_hmm_2.eps" options="width=433.62pt" xml:id="S3.F2.g1" class="ltx_centering" fragid="S3.F2.g1" imagesrc="x99.png" imagewidth="677" imageheight="515"/>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>Model of the HDP-HSMM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite></toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 2</tag>Model of the HDP-HSMM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite></caption>
      </figure>
      <para xml:id="S3.SS1.p2" fragid="S3.SS1.p2">
        <p>The generative process of the HDP-HSMM is described as follows.</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx1" fragid="S7.EGx1">
          <equation frefnum="(1)" refnum="1" xml:id="S3.E1" fragid="S3.E1">
            <MathFork>
              <Math xml:id="S3.E1.m3" tex="\displaystyle\beta\sim\operatorname*{GEM}(\gamma)" content-tex="\displaystyle\beta\sim\GEM(\gamma)" text="beta similar-to GEM@(gamma)" fragid="S3.E1.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E1.m3.1"/>
                        <XMRef idref="S3.E1.m3.2"/>
                      </XMApp>
                      <XMApp>
                        <XMDual role="OPFUNCTION" xml:id="S3.E1.m3.1" fragid="S3.E1.m3.1">
                          <XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/>
                          <XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok>
                        </XMDual>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok name="gamma" role="UNKNOWN" xml:id="S3.E1.m3.2" font="italic" fragid="S3.E1.m3.2">γ</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\beta" xml:id="S3.E1.m1" text="beta" fragid="S3.E1.m1">
                    <XMath>
                      <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math content-tex="\displaystyle\sim\GEM(\gamma)" mode="inline" tex="\displaystyle\sim\operatorname*{GEM}(\gamma)" xml:id="S3.E1.m2" text="absent similar-to GEM@(gamma)" fragid="S3.E1.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E1.m2.1"/>
                            <XMRef idref="S3.E1.m2.2"/>
                          </XMApp>
                          <XMApp>
                            <XMDual role="OPFUNCTION" xml:id="S3.E1.m2.1" fragid="S3.E1.m2.1">
                              <XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/>
                              <XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok>
                            </XMDual>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok name="gamma" role="UNKNOWN" xml:id="S3.E1.m2.2" font="italic" fragid="S3.E1.m2.2">γ</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(2)" refnum="2" xml:id="S3.E2" fragid="S3.E2">
            <MathFork>
              <Math xml:id="S3.E2.m5" tex="\displaystyle\pi_{i}\sim\operatorname*{DP}(\alpha,\beta)" content-tex="\displaystyle\pi_{i}\sim\DP(\alpha,\beta)" text="pi _ i similar-to DP@(alpha, beta)" fragid="S3.E2.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E2.m5.1"/>
                        <XMRef idref="S3.E2.m5.2"/>
                        <XMRef idref="S3.E2.m5.3"/>
                      </XMApp>
                      <XMApp>
                        <XMDual role="OPFUNCTION" xml:id="S3.E2.m5.1" fragid="S3.E2.m5.1">
                          <XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/>
                          <XMTok role="OPERATOR" scriptpos="mid">DP</XMTok>
                        </XMDual>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok name="alpha" role="UNKNOWN" xml:id="S3.E2.m5.2" font="italic" fragid="S3.E2.m5.2">α</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok name="beta" role="UNKNOWN" xml:id="S3.E2.m5.3" font="italic" fragid="S3.E2.m5.3">β</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\pi_{i}" xml:id="S3.E2.m1" text="pi _ i" fragid="S3.E2.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math content-tex="\displaystyle\sim\DP(\alpha,\beta)" mode="inline" tex="\displaystyle\sim\operatorname*{DP}(\alpha,\beta)" xml:id="S3.E2.m2" text="absent similar-to DP@(alpha, beta)" fragid="S3.E2.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E2.m2.1"/>
                            <XMRef idref="S3.E2.m2.2"/>
                            <XMRef idref="S3.E2.m2.3"/>
                          </XMApp>
                          <XMApp>
                            <XMDual role="OPFUNCTION" xml:id="S3.E2.m2.1" fragid="S3.E2.m2.1">
                              <XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/>
                              <XMTok role="OPERATOR" scriptpos="mid">DP</XMTok>
                            </XMDual>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok name="alpha" role="UNKNOWN" xml:id="S3.E2.m2.2" font="italic" fragid="S3.E2.m2.2">α</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok name="beta" role="UNKNOWN" xml:id="S3.E2.m2.3" font="italic" fragid="S3.E2.m2.3">β</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E2.m6" tex="\displaystyle i=1,2,\dots,\infty" text="i = list@(1, 2, dots, infinity)" fragid="S3.E2.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E2.m6.1"/>
                        <XMRef idref="S3.E2.m6.2"/>
                        <XMRef idref="S3.E2.m6.3"/>
                        <XMRef idref="S3.E2.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E2.m6.1" fragid="S3.E2.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E2.m6.2" fragid="S3.E2.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E2.m6.3" fragid="S3.E2.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E2.m6.4" fragid="S3.E2.m6.4">∞</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle i=1,2,\dots,\infty" xml:id="S3.E2.m4" text="i = list@(1, 2, dots, infinity)" fragid="S3.E2.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E2.m4.1"/>
                            <XMRef idref="S3.E2.m4.2"/>
                            <XMRef idref="S3.E2.m4.3"/>
                            <XMRef idref="S3.E2.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E2.m4.1" fragid="S3.E2.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E2.m4.2" fragid="S3.E2.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E2.m4.3" fragid="S3.E2.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E2.m4.4" fragid="S3.E2.m4.4">∞</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(3)" refnum="3" xml:id="S3.E3" fragid="S3.E3">
            <MathFork>
              <Math xml:id="S3.E3.m5" tex="\displaystyle(\theta_{i},\omega_{i})\sim H\times G" text="open-interval@(theta _ i, omega _ i) similar-to H * G" fragid="S3.E3.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.E3.m5.1"/>
                        <XMRef idref="S3.E3.m5.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E3.m5.1" fragid="S3.E3.m5.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E3.m5.2" fragid="S3.E3.m5.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">×</XMTok>
                      <XMTok role="UNKNOWN" font="italic">H</XMTok>
                      <XMTok role="UNKNOWN" font="italic">G</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle(\theta_{i},\omega_{i})" xml:id="S3.E3.m1" text="open-interval@(theta _ i, omega _ i)" fragid="S3.E3.m1">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.E3.m1.1"/>
                          <XMRef idref="S3.E3.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E3.m1.1" fragid="S3.E3.m1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S3.E3.m1.2" fragid="S3.E3.m1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim H\times G" xml:id="S3.E3.m2" text="absent similar-to H * G" fragid="S3.E3.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">×</XMTok>
                          <XMTok role="UNKNOWN" font="italic">H</XMTok>
                          <XMTok role="UNKNOWN" font="italic">G</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E3.m6" tex="\displaystyle i=1,2,\dots,\infty" text="i = list@(1, 2, dots, infinity)" fragid="S3.E3.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E3.m6.1"/>
                        <XMRef idref="S3.E3.m6.2"/>
                        <XMRef idref="S3.E3.m6.3"/>
                        <XMRef idref="S3.E3.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E3.m6.1" fragid="S3.E3.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E3.m6.2" fragid="S3.E3.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E3.m6.3" fragid="S3.E3.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E3.m6.4" fragid="S3.E3.m6.4">∞</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle i=1,2,\dots,\infty" xml:id="S3.E3.m4" text="i = list@(1, 2, dots, infinity)" fragid="S3.E3.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E3.m4.1"/>
                            <XMRef idref="S3.E3.m4.2"/>
                            <XMRef idref="S3.E3.m4.3"/>
                            <XMRef idref="S3.E3.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E3.m4.1" fragid="S3.E3.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E3.m4.2" fragid="S3.E3.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E3.m4.3" fragid="S3.E3.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E3.m4.4" fragid="S3.E3.m4.4">∞</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(4)" refnum="4" xml:id="S3.E4" fragid="S3.E4">
            <MathFork>
              <Math xml:id="S3.E4.m5" tex="\displaystyle z_{s}\sim\pi_{z_{s-1}}" text="z _ s similar-to pi _ z _ (s - 1)" fragid="S3.E4.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">z</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle z_{s}" xml:id="S3.E4.m1" text="z _ s" fragid="S3.E4.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">z</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim\pi_{z_{s-1}}" xml:id="S3.E4.m2" text="absent similar-to pi _ z _ (s - 1)" fragid="S3.E4.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">z</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E4.m6" tex="\displaystyle s=1,2,\dots,S" text="s = list@(1, 2, dots, S)" fragid="S3.E4.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E4.m6.1"/>
                        <XMRef idref="S3.E4.m6.2"/>
                        <XMRef idref="S3.E4.m6.3"/>
                        <XMRef idref="S3.E4.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E4.m6.1" fragid="S3.E4.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E4.m6.2" fragid="S3.E4.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E4.m6.3" fragid="S3.E4.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.E4.m6.4" font="italic" fragid="S3.E4.m6.4">S</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle s=1,2,\dots,S" xml:id="S3.E4.m4" text="s = list@(1, 2, dots, S)" fragid="S3.E4.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E4.m4.1"/>
                            <XMRef idref="S3.E4.m4.2"/>
                            <XMRef idref="S3.E4.m4.3"/>
                            <XMRef idref="S3.E4.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E4.m4.1" fragid="S3.E4.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E4.m4.2" fragid="S3.E4.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E4.m4.3" fragid="S3.E4.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S3.E4.m4.4" font="italic" fragid="S3.E4.m4.4">S</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(5)" refnum="5" xml:id="S3.E5" fragid="S3.E5">
            <MathFork>
              <Math xml:id="S3.E5.m3" tex="\displaystyle D_{s}\sim g(\omega_{z_{s}})" text="D _ s similar-to g * omega _ z _ s" fragid="S3.E5.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">g</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E5.m3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E5.m3.1" fragid="S3.E5.m3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">z</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle D_{s}" xml:id="S3.E5.m1" text="D _ s" fragid="S3.E5.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim g(\omega_{z_{s}})" xml:id="S3.E5.m2" text="absent similar-to g * omega _ z _ s" fragid="S3.E5.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E5.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E5.m2.1" fragid="S3.E5.m2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">z</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(6)" refnum="6" xml:id="S3.E6" fragid="S3.E6">
            <MathFork>
              <Math xml:id="S3.E6.m5" tex="\displaystyle x_{t}=z_{s}" text="x _ t = z _ s" fragid="S3.E6.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle x_{t}" xml:id="S3.E6.m1" text="x _ t" fragid="S3.E6.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">x</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=z_{s}" xml:id="S3.E6.m2" text="absent = z _ s" fragid="S3.E6.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E6.m6" tex="\displaystyle t=t_{s}^{1},t_{s}^{1}+1,\dots,t_{s}^{2}" text="t = list@((t _ s) ^ 1, (t _ s) ^ 1 + 1, dots, (t _ s) ^ 2)" fragid="S3.E6.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E6.m6.2"/>
                        <XMRef idref="S3.E6.m6.3"/>
                        <XMRef idref="S3.E6.m6.1"/>
                        <XMRef idref="S3.E6.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.E6.m6.2" fragid="S3.E6.m6.2">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E6.m6.3" fragid="S3.E6.m6.3">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E6.m6.1" fragid="S3.E6.m6.1">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E6.m6.4" fragid="S3.E6.m6.4">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle t=t_{s}^{1},t_{s}^{1}+1,\dots,t_{s}^{2}" xml:id="S3.E6.m4" text="t = list@((t _ s) ^ 1, (t _ s) ^ 1 + 1, dots, (t _ s) ^ 2)" fragid="S3.E6.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E6.m4.2"/>
                            <XMRef idref="S3.E6.m4.3"/>
                            <XMRef idref="S3.E6.m4.1"/>
                            <XMRef idref="S3.E6.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E6.m4.2" fragid="S3.E6.m4.2">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E6.m4.3" fragid="S3.E6.m4.3">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E6.m4.1" fragid="S3.E6.m4.1">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E6.m4.4" fragid="S3.E6.m4.4">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(7)" refnum="7" xml:id="S3.E7" fragid="S3.E7">
            <MathFork>
              <Math xml:id="S3.E7.m3" tex="\displaystyle y_{t}=h(\theta_{x_{t}})" text="y _ t = h * theta _ x _ t" fragid="S3.E7.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E7.m3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E7.m3.1" fragid="S3.E7.m3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">x</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle y_{t}" xml:id="S3.E7.m1" text="y _ t" fragid="S3.E7.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=h(\theta_{x_{t}})" xml:id="S3.E7.m2" text="absent = h * theta _ x _ t" fragid="S3.E7.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">h</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E7.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E7.m2.1" fragid="S3.E7.m2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(8)" refnum="8" xml:id="S3.E8" fragid="S3.E8">
            <MathFork>
              <Math xml:id="S3.E8.m3" tex="\displaystyle t_{s}^{1}=\sum_{s^{\prime}&lt;s}D_{s^{\prime}}" text="(t _ s) ^ 1 = (sum _ (s ^ prime less s))@(D _ (s ^ prime))" fragid="S3.E8.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle t_{s}^{1}" xml:id="S3.E8.m1" text="(t _ s) ^ 1" fragid="S3.E8.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\sum_{s^{\prime}&lt;s}D_{s^{\prime}}" xml:id="S3.E8.m2" text="absent = (sum _ (s ^ prime less s))@(D _ (s ^ prime))" fragid="S3.E8.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                <XMTok name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">D</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(9)" refnum="9" xml:id="S3.E9" fragid="S3.E9">
            <MathFork>
              <Math xml:id="S3.E9.m3" tex="\displaystyle t_{s}^{2}=t_{s}^{1}+D_{s}-1" text="(t _ s) ^ 2 = ((t _ s) ^ 1 + D _ s) - 1" fragid="S3.E9.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle t_{s}^{2}" xml:id="S3.E9.m1" text="(t _ s) ^ 2" fragid="S3.E9.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=t_{s}^{1}+D_{s}-1" xml:id="S3.E9.m2" text="absent = ((t _ s) ^ 1 + D _ s) - 1" fragid="S3.E9.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" xml:id="S3.SS1.p2.m1" tex="\operatorname*{GEM}" content-tex="\GEM" text="GEM" fragid="S3.SS1.p2.m1"><XMath><XMDual role="OPFUNCTION"><XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/><XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok></XMDual></XMath></Math> and <Math mode="inline" xml:id="S3.SS1.p2.m2" tex="\operatorname*{DP}" content-tex="\DP" text="DP" fragid="S3.SS1.p2.m2"><XMath><XMDual role="OPFUNCTION"><XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/><XMTok role="OPERATOR" scriptpos="mid">DP</XMTok></XMDual></XMath></Math> represent the stick breaking process and Dirichlet process, respectively <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Sethuraman1994" title="Sethuraman1994">Sethuraman1994</ref>, <ref class="ltx_missing_citation" idref="teh2006" title="teh2006">teh2006</ref>]</cite>.
The parameters <Math mode="inline" xml:id="S3.SS1.p2.m3" tex="\gamma" text="gamma" fragid="S3.SS1.p2.m3"><XMath><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok></XMath></Math> and <Math mode="inline" xml:id="S3.SS1.p2.m4" tex="\alpha" text="alpha" fragid="S3.SS1.p2.m4"><XMath><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok></XMath></Math> are hyperparameters of the <Math mode="inline" xml:id="S3.SS1.p2.m5" tex="\operatorname*{DP}" content-tex="\DP" text="DP" fragid="S3.SS1.p2.m5"><XMath><XMDual role="OPFUNCTION"><XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/><XMTok role="OPERATOR" scriptpos="mid">DP</XMTok></XMDual></XMath></Math>, <Math mode="inline" xml:id="S3.SS1.p2.m6" tex="\beta" text="beta" fragid="S3.SS1.p2.m6"><XMath><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok></XMath></Math> is a global transition probability that becomes the base measure of the transition probability distributions related to each super state, and <Math mode="inline" xml:id="S3.SS1.p2.m7" tex="\pi_{i}" text="pi _ i" fragid="S3.SS1.p2.m7"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> is a transition probability distribution related to the <Math mode="inline" xml:id="S3.SS1.p2.m8" tex="i" text="i" fragid="S3.SS1.p2.m8"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>-th super state. Additionally, <Math mode="inline" xml:id="S3.SS1.p2.m9" tex="H" text="H" fragid="S3.SS1.p2.m9"><XMath><XMTok role="UNKNOWN" font="italic">H</XMTok></XMath></Math> and <Math mode="inline" xml:id="S3.SS1.p2.m10" tex="G" text="G" fragid="S3.SS1.p2.m10"><XMath><XMTok role="UNKNOWN" font="italic">G</XMTok></XMath></Math> are base measures for emission distribution and duration distribution.</p>
      </para>
      <para xml:id="S3.SS1.p3" fragid="S3.SS1.p3">
        <p>In contrast with the case where HMM assumes that a hidden state <Math mode="inline" xml:id="S3.SS1.p3.m1" tex="x_{t}" text="x _ t" fragid="S3.SS1.p3.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> transits to the next hidden state <Math mode="inline" xml:id="S3.SS1.p3.m2" tex="x_{t+1}" text="x _ (t + 1)" fragid="S3.SS1.p3.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math> according to a Markov process, the hidden semi-Markov Model (HSMM) assumes that a hidden super state <Math mode="inline" xml:id="S3.SS1.p3.m3" tex="z_{s}" text="z _ s" fragid="S3.SS1.p3.m3"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> transits to next hidden super state <Math mode="inline" xml:id="S3.SS1.p3.m4" tex="z_{s+1}" text="z _ (s + 1)" fragid="S3.SS1.p3.m4"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math> after a probabilistically determined duration time <Math mode="inline" xml:id="S3.SS1.p3.m5" tex="D_{s}" text="D _ s" fragid="S3.SS1.p3.m5"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math>, which is sampled from a duration distribution <Math mode="inline" xml:id="S3.SS1.p3.m6" tex="g(w_{z_{s}})" text="g * w _ z _ s" fragid="S3.SS1.p3.m6"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="S3.SS1.p3.m6.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS1.p3.m6.1" fragid="S3.SS1.p3.m6.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>.
The super state <Math mode="inline" xml:id="S3.SS1.p3.m7" tex="z_{s}" text="z _ s" fragid="S3.SS1.p3.m7"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> is sampled from a categorical distribution <Math mode="inline" xml:id="S3.SS1.p3.m8" tex="\pi_{z_{s-1}}" text="pi _ z _ (s - 1)" fragid="S3.SS1.p3.m8"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMath></Math> related to the previous super state <Math mode="inline" xml:id="S3.SS1.p3.m9" tex="z_{s-1}" text="z _ (s - 1)" fragid="S3.SS1.p3.m9"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math>.
When the super state <Math mode="inline" xml:id="S3.SS1.p3.m10" tex="z_{s}" text="z _ s" fragid="S3.SS1.p3.m10"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> and duration time <Math mode="inline" xml:id="S3.SS1.p3.m11" tex="D_{s}" text="D _ s" fragid="S3.SS1.p3.m11"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> are sampled, a sequence of hidden states <Math mode="inline" xml:id="S3.SS1.p3.m12" tex="\{x_{t}\mid 1+\sum_{s^{\prime}=1}^{s-1}D_{s^{\prime}}\leq t\leq\sum_{s^{\prime%&#10;}=1}^{s}D_{s^{\prime}}\}" text="conditional-set@(x _ t, 1 + ((sum _ (s ^ prime = 1)) ^ (s - 1))@(D _ (s ^ prime)) less= t less= ((sum _ (s ^ prime = 1)) ^ s)@(D _ (s ^ prime)))" fragid="S3.SS1.p3.m12"><XMath><XMDual><XMApp><XMTok meaning="conditional-set"/><XMRef idref="S3.SS1.p3.m12.1"/><XMRef idref="S3.SS1.p3.m12.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S3.SS1.p3.m12.1" fragid="S3.SS1.p3.m12.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp xml:id="S3.SS1.p3.m12.2" fragid="S3.SS1.p3.m12.2"><XMTok meaning="multirelation"/><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMApp></XMApp></XMApp><XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> are determined to be <Math mode="inline" xml:id="S3.SS1.p3.m13" tex="z_{s}" text="z _ s" fragid="S3.SS1.p3.m13"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math>. An observation datum <Math mode="inline" xml:id="S3.SS1.p3.m14" tex="y_{t}" text="y _ t" fragid="S3.SS1.p3.m14"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> at time <Math mode="inline" xml:id="S3.SS1.p3.m15" tex="t" text="t" fragid="S3.SS1.p3.m15"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math> is assumed to be drawn from an emission distribution <Math mode="inline" xml:id="S3.SS1.p3.m16" tex="h" text="h" fragid="S3.SS1.p3.m16"><XMath><XMTok role="UNKNOWN" font="italic">h</XMTok></XMath></Math> whose parameter is <Math mode="inline" xml:id="S3.SS1.p3.m17" tex="\theta_{x_{t}}" text="theta _ x _ t" fragid="S3.SS1.p3.m17"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math>.
Observation data <Math mode="inline" xml:id="S3.SS1.p3.m18" tex="y_{t}" text="y _ t" fragid="S3.SS1.p3.m18"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> are generated by <Math mode="inline" xml:id="S3.SS1.p3.m19" tex="h(\theta_{x_{t}})" text="h * theta _ x _ t" fragid="S3.SS1.p3.m19"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok><XMDual><XMRef idref="S3.SS1.p3.m19.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS1.p3.m19.1" fragid="S3.SS1.p3.m19.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> for <Math mode="inline" xml:id="S3.SS1.p3.m20" tex="D_{s}" text="D _ s" fragid="S3.SS1.p3.m20"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> steps.</p>
      </para>
      <para xml:id="S3.SS1.p4" fragid="S3.SS1.p4">
        <p>An efficient sampling inference procedure based on the backward filtering forward sampling technique was proposed for
constructing a blocked Gibbs sampler <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>. A similar algorithm was proposed for HDP-HMM by Fox et al. <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Fox2009" title="Fox2009">Fox2009</ref>]</cite>. The algorithm is derived from a weak-limit approximation of the number of hidden super states. The computational cost of the message passing algorithm can be reduced to <Math mode="inline" xml:id="S3.SS1.p4.m1" tex="O(Td_{\max}N^{2})" text="O * T * d _ maximum * N ^ 2" fragid="S3.SS1.p4.m1"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">O</XMTok><XMDual><XMRef idref="S3.SS1.p4.m1.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS1.p4.m1.1" fragid="S3.SS1.p4.m1.1"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S3.SS1.p4.m2" tex="T" text="T" fragid="S3.SS1.p4.m2"><XMath><XMTok role="UNKNOWN" font="italic">T</XMTok></XMath></Math> is the length of the observed data, <Math mode="inline" xml:id="S3.SS1.p4.m3" tex="N" text="N" fragid="S3.SS1.p4.m3"><XMath><XMTok role="UNKNOWN" font="italic">N</XMTok></XMath></Math> is the state cardinality, and <Math mode="inline" xml:id="S3.SS1.p4.m4" tex="d_{\max}" text="d _ maximum" fragid="S3.SS1.p4.m4"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok></XMApp></XMath></Math> is the maximal duration of a super state for truncation. The order is almost the same as that of the backward filtering forward sampling algorithm for the HDP-HMM, except for the constant factor <Math mode="inline" xml:id="S3.SS1.p4.m5" tex="d_{\max}" text="d _ maximum" fragid="S3.SS1.p4.m5"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok></XMApp></XMath></Math>.</p>
      </para>
    </subsection>
    <subsection refnum="3.2" xml:id="S3.SS2" fragid="S3.SS2">
      <title><tag close=" ">3.2</tag>HDP-HLM</title>
      <para xml:id="S3.SS2.p1" fragid="S3.SS2.p1">
        <p>The generative model for time series data that potentially have a double articulation structure can be obtained by extending the HDP-HSMM.
A graphical model of the proposed HDP-HLM is shown in Fig. <ref labelref="LABEL:fig:graphical_model" href="#S3.F3" title="Figure 3 ‣ 3.2 HDP-HLM ‣ 3 Generative model ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">3</text></ref>.
<!-- %**** ieee˙daa.tex Line 225 **** --></p>
      </para>
      <figure frefnum="Figure 3" placement="t" refnum="3" xml:id="S3.F3" labels="LABEL:fig:graphical_model" fragid="S3.F3">
        <graphics candidates="graphical_model_daa_2.eps" graphic="graphical_model_daa_2.eps" options="width=303.534pt" xml:id="S3.F3.g1" class="ltx_centering" fragid="S3.F3.g1" imagesrc="x100.png" imagewidth="474" imageheight="438"/>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>Model of the proposed HDP-HLM</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 3</tag>Model of the proposed HDP-HLM</caption>
      </figure>
      <para xml:id="S3.SS2.p2" fragid="S3.SS2.p2">
        <p>In the generative model of HDP-HLM, the super state <Math mode="inline" xml:id="S3.SS2.p2.m1" tex="z_{s}" text="z _ s" fragid="S3.SS2.p2.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> corresponds to a word in spoken language, which is the fundamental idea of the extension.
The <Math mode="inline" xml:id="S3.SS2.p2.m2" tex="i" text="i" fragid="S3.SS2.p2.m2"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>-th super state <Math mode="inline" xml:id="S3.SS2.p2.m3" tex="z_{s}=i" text="z _ s = i" fragid="S3.SS2.p2.m3"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> has a phoneme sequence <Math mode="inline" xml:id="S3.SS2.p2.m4" tex="w_{i}=(w_{i1},\ldots,w_{ik},\ldots,w_{iL_{i}})" text="w _ i = vector@(w _ (i * 1), ldots, w _ (i * k), ldots, w _ (i * L _ i))" fragid="S3.SS2.p2.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S3.SS2.p2.m4.3"/><XMRef idref="S3.SS2.p2.m4.1"/><XMRef idref="S3.SS2.p2.m4.4"/><XMRef idref="S3.SS2.p2.m4.2"/><XMRef idref="S3.SS2.p2.m4.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS2.p2.m4.3" fragid="S3.SS2.p2.m4.3"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S3.SS2.p2.m4.1" fragid="S3.SS2.p2.m4.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S3.SS2.p2.m4.4" fragid="S3.SS2.p2.m4.4"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S3.SS2.p2.m4.2" fragid="S3.SS2.p2.m4.2">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S3.SS2.p2.m4.5" fragid="S3.SS2.p2.m4.5"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S3.SS2.p2.m5" tex="L_{i}" text="L _ i" fragid="S3.SS2.p2.m5"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> is the length of the <Math mode="inline" xml:id="S3.SS2.p2.m6" tex="i" text="i" fragid="S3.SS2.p2.m6"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>-th word <Math mode="inline" xml:id="S3.SS2.p2.m7" tex="w_{i}" text="w _ i" fragid="S3.SS2.p2.m7"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>.
The generative process of the HDP-HLM is described as follows.</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx2" fragid="S7.EGx2">
          <equation frefnum="(10)" refnum="10" xml:id="S3.E10" fragid="S3.E10">
            <MathFork>
              <Math xml:id="S3.E10.m3" tex="\displaystyle\beta^{LM}\sim\operatorname*{GEM}(\gamma^{LM})" content-tex="\displaystyle\beta^{LM}\sim\GEM(\gamma^{LM})" text="beta ^ (L * M) similar-to GEM@(gamma ^ (L * M))" fragid="S3.E10.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">L</XMTok>
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E10.m3.1"/>
                        <XMRef idref="S3.E10.m3.2"/>
                      </XMApp>
                      <XMApp>
                        <XMDual role="OPFUNCTION" xml:id="S3.E10.m3.1" fragid="S3.E10.m3.1">
                          <XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/>
                          <XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok>
                        </XMDual>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E10.m3.2" fragid="S3.E10.m3.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\beta^{LM}" xml:id="S3.E10.m1" text="beta ^ (L * M)" fragid="S3.E10.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math content-tex="\displaystyle\sim\GEM(\gamma^{LM})" mode="inline" tex="\displaystyle\sim\operatorname*{GEM}(\gamma^{LM})" xml:id="S3.E10.m2" text="absent similar-to GEM@(gamma ^ (L * M))" fragid="S3.E10.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E10.m2.1"/>
                            <XMRef idref="S3.E10.m2.2"/>
                          </XMApp>
                          <XMApp>
                            <XMDual role="OPFUNCTION" xml:id="S3.E10.m2.1" fragid="S3.E10.m2.1">
                              <XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/>
                              <XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok>
                            </XMDual>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E10.m2.2" fragid="S3.E10.m2.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">L</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">M</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(11)" refnum="11" xml:id="S3.E11" fragid="S3.E11">
            <MathFork>
              <Math xml:id="S3.E11.m5" tex="\displaystyle\pi^{LM}_{i}\sim\operatorname*{DP}(\alpha^{LM},\beta^{LM})" content-tex="\displaystyle\pi^{LM}_{i}\sim\DP(\alpha^{LM},\beta^{LM})" text="(pi ^ (L * M)) _ i similar-to DP@(alpha ^ (L * M), beta ^ (L * M))" fragid="S3.E11.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E11.m5.1"/>
                        <XMRef idref="S3.E11.m5.2"/>
                        <XMRef idref="S3.E11.m5.3"/>
                      </XMApp>
                      <XMApp>
                        <XMDual role="OPFUNCTION" xml:id="S3.E11.m5.1" fragid="S3.E11.m5.1">
                          <XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/>
                          <XMTok role="OPERATOR" scriptpos="mid">DP</XMTok>
                        </XMDual>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E11.m5.2" fragid="S3.E11.m5.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S3.E11.m5.3" fragid="S3.E11.m5.3">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\pi^{LM}_{i}" xml:id="S3.E11.m1" text="(pi ^ (L * M)) _ i" fragid="S3.E11.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math content-tex="\displaystyle\sim\DP(\alpha^{LM},\beta^{LM})" mode="inline" tex="\displaystyle\sim\operatorname*{DP}(\alpha^{LM},\beta^{LM})" xml:id="S3.E11.m2" text="absent similar-to DP@(alpha ^ (L * M), beta ^ (L * M))" fragid="S3.E11.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E11.m2.1"/>
                            <XMRef idref="S3.E11.m2.2"/>
                            <XMRef idref="S3.E11.m2.3"/>
                          </XMApp>
                          <XMApp>
                            <XMDual role="OPFUNCTION" xml:id="S3.E11.m2.1" fragid="S3.E11.m2.1">
                              <XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/>
                              <XMTok role="OPERATOR" scriptpos="mid">DP</XMTok>
                            </XMDual>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E11.m2.2" fragid="S3.E11.m2.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">L</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">M</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.E11.m2.3" fragid="S3.E11.m2.3">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">L</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">M</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E11.m6" tex="\displaystyle i=1,2,\dots,\infty" text="i = list@(1, 2, dots, infinity)" fragid="S3.E11.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E11.m6.1"/>
                        <XMRef idref="S3.E11.m6.2"/>
                        <XMRef idref="S3.E11.m6.3"/>
                        <XMRef idref="S3.E11.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E11.m6.1" fragid="S3.E11.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E11.m6.2" fragid="S3.E11.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E11.m6.3" fragid="S3.E11.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E11.m6.4" fragid="S3.E11.m6.4">∞</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle i=1,2,\dots,\infty" xml:id="S3.E11.m4" text="i = list@(1, 2, dots, infinity)" fragid="S3.E11.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E11.m4.1"/>
                            <XMRef idref="S3.E11.m4.2"/>
                            <XMRef idref="S3.E11.m4.3"/>
                            <XMRef idref="S3.E11.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E11.m4.1" fragid="S3.E11.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E11.m4.2" fragid="S3.E11.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E11.m4.3" fragid="S3.E11.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E11.m4.4" fragid="S3.E11.m4.4">∞</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx3" fragid="S7.EGx3">
          <equation frefnum="(12)" refnum="12" xml:id="S3.E12" fragid="S3.E12">
            <MathFork>
              <Math xml:id="S3.E12.m3" tex="\displaystyle\beta^{WM}\sim\operatorname*{GEM}(\gamma^{WM})" content-tex="\displaystyle\beta^{WM}\sim\GEM(\gamma^{WM})" text="beta ^ (W * M) similar-to GEM@(gamma ^ (W * M))" fragid="S3.E12.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">W</XMTok>
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E12.m3.1"/>
                        <XMRef idref="S3.E12.m3.2"/>
                      </XMApp>
                      <XMApp>
                        <XMDual role="OPFUNCTION" xml:id="S3.E12.m3.1" fragid="S3.E12.m3.1">
                          <XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/>
                          <XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok>
                        </XMDual>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E12.m3.2" fragid="S3.E12.m3.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">W</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\beta^{WM}" xml:id="S3.E12.m1" text="beta ^ (W * M)" fragid="S3.E12.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">W</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math content-tex="\displaystyle\sim\GEM(\gamma^{WM})" mode="inline" tex="\displaystyle\sim\operatorname*{GEM}(\gamma^{WM})" xml:id="S3.E12.m2" text="absent similar-to GEM@(gamma ^ (W * M))" fragid="S3.E12.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E12.m2.1"/>
                            <XMRef idref="S3.E12.m2.2"/>
                          </XMApp>
                          <XMApp>
                            <XMDual role="OPFUNCTION" xml:id="S3.E12.m2.1" fragid="S3.E12.m2.1">
                              <XMTok name="GEM" role="OPFUNCTION" scriptpos="mid"/>
                              <XMTok role="OPERATOR" scriptpos="mid">GEM</XMTok>
                            </XMDual>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E12.m2.2" fragid="S3.E12.m2.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">W</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">M</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(13)" refnum="13" xml:id="S3.E13" fragid="S3.E13">
            <MathFork>
              <Math xml:id="S3.E13.m5" tex="\displaystyle\pi_{j}^{WM}\sim\operatorname*{DP}(\alpha^{WM},\beta^{WM})" content-tex="\displaystyle\pi_{j}^{WM}\sim\DP(\alpha^{WM},\beta^{WM})" text="(pi _ j) ^ (W * M) similar-to DP@(alpha ^ (W * M), beta ^ (W * M))" fragid="S3.E13.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">W</XMTok>
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E13.m5.1"/>
                        <XMRef idref="S3.E13.m5.2"/>
                        <XMRef idref="S3.E13.m5.3"/>
                      </XMApp>
                      <XMApp>
                        <XMDual role="OPFUNCTION" xml:id="S3.E13.m5.1" fragid="S3.E13.m5.1">
                          <XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/>
                          <XMTok role="OPERATOR" scriptpos="mid">DP</XMTok>
                        </XMDual>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E13.m5.2" fragid="S3.E13.m5.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">W</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S3.E13.m5.3" fragid="S3.E13.m5.3">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">W</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\pi_{j}^{WM}" xml:id="S3.E13.m1" text="(pi _ j) ^ (W * M)" fragid="S3.E13.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                          <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">W</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math content-tex="\displaystyle\sim\DP(\alpha^{WM},\beta^{WM})" mode="inline" tex="\displaystyle\sim\operatorname*{DP}(\alpha^{WM},\beta^{WM})" xml:id="S3.E13.m2" text="absent similar-to DP@(alpha ^ (W * M), beta ^ (W * M))" fragid="S3.E13.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E13.m2.1"/>
                            <XMRef idref="S3.E13.m2.2"/>
                            <XMRef idref="S3.E13.m2.3"/>
                          </XMApp>
                          <XMApp>
                            <XMDual role="OPFUNCTION" xml:id="S3.E13.m2.1" fragid="S3.E13.m2.1">
                              <XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/>
                              <XMTok role="OPERATOR" scriptpos="mid">DP</XMTok>
                            </XMDual>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E13.m2.2" fragid="S3.E13.m2.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">W</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">M</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.E13.m2.3" fragid="S3.E13.m2.3">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">W</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">M</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E13.m6" tex="\displaystyle j=1,2,\dots,\infty" text="j = list@(1, 2, dots, infinity)" fragid="S3.E13.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E13.m6.1"/>
                        <XMRef idref="S3.E13.m6.2"/>
                        <XMRef idref="S3.E13.m6.3"/>
                        <XMRef idref="S3.E13.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E13.m6.1" fragid="S3.E13.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E13.m6.2" fragid="S3.E13.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E13.m6.3" fragid="S3.E13.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E13.m6.4" fragid="S3.E13.m6.4">∞</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle j=1,2,\dots,\infty" xml:id="S3.E13.m4" text="j = list@(1, 2, dots, infinity)" fragid="S3.E13.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E13.m4.1"/>
                            <XMRef idref="S3.E13.m4.2"/>
                            <XMRef idref="S3.E13.m4.3"/>
                            <XMRef idref="S3.E13.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E13.m4.1" fragid="S3.E13.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E13.m4.2" fragid="S3.E13.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E13.m4.3" fragid="S3.E13.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E13.m4.4" fragid="S3.E13.m4.4">∞</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx4" fragid="S7.EGx4">
          <equation xml:id="S3.Ex1" fragid="S3.Ex1">
            <MathFork>
              <Math xml:id="S3.Ex1.m5" tex="\displaystyle w_{ik}\sim\pi_{w_{ik-1}}^{WM}" text="w _ (i * k) similar-to (pi _ w _ (i * k - 1)) ^ (W * M)" fragid="S3.Ex1.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">w</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">w</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">W</XMTok>
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle w_{ik}" xml:id="S3.Ex1.m1" text="w _ (i * k)" fragid="S3.Ex1.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim\pi_{w_{ik-1}}^{WM}" xml:id="S3.Ex1.m2" text="absent similar-to (pi _ w _ (i * k - 1)) ^ (W * M)" fragid="S3.Ex1.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">w</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                </XMApp>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">W</XMTok>
                            <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.Ex1.m6" tex="\displaystyle i=1,2,\dots,\infty," text="i = list@(1, 2, dots, infinity)" fragid="S3.Ex1.m6">
                <XMath>
                  <XMApp punctuation=",">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.Ex1.m6.1"/>
                        <XMRef idref="S3.Ex1.m6.2"/>
                        <XMRef idref="S3.Ex1.m6.3"/>
                        <XMRef idref="S3.Ex1.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.Ex1.m6.1" fragid="S3.Ex1.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.Ex1.m6.2" fragid="S3.Ex1.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.Ex1.m6.3" fragid="S3.Ex1.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.Ex1.m6.4" fragid="S3.Ex1.m6.4">∞</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle i=1,2,\dots,\infty," xml:id="S3.Ex1.m4" text="i = list@(1, 2, dots, infinity)" fragid="S3.Ex1.m4">
                    <XMath>
                      <XMApp punctuation=",">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.Ex1.m4.1"/>
                            <XMRef idref="S3.Ex1.m4.2"/>
                            <XMRef idref="S3.Ex1.m4.3"/>
                            <XMRef idref="S3.Ex1.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.Ex1.m4.1" fragid="S3.Ex1.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.Ex1.m4.2" fragid="S3.Ex1.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.Ex1.m4.3" fragid="S3.Ex1.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.Ex1.m4.4" fragid="S3.Ex1.m4.4">∞</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(14)" refnum="14" xml:id="S3.E14" fragid="S3.E14">
            <MathFork>
              <MathBranch>
                <td align="right"/>
                <td align="left"/>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E14.m6" tex="\displaystyle k=1,2,\dots,L_{i}" text="k = list@(1, 2, dots, L _ i)" fragid="S3.E14.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E14.m6.1"/>
                        <XMRef idref="S3.E14.m6.2"/>
                        <XMRef idref="S3.E14.m6.3"/>
                        <XMRef idref="S3.E14.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E14.m6.1" fragid="S3.E14.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E14.m6.2" fragid="S3.E14.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E14.m6.3" fragid="S3.E14.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E14.m6.4" fragid="S3.E14.m6.4">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle k=1,2,\dots,L_{i}" xml:id="S3.E14.m4" text="k = list@(1, 2, dots, L _ i)" fragid="S3.E14.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E14.m4.1"/>
                            <XMRef idref="S3.E14.m4.2"/>
                            <XMRef idref="S3.E14.m4.3"/>
                            <XMRef idref="S3.E14.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E14.m4.1" fragid="S3.E14.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E14.m4.2" fragid="S3.E14.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E14.m4.3" fragid="S3.E14.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E14.m4.4" fragid="S3.E14.m4.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(15)" refnum="15" xml:id="S3.E15" fragid="S3.E15">
            <MathFork>
              <Math xml:id="S3.E15.m5" tex="\displaystyle(\theta_{j},\omega_{j})\sim H\times G" text="open-interval@(theta _ j, omega _ j) similar-to H * G" fragid="S3.E15.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.E15.m5.1"/>
                        <XMRef idref="S3.E15.m5.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E15.m5.1" fragid="S3.E15.m5.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                          <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E15.m5.2" fragid="S3.E15.m5.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                          <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">×</XMTok>
                      <XMTok role="UNKNOWN" font="italic">H</XMTok>
                      <XMTok role="UNKNOWN" font="italic">G</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle(\theta_{j},\omega_{j})" xml:id="S3.E15.m1" text="open-interval@(theta _ j, omega _ j)" fragid="S3.E15.m1">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.E15.m1.1"/>
                          <XMRef idref="S3.E15.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E15.m1.1" fragid="S3.E15.m1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                            <XMTok role="UNKNOWN" font="italic">j</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S3.E15.m1.2" fragid="S3.E15.m1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                            <XMTok role="UNKNOWN" font="italic">j</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim H\times G" xml:id="S3.E15.m2" text="absent similar-to H * G" fragid="S3.E15.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">×</XMTok>
                          <XMTok role="UNKNOWN" font="italic">H</XMTok>
                          <XMTok role="UNKNOWN" font="italic">G</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E15.m6" tex="\displaystyle j=1,2,\dots,\infty" text="j = list@(1, 2, dots, infinity)" fragid="S3.E15.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E15.m6.1"/>
                        <XMRef idref="S3.E15.m6.2"/>
                        <XMRef idref="S3.E15.m6.3"/>
                        <XMRef idref="S3.E15.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E15.m6.1" fragid="S3.E15.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E15.m6.2" fragid="S3.E15.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E15.m6.3" fragid="S3.E15.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E15.m6.4" fragid="S3.E15.m6.4">∞</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle j=1,2,\dots,\infty" xml:id="S3.E15.m4" text="j = list@(1, 2, dots, infinity)" fragid="S3.E15.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E15.m4.1"/>
                            <XMRef idref="S3.E15.m4.2"/>
                            <XMRef idref="S3.E15.m4.3"/>
                            <XMRef idref="S3.E15.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E15.m4.1" fragid="S3.E15.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E15.m4.2" fragid="S3.E15.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E15.m4.3" fragid="S3.E15.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.E15.m4.4" fragid="S3.E15.m4.4">∞</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx5" fragid="S7.EGx5">
          <equation frefnum="(16)" refnum="16" xml:id="S3.E16" fragid="S3.E16">
            <MathFork>
              <Math xml:id="S3.E16.m5" tex="\displaystyle z_{s}\sim\pi^{LM}_{z_{s-1}}" text="z _ s similar-to (pi ^ (L * M)) _ z _ (s - 1)" fragid="S3.E16.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">z</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle z_{s}" xml:id="S3.E16.m1" text="z _ s" fragid="S3.E16.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">z</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim\pi^{LM}_{z_{s-1}}" xml:id="S3.E16.m2" text="absent similar-to (pi ^ (L * M)) _ z _ (s - 1)" fragid="S3.E16.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">z</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E16.m6" tex="\displaystyle s=1,2,\dots,S" text="s = list@(1, 2, dots, S)" fragid="S3.E16.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E16.m6.1"/>
                        <XMRef idref="S3.E16.m6.2"/>
                        <XMRef idref="S3.E16.m6.3"/>
                        <XMRef idref="S3.E16.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E16.m6.1" fragid="S3.E16.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E16.m6.2" fragid="S3.E16.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E16.m6.3" fragid="S3.E16.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.E16.m6.4" font="italic" fragid="S3.E16.m6.4">S</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle s=1,2,\dots,S" xml:id="S3.E16.m4" text="s = list@(1, 2, dots, S)" fragid="S3.E16.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E16.m4.1"/>
                            <XMRef idref="S3.E16.m4.2"/>
                            <XMRef idref="S3.E16.m4.3"/>
                            <XMRef idref="S3.E16.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E16.m4.1" fragid="S3.E16.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E16.m4.2" fragid="S3.E16.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E16.m4.3" fragid="S3.E16.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S3.E16.m4.4" font="italic" fragid="S3.E16.m4.4">S</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(17)" refnum="17" xml:id="S3.E17" fragid="S3.E17">
            <MathFork>
              <Math xml:id="S3.E17.m5" tex="\displaystyle l_{sk}=w_{z_{s}k}" text="l _ (s * k) = w _ (z _ s * k)" fragid="S3.E17.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">l</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">w</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle l_{sk}" xml:id="S3.E17.m1" text="l _ (s * k)" fragid="S3.E17.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">l</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=w_{z_{s}k}" xml:id="S3.E17.m2" text="absent = w _ (z _ s * k)" fragid="S3.E17.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">w</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">z</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E17.m6" tex="\displaystyle s=1,2,\dots,S" text="s = list@(1, 2, dots, S)" fragid="S3.E17.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E17.m6.1"/>
                        <XMRef idref="S3.E17.m6.2"/>
                        <XMRef idref="S3.E17.m6.3"/>
                        <XMRef idref="S3.E17.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E17.m6.1" fragid="S3.E17.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E17.m6.2" fragid="S3.E17.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E17.m6.3" fragid="S3.E17.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.E17.m6.4" font="italic" fragid="S3.E17.m6.4">S</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle s=1,2,\dots,S" xml:id="S3.E17.m4" text="s = list@(1, 2, dots, S)" fragid="S3.E17.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E17.m4.1"/>
                            <XMRef idref="S3.E17.m4.2"/>
                            <XMRef idref="S3.E17.m4.3"/>
                            <XMRef idref="S3.E17.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E17.m4.1" fragid="S3.E17.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E17.m4.2" fragid="S3.E17.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E17.m4.3" fragid="S3.E17.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S3.E17.m4.4" font="italic" fragid="S3.E17.m4.4">S</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(18)" refnum="18" xml:id="S3.E18" fragid="S3.E18">
            <MathFork>
              <MathBranch>
                <td align="right"/>
                <td align="left"/>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E18.m6" tex="\displaystyle k=1,2,\dots,L_{z_{s}}" text="k = list@(1, 2, dots, L _ z _ s)" fragid="S3.E18.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E18.m6.1"/>
                        <XMRef idref="S3.E18.m6.2"/>
                        <XMRef idref="S3.E18.m6.3"/>
                        <XMRef idref="S3.E18.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E18.m6.1" fragid="S3.E18.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E18.m6.2" fragid="S3.E18.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E18.m6.3" fragid="S3.E18.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E18.m6.4" fragid="S3.E18.m6.4">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">z</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle k=1,2,\dots,L_{z_{s}}" xml:id="S3.E18.m4" text="k = list@(1, 2, dots, L _ z _ s)" fragid="S3.E18.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E18.m4.1"/>
                            <XMRef idref="S3.E18.m4.2"/>
                            <XMRef idref="S3.E18.m4.3"/>
                            <XMRef idref="S3.E18.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E18.m4.1" fragid="S3.E18.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E18.m4.2" fragid="S3.E18.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E18.m4.3" fragid="S3.E18.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E18.m4.4" fragid="S3.E18.m4.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">z</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(19)" refnum="19" xml:id="S3.E19" fragid="S3.E19">
            <MathFork>
              <Math xml:id="S3.E19.m5" tex="\displaystyle D_{sk}\sim g(\omega_{l_{sk}})" text="D _ (s * k) similar-to g * omega _ l _ (s * k)" fragid="S3.E19.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">g</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E19.m5.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E19.m5.1" fragid="S3.E19.m5.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">l</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle D_{sk}" xml:id="S3.E19.m1" text="D _ (s * k)" fragid="S3.E19.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sim g(\omega_{l_{sk}})" xml:id="S3.E19.m2" text="absent similar-to g * omega _ l _ (s * k)" fragid="S3.E19.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E19.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E19.m2.1" fragid="S3.E19.m2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E19.m6" tex="\displaystyle s=1,2,\dots,S" text="s = list@(1, 2, dots, S)" fragid="S3.E19.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E19.m6.1"/>
                        <XMRef idref="S3.E19.m6.2"/>
                        <XMRef idref="S3.E19.m6.3"/>
                        <XMRef idref="S3.E19.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E19.m6.1" fragid="S3.E19.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E19.m6.2" fragid="S3.E19.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E19.m6.3" fragid="S3.E19.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.E19.m6.4" font="italic" fragid="S3.E19.m6.4">S</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle s=1,2,\dots,S" xml:id="S3.E19.m4" text="s = list@(1, 2, dots, S)" fragid="S3.E19.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E19.m4.1"/>
                            <XMRef idref="S3.E19.m4.2"/>
                            <XMRef idref="S3.E19.m4.3"/>
                            <XMRef idref="S3.E19.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E19.m4.1" fragid="S3.E19.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E19.m4.2" fragid="S3.E19.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E19.m4.3" fragid="S3.E19.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S3.E19.m4.4" font="italic" fragid="S3.E19.m4.4">S</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(20)" refnum="20" xml:id="S3.E20" fragid="S3.E20">
            <MathFork>
              <MathBranch>
                <td align="right"/>
                <td align="left"/>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E20.m6" tex="\displaystyle k=1,2,\dots,L_{z_{s}}" text="k = list@(1, 2, dots, L _ z _ s)" fragid="S3.E20.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E20.m6.1"/>
                        <XMRef idref="S3.E20.m6.2"/>
                        <XMRef idref="S3.E20.m6.3"/>
                        <XMRef idref="S3.E20.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E20.m6.1" fragid="S3.E20.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E20.m6.2" fragid="S3.E20.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="dots" role="ID" xml:id="S3.E20.m6.3" fragid="S3.E20.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E20.m6.4" fragid="S3.E20.m6.4">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">z</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle k=1,2,\dots,L_{z_{s}}" xml:id="S3.E20.m4" text="k = list@(1, 2, dots, L _ z _ s)" fragid="S3.E20.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E20.m4.1"/>
                            <XMRef idref="S3.E20.m4.2"/>
                            <XMRef idref="S3.E20.m4.3"/>
                            <XMRef idref="S3.E20.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E20.m4.1" fragid="S3.E20.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E20.m4.2" fragid="S3.E20.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="S3.E20.m4.3" fragid="S3.E20.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E20.m4.4" fragid="S3.E20.m4.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">z</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx6" fragid="S7.EGx6">
          <equation frefnum="(21)" refnum="21" xml:id="S3.E21" fragid="S3.E21">
            <MathFork>
              <Math xml:id="S3.E21.m5" tex="\displaystyle x_{t}=l_{sk}" text="x _ t = l _ (s * k)" fragid="S3.E21.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">l</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle x_{t}" xml:id="S3.E21.m1" text="x _ t" fragid="S3.E21.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">x</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=l_{sk}" xml:id="S3.E21.m2" text="absent = l _ (s * k)" fragid="S3.E21.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">l</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E21.m6" tex="\displaystyle t=t_{sk}^{1},\ldots,t_{sk}^{2}" text="t = list@((t _ (s * k)) ^ 1, ldots, (t _ (s * k)) ^ 2)" fragid="S3.E21.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E21.m6.2"/>
                        <XMRef idref="S3.E21.m6.1"/>
                        <XMRef idref="S3.E21.m6.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.E21.m6.2" fragid="S3.E21.m6.2">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="ldots" role="ID" xml:id="S3.E21.m6.1" fragid="S3.E21.m6.1">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E21.m6.3" fragid="S3.E21.m6.3">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle t=t_{sk}^{1},\ldots,t_{sk}^{2}" xml:id="S3.E21.m4" text="t = list@((t _ (s * k)) ^ 1, ldots, (t _ (s * k)) ^ 2)" fragid="S3.E21.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E21.m4.2"/>
                            <XMRef idref="S3.E21.m4.1"/>
                            <XMRef idref="S3.E21.m4.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E21.m4.2" fragid="S3.E21.m4.2">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="ldots" role="ID" xml:id="S3.E21.m4.1" fragid="S3.E21.m4.1">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E21.m4.3" fragid="S3.E21.m4.3">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(22)" refnum="22" xml:id="S3.E22" fragid="S3.E22">
            <MathFork>
              <MathBranch>
                <td align="right"/>
                <td align="left"/>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E22.m6" tex="\displaystyle t_{sk}^{1}=\sum_{s^{\prime}&lt;s}D_{s^{\prime}}+\sum_{k^{\prime}&lt;k}%&#10;D_{sk^{\prime}}+1" text="(t _ (s * k)) ^ 1 = (sum _ (s ^ prime less s))@(D _ (s ^ prime)) + (sum _ (k ^ prime less k))@(D _ (s * k ^ prime)) + 1" fragid="S3.E22.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle t_{sk}^{1}=\sum_{s^{\prime}&lt;s}D_{s^{\prime}}+\sum_{k^{\prime}&lt;k}%&#10;D_{sk^{\prime}}+1" xml:id="S3.E22.m4" text="(t _ (s * k)) ^ 1 = (sum _ (s ^ prime less s))@(D _ (s ^ prime)) + (sum _ (k ^ prime less k))@(D _ (s * k ^ prime)) + 1" fragid="S3.E22.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMApp scriptpos="mid">
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                <XMTok name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMApp scriptpos="mid">
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(23)" refnum="23" xml:id="S3.E23" fragid="S3.E23">
            <MathFork>
              <MathBranch>
                <td align="right"/>
                <td align="left"/>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E23.m6" tex="\displaystyle t_{sk}^{2}=t_{sk}^{1}+D_{sk}-1" text="(t _ (s * k)) ^ 2 = ((t _ (s * k)) ^ 1 + D _ (s * k)) - 1" fragid="S3.E23.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle t_{sk}^{2}=t_{sk}^{1}+D_{sk}-1" xml:id="S3.E23.m4" text="(t _ (s * k)) ^ 2 = ((t _ (s * k)) ^ 1 + D _ (s * k)) - 1" fragid="S3.E23.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(24)" refnum="24" xml:id="S3.E24" fragid="S3.E24">
            <MathFork>
              <Math xml:id="S3.E24.m5" tex="\displaystyle y_{t}=h(\theta_{x_{t}})" text="y _ t = h * theta _ x _ t" fragid="S3.E24.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E24.m5.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E24.m5.1" fragid="S3.E24.m5.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">x</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle y_{t}" xml:id="S3.E24.m1" text="y _ t" fragid="S3.E24.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=h(\theta_{x_{t}})" xml:id="S3.E24.m2" text="absent = h * theta _ x _ t" fragid="S3.E24.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">h</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E24.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E24.m2.1" fragid="S3.E24.m2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
            <MathFork>
              <Math xml:id="S3.E24.m6" tex="\displaystyle t=1,2,\ldots,T" text="t = list@(1, 2, ldots, T)" fragid="S3.E24.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E24.m6.1"/>
                        <XMRef idref="S3.E24.m6.2"/>
                        <XMRef idref="S3.E24.m6.3"/>
                        <XMRef idref="S3.E24.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok meaning="1" role="NUMBER" xml:id="S3.E24.m6.1" fragid="S3.E24.m6.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="2" role="NUMBER" xml:id="S3.E24.m6.2" fragid="S3.E24.m6.2">2</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="ldots" role="ID" xml:id="S3.E24.m6.3" fragid="S3.E24.m6.3">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.E24.m6.4" font="italic" fragid="S3.E24.m6.4">T</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle t=1,2,\ldots,T" xml:id="S3.E24.m4" text="t = list@(1, 2, ldots, T)" fragid="S3.E24.m4">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E24.m4.1"/>
                            <XMRef idref="S3.E24.m4.2"/>
                            <XMRef idref="S3.E24.m4.3"/>
                            <XMRef idref="S3.E24.m4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E24.m4.1" fragid="S3.E24.m4.1">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="S3.E24.m4.2" fragid="S3.E24.m4.2">2</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="ldots" role="ID" xml:id="S3.E24.m4.3" fragid="S3.E24.m4.3">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S3.E24.m4.4" font="italic" fragid="S3.E24.m4.4">T</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" xml:id="S3.SS2.p2.m8" tex="\beta^{WM}" text="beta ^ (W * M)" fragid="S3.SS2.p2.m8"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> is the base measure and <Math mode="inline" xml:id="S3.SS2.p2.m9" tex="\alpha^{WM}" text="alpha ^ (W * M)" fragid="S3.SS2.p2.m9"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> and <Math mode="inline" xml:id="S3.SS2.p2.m10" tex="\gamma^{WM}" text="gamma ^ (W * M)" fragid="S3.SS2.p2.m10"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> are hyperparameters of a word model, which generates words, i.e., latent letter sequences.
Furthermore, <Math mode="inline" xml:id="S3.SS2.p2.m11" tex="\operatorname*{DP}(\alpha^{WM},\beta^{WM})" content-tex="\DP(\alpha^{WM},\beta^{WM})" text="DP@(alpha ^ (W * M), beta ^ (W * M))" fragid="S3.SS2.p2.m11"><XMath><XMDual><XMApp><XMRef idref="S3.SS2.p2.m11.1"/><XMRef idref="S3.SS2.p2.m11.2"/><XMRef idref="S3.SS2.p2.m11.3"/></XMApp><XMApp><XMDual role="OPFUNCTION" xml:id="S3.SS2.p2.m11.1" fragid="S3.SS2.p2.m11.1"><XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/><XMTok role="OPERATOR" scriptpos="mid">DP</XMTok></XMDual><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS2.p2.m11.2" fragid="S3.SS2.p2.m11.2"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S3.SS2.p2.m11.3" fragid="S3.SS2.p2.m11.3"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMApp></XMDual></XMath></Math> outputs <Math mode="inline" xml:id="S3.SS2.p2.m12" tex="\pi^{WM}_{j}" text="(pi ^ (W * M)) _ j" fragid="S3.SS2.p2.m12"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMath></Math>, representing the transition probability from latent letter <Math mode="inline" xml:id="S3.SS2.p2.m13" tex="j" text="j" fragid="S3.SS2.p2.m13"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math> to the next latent letter. By contrast, <Math mode="inline" xml:id="S3.SS2.p2.m14" tex="\beta^{LM}" text="beta ^ (L * M)" fragid="S3.SS2.p2.m14"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> is the base measure, <Math mode="inline" xml:id="S3.SS2.p2.m15" tex="\alpha^{LM}" text="alpha ^ (L * M)" fragid="S3.SS2.p2.m15"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> and <Math mode="inline" xml:id="S3.SS2.p2.m16" tex="\gamma^{LM}" text="gamma ^ (L * M)" fragid="S3.SS2.p2.m16"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> are hyperparameters of the language model, and <Math mode="inline" xml:id="S3.SS2.p2.m17" tex="\operatorname*{DP}(\alpha^{LM},\beta^{LM})" content-tex="\DP(\alpha^{LM},\beta^{LM})" text="DP@(alpha ^ (L * M), beta ^ (L * M))" fragid="S3.SS2.p2.m17"><XMath><XMDual><XMApp><XMRef idref="S3.SS2.p2.m17.1"/><XMRef idref="S3.SS2.p2.m17.2"/><XMRef idref="S3.SS2.p2.m17.3"/></XMApp><XMApp><XMDual role="OPFUNCTION" xml:id="S3.SS2.p2.m17.1" fragid="S3.SS2.p2.m17.1"><XMTok name="DP" role="OPFUNCTION" scriptpos="mid"/><XMTok role="OPERATOR" scriptpos="mid">DP</XMTok></XMDual><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS2.p2.m17.2" fragid="S3.SS2.p2.m17.2"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S3.SS2.p2.m17.3" fragid="S3.SS2.p2.m17.3"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMApp></XMDual></XMath></Math> outputs <Math mode="inline" xml:id="S3.SS2.p2.m18" tex="\pi^{LM}_{i}" text="(pi ^ (L * M)) _ i" fragid="S3.SS2.p2.m18"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>, representing the transition probability from latent word <Math mode="inline" xml:id="S3.SS2.p2.m19" tex="i" text="i" fragid="S3.SS2.p2.m19"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> to the next latent word. The superscripts <Math mode="inline" xml:id="S3.SS2.p2.m20" tex="LM" text="L * M" fragid="S3.SS2.p2.m20"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S3.SS2.p2.m21" tex="WM" text="W * M" fragid="S3.SS2.p2.m21"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMath></Math> indicate language model (LM) or word model (WM), respectively.
The latent letters contained in the <Math mode="inline" xml:id="S3.SS2.p2.m22" tex="i" text="i" fragid="S3.SS2.p2.m22"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>-th latent word <Math mode="inline" xml:id="S3.SS2.p2.m23" tex="w_{i}" text="w _ i" fragid="S3.SS2.p2.m23"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> are sequentially sampled from <Math mode="inline" xml:id="S3.SS2.p2.m24" tex="\pi^{WM}_{w_{ik-1}}" text="(pi ^ (W * M)) _ w _ (i * k - 1)" fragid="S3.SS2.p2.m24"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMath></Math>. The <Math mode="inline" xml:id="S3.SS2.p2.m25" tex="k" text="k" fragid="S3.SS2.p2.m25"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-th latent letter of the <Math mode="inline" xml:id="S3.SS2.p2.m26" tex="i" text="i" fragid="S3.SS2.p2.m26"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>-th latent word is represented by <Math mode="inline" xml:id="S3.SS2.p2.m27" tex="w_{ik}" text="w _ (i * k)" fragid="S3.SS2.p2.m27"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math>.</p>
      </para>
      <para xml:id="S3.SS2.p3" fragid="S3.SS2.p3">
        <p>In contrast with HMMs, the duration distribution is explicitly determined for each latent letter <Math mode="inline" xml:id="S3.SS2.p3.m1" tex="l_{sk}" text="l _ (s * k)" fragid="S3.SS2.p3.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math> in the HDP-HLM. The HDP-HLM inherits this property from the HDP-HSMM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>. The duration time <Math mode="inline" xml:id="S3.SS2.p3.m2" tex="D_{sk}" text="D _ (s * k)" fragid="S3.SS2.p3.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math> of latent letter <Math mode="inline" xml:id="S3.SS2.p3.m3" tex="l_{sk}" text="l _ (s * k)" fragid="S3.SS2.p3.m3"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math>, which is the <Math mode="inline" xml:id="S3.SS2.p3.m4" tex="k" text="k" fragid="S3.SS2.p3.m4"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-th latent letter of the <Math mode="inline" xml:id="S3.SS2.p3.m5" tex="s" text="s" fragid="S3.SS2.p3.m5"><XMath><XMTok role="UNKNOWN" font="italic">s</XMTok></XMath></Math>-th latent word <Math mode="inline" xml:id="S3.SS2.p3.m6" tex="z_{s}" text="z _ s" fragid="S3.SS2.p3.m6"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> in a sampled word sequence, is drawn from the duration distribution <Math mode="inline" xml:id="S3.SS2.p3.m7" tex="g(\omega_{l_{sk}})" text="g * omega _ l _ (s * k)" fragid="S3.SS2.p3.m7"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="S3.SS2.p3.m7.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS2.p3.m7.1" fragid="S3.SS2.p3.m7.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S3.SS2.p3.m8" tex="\omega_{l_{sk}}" text="omega _ l _ (s * k)" fragid="S3.SS2.p3.m8"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMApp></XMath></Math> is the duration parameter for latent letter <Math mode="inline" xml:id="S3.SS2.p3.m9" tex="l_{sk}" text="l _ (s * k)" fragid="S3.SS2.p3.m9"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math>.
The duration of a latent word <Math mode="inline" xml:id="S3.SS2.p3.m10" tex="w_{s}" text="w _ s" fragid="S3.SS2.p3.m10"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> becomes <Math mode="inline" xml:id="S3.SS2.p3.m11" tex="D_{s}=\sum_{k=1}^{L_{z_{s}}}D_{sk}" text="D _ s = ((sum _ (k = 1)) ^ (L _ z _ s))@(D _ (s * k))" fragid="S3.SS2.p3.m11"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>. When we assume that <Math mode="inline" xml:id="S3.SS2.p3.m12" tex="g" text="g" fragid="S3.SS2.p3.m12"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> is a Poisson distribution, <Math mode="inline" xml:id="S3.SS2.p3.m13" tex="D_{s}" text="D _ s" fragid="S3.SS2.p3.m13"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> also follows a Poisson distribution whose parameter is <Math mode="inline" xml:id="S3.SS2.p3.m14" tex="\sum_{k=1}^{L_{z_{s}}}\omega_{l_{sk}}" text="((sum _ (k = 1)) ^ (L _ z _ s))@(omega _ l _ (s * k))" fragid="S3.SS2.p3.m14"><XMath><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math> because of the properties of Poisson distributions.</p>
      </para>
      <para xml:id="S3.SS2.p4" fragid="S3.SS2.p4">
        <p>In the HDP-HLM, latent word <Math mode="inline" xml:id="S3.SS2.p4.m1" tex="z_{s}" text="z _ s" fragid="S3.SS2.p4.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> determines a latent letter sequence <Math mode="inline" xml:id="S3.SS2.p4.m2" tex="l_{sk}=w_{{z_{s}}k}\ (k=1,2,\ldots,L_{z_{s}})" fragid="S3.SS2.p4.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp rpadding="5.0pt"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>. Based on the determined sequence <Math mode="inline" xml:id="S3.SS2.p4.m3" tex="w_{z_{s}}" text="w _ z _ s" fragid="S3.SS2.p4.m3"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp></XMath></Math>, duration <Math mode="inline" xml:id="S3.SS2.p4.m4" tex="D_{sk}" text="D _ (s * k)" fragid="S3.SS2.p4.m4"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math> of <Math mode="inline" xml:id="S3.SS2.p4.m5" tex="l_{sk}" text="l _ (s * k)" fragid="S3.SS2.p4.m5"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math> is drawn, and observations <Math mode="inline" xml:id="S3.SS2.p4.m6" tex="y_{t}" text="y _ t" fragid="S3.SS2.p4.m6"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> are drawn from an emission distribution <Math mode="inline" xml:id="S3.SS2.p4.m7" tex="h(\theta_{x_{t}})" text="h * theta _ x _ t" fragid="S3.SS2.p4.m7"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok><XMDual><XMRef idref="S3.SS2.p4.m7.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS2.p4.m7.1" fragid="S3.SS2.p4.m7.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> corresponding to <Math mode="inline" xml:id="S3.SS2.p4.m8" tex="x_{t}=l_{s(t)k(t)}" text="x _ t = l _ (s * t * k * t)" fragid="S3.SS2.p4.m8"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">l</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S3.SS2.p4.m8.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S3.SS2.p4.m8.1" font="italic" fragid="S3.SS2.p4.m8.1">t</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok role="UNKNOWN" font="italic">k</XMTok><XMDual><XMRef idref="S3.SS2.p4.m8.2"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S3.SS2.p4.m8.2" font="italic" fragid="S3.SS2.p4.m8.2">t</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMApp></XMath></Math>. The maps <Math mode="inline" xml:id="S3.SS2.p4.m9" tex="s(t)" text="s * t" fragid="S3.SS2.p4.m9"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S3.SS2.p4.m9.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S3.SS2.p4.m9.1" font="italic" fragid="S3.SS2.p4.m9.1">t</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> and <Math mode="inline" xml:id="S3.SS2.p4.m10" tex="k(t)" text="k * t" fragid="S3.SS2.p4.m10"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMDual><XMRef idref="S3.SS2.p4.m10.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S3.SS2.p4.m10.1" font="italic" fragid="S3.SS2.p4.m10.1">t</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> represent the indices of words and letters, respectively, in a latent word sequence at time <Math mode="inline" xml:id="S3.SS2.p4.m11" tex="t" text="t" fragid="S3.SS2.p4.m11"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math>. Using this generative model, a continuous time series data with a latent double articulation structure can be generated.
In this paper, we assume that observed time series data <Math mode="inline" xml:id="S3.SS2.p4.m12" tex="y_{t}" text="y _ t" fragid="S3.SS2.p4.m12"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> represents a feature vector of the speech signal at time <Math mode="inline" xml:id="S3.SS2.p4.m13" tex="t" text="t" fragid="S3.SS2.p4.m13"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math> and is generated in this way. Generally, the HDP-HLM can be applied to any kind of time series data that has a double articulation structure.</p>
      </para>
      <para xml:id="S3.SS2.p5" fragid="S3.SS2.p5">
        <p>From the viewpoint of language acquisition, we review the generative model. In the conventional DAA <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Taniguchi2011" title="Taniguchi2011">Taniguchi2011</ref>]</cite>, a DAA is composed of two separated machine learning methods, i.e., sticky HDP-HMM for encoding observation data to letter sequences and NPYLM for chunking letter sequences into word sequences.
On the one hand, the transition probabilities <Math mode="inline" xml:id="S3.SS2.p5.m1" tex="\pi_{i}^{LM}" text="(pi _ i) ^ (L * M)" fragid="S3.SS2.p5.m1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math> and <Math mode="inline" xml:id="S3.SS2.p5.m2" tex="\pi^{WM}_{i}" text="(pi ^ (W * M)) _ i" fragid="S3.SS2.p5.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> correspond to the word bigram and letter bigram models in the NPYLM, respectively. Therefore, <Math mode="inline" xml:id="S3.SS2.p5.m3" tex="(\pi^{LM},\pi^{WM})" text="open-interval@(pi ^ (L * M), pi ^ (W * M))" fragid="S3.SS2.p5.m3"><XMath><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="S3.SS2.p5.m3.1"/><XMRef idref="S3.SS2.p5.m3.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S3.SS2.p5.m3.1" fragid="S3.SS2.p5.m3.1"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S3.SS2.p5.m3.2" fragid="S3.SS2.p5.m3.2"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> contains information regarding a language model. On the other hand, <Math mode="inline" xml:id="S3.SS2.p5.m4" tex="\{\omega_{j},\theta_{j}\}_{j=1,2,\ldots,\infty}" text="(set@(omega _ j, theta _ j)) _ (j = list@(1, 2, ldots, infinity))" fragid="S3.SS2.p5.m4"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S3.SS2.p5.m4.5"/><XMRef idref="S3.SS2.p5.m4.6"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S3.SS2.p5.m4.5" fragid="S3.SS2.p5.m4.5"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S3.SS2.p5.m4.6" fragid="S3.SS2.p5.m4.6"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="S3.SS2.p5.m4.1"/><XMRef idref="S3.SS2.p5.m4.2"/><XMRef idref="S3.SS2.p5.m4.3"/><XMRef idref="S3.SS2.p5.m4.4"/></XMApp><XMWrap><XMTok meaning="1" role="NUMBER" xml:id="S3.SS2.p5.m4.1" fragid="S3.SS2.p5.m4.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S3.SS2.p5.m4.2" fragid="S3.SS2.p5.m4.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S3.SS2.p5.m4.3" fragid="S3.SS2.p5.m4.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="infinity" name="infty" role="ID" xml:id="S3.SS2.p5.m4.4" fragid="S3.SS2.p5.m4.4">∞</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math> contains information regarding an acoustic model, which corresponds to a sticky HDP-HMM in conventional DAA.</p>
      </para>
      <para xml:id="S3.SS2.p6" fragid="S3.SS2.p6">
        <p>The HDP-HLM assumes that the language model consists of a word bigram model. Mochihashi et al. compared the bigram and trigram language models and showed that the trigram assumption hardly improved the word segmentation performance although computational cost and complexity increased  <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Mochihashi2009" title="Mochihashi2009">Mochihashi2009</ref>]</cite>. Therefore, the bigram assumption must be appropriate for a word segmentation and word discovery task.
<!-- %**** ieee˙daa.tex Line 275 **** --></p>
      </para>
      <para xml:id="S3.SS2.p7" fragid="S3.SS2.p7">
        <p>If we derive an efficient inference procedure for this two-layer hierarchical generative model, the inference procedure can infer the acoustic model and language model simultaneously.</p>
      </para>
    </subsection>
  </section>
  <section refnum="4" xml:id="S4" labels="LABEL:sec4" fragid="S4">
    <title><tag close=" ">4</tag>Inference algorithm</title>
    <para xml:id="S4.p1" fragid="S4.p1">
      <p>In this section, we derive an approximated blocked Gibbs sampler for the HDP-HLM. The sampler can simultaneously infer latent letters, latent words, a language model, and an acoustic model. Concurrently, the inference procedure can estimate the overall double articulation structure from continuous time series data. Therefore, we propose the unsupervised machine learning method NPB-DAA.
The overall inference procedure is shown in Algorithm 1.
<!-- %It is difficult for a naive direct assignment Gibbs sampler to infer latent words and letters. The mixing rate becomes miserably low because the hierarchical generative model is somewhat complicated and temporally correlated  even more tightly than the original HDP-HSMM and sticky HDP-HMM~“cite–Fox2009,johnson2013˝. Therefore, we develop a blocked Gibbs sampler by extending the blocked Gibbs sampler proposed by Johnson et al. for the HDP-HSMM based on weak-limit approximation~“cite–johnson2013˝. --></p>
    </para>
    <subsection refnum="4.1" xml:id="S4.SS1" fragid="S4.SS1">
      <title><tag close=" ">4.1</tag>Inference of latent words: <Math mode="inline" xml:id="S4.SS1.m1" tex="z_{s}" text="z _ s" fragid="S4.SS1.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math></title>
      <para xml:id="S4.SS1.p1" fragid="S4.SS1.p1">
        <p>In the HDP-HSMM, a backward filtering forward sampling procedure is adopted instead of the direct assignment procedure. When each latent state strongly depends on other neighboring latent states, the direct assignment procedure, which is a naive implementation of the Gibbs sampler, results in a poor mixing rate <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>.
Johnson et al. showed that a blocked Gibbs sampler using a backward filtering forward sampling procedure that can simultaneously sample all hidden states of an observed sequence outperforms a direct-assignment Gibbs sampler.
By extending the backward filtering forward-sampling procedure and making it applicable to HDP-HLM, we can obtain an inference procedure for HDP-HLM.</p>
      </para>
      <para xml:id="S4.SS1.p2" fragid="S4.SS1.p2">
        <p>The calculation of the backward messages for super states <Math mode="inline" xml:id="S4.SS1.p2.m1" tex="i" text="i" fragid="S4.SS1.p2.m1"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> in HDP-HSMM is as follows.</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx7" fragid="S7.EGx7">
          <equation frefnum="(25)" refnum="25" xml:id="S4.E25" labels="LABEL:eq:1" fragid="S4.E25">
            <MathFork>
              <Math xml:id="S4.E25.m3" tex="\displaystyle B_{t}(i)=P(y_{t+1:T}\mid z_{s(t)}=i,F_{t}=1)" fragid="S4.E25.m3">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                    <XMTok role="UNKNOWN" font="italic">B</XMTok>
                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" xml:id="S4.E25.m3.2" font="italic" fragid="S4.E25.m3.2">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.E25.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E25.m3.1" font="italic" fragid="S4.E25.m3.1">t</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">F</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle B_{t}(i)" xml:id="S4.E25.m1" text="B _ t * i" fragid="S4.E25.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">B</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.E25.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E25.m1.1" font="italic" fragid="S4.E25.m1.1">i</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=P(y_{t+1:T}\mid z_{s(t)}=i,F_{t}=1)" xml:id="S4.E25.m2" fragid="S4.E25.m2">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMDual>
                              <XMRef idref="S4.E25.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S4.E25.m2.1" font="italic" fragid="S4.E25.m2.1">t</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">F</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(26)" refnum="26" xml:id="S4.E26" labels="LABEL:eq:3" fragid="S4.E26">
            <MathFork>
              <Math xml:id="S4.E26.m3" tex="\displaystyle=\sum_{j}B_{t}^{*}(j)P(z_{s(t+1)}=j\mid z_{s(t)}=i)" fragid="S4.E26.m3">
                <XMath>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">B</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMTok meaning="times" role="MULOP">*</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" xml:id="S4.E26.m3.3" font="italic" fragid="S4.E26.m3.3">j</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.E26.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E26.m3.1" fragid="S4.E26.m3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.E26.m3.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E26.m3.2" font="italic" fragid="S4.E26.m3.2">t</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\sum_{j}B_{t}^{*}(j)P(z_{s(t+1)}=j\mid z_{s(t)}=i)" xml:id="S4.E26.m2" fragid="S4.E26.m2">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">B</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                        <XMTok meaning="times" role="MULOP">*</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S4.E26.m2.3" font="italic" fragid="S4.E26.m2.3">j</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMDual>
                              <XMRef idref="S4.E26.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S4.E26.m2.1" fragid="S4.E26.m2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMDual>
                              <XMRef idref="S4.E26.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S4.E26.m2.2" font="italic" fragid="S4.E26.m2.2">t</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(27)" refnum="27" xml:id="S4.E27" labels="LABEL:eq:2" fragid="S4.E27">
            <MathFork>
              <Math xml:id="S4.E27.m3" tex="\displaystyle B_{t}^{*}(i)=P(y_{t+1:T}\mid z_{s(t+1)}=i,F_{t}=1)" fragid="S4.E27.m3">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">B</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMTok meaning="times" role="MULOP">*</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" xml:id="S4.E27.m3.2" font="italic" fragid="S4.E27.m3.2">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.E27.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E27.m3.1" fragid="S4.E27.m3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">F</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle B_{t}^{*}(i)" xml:id="S4.E27.m1" text="(B _ t) ^ * * i" fragid="S4.E27.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                            <XMTok role="UNKNOWN" font="italic">B</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          </XMApp>
                          <XMTok meaning="times" role="MULOP">*</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.E27.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E27.m1.1" font="italic" fragid="S4.E27.m1.1">i</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=P(y_{t+1:T}\mid z_{s(t+1)}=i,F_{t}=1)" xml:id="S4.E27.m2" fragid="S4.E27.m2">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMDual>
                              <XMRef idref="S4.E27.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S4.E27.m2.1" fragid="S4.E27.m2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">F</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex2" fragid="S4.Ex2">
            <MathFork>
              <Math xml:id="S4.Ex2.m3" tex="\displaystyle=\sum_{d=1}^{T-t}B_{t+d}(i)P(D_{t+1}=d\mid z_{s(t+1)}=i)" fragid="S4.Ex2.m3">
                <XMath>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok role="UNKNOWN" font="italic">T</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                    <XMTok role="UNKNOWN" font="italic">B</XMTok>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" xml:id="S4.Ex2.m3.2" font="italic" fragid="S4.Ex2.m3.2">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.Ex2.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.Ex2.m3.1" fragid="S4.Ex2.m3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\sum_{d=1}^{T-t}B_{t+d}(i)P(D_{t+1}=d\mid z_{s(t+1)}=i)" xml:id="S4.Ex2.m2" fragid="S4.Ex2.m2">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">B</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S4.Ex2.m2.2" font="italic" fragid="S4.Ex2.m2.2">i</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMDual>
                              <XMRef idref="S4.Ex2.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S4.Ex2.m2.1" fragid="S4.Ex2.m2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(28)" refnum="28" xml:id="S4.E28" labels="LABEL:eq:4" fragid="S4.E28">
            <MathFork>
              <Math xml:id="S4.E28.m3" tex="\displaystyle~{}~{}~{}~{}\times P(y_{t+1:t+d}\mid z_{s(t+1)}=i,D_{t+1}=d)" fragid="S4.E28.m3">
                <XMath>
                  <XMTok role="UNKNOWN" rpadding="9.9pt"> </XMTok>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.E28.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E28.m3.1" fragid="S4.E28.m3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle~{}~{}~{}~{}\times P(y_{t+1:t+d}\mid z_{s(t+1)}=i,D_{t+1}=d)" xml:id="S4.E28.m2" fragid="S4.E28.m2">
                    <XMath>
                      <XMTok role="UNKNOWN" rpadding="9.9pt"> </XMTok>
                      <XMTok meaning="times" role="MULOP">×</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMDual>
                              <XMRef idref="S4.E28.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S4.E28.m2.1" fragid="S4.E28.m2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(29)" refnum="29" xml:id="S4.E29" labels="LABEL:eq:9" fragid="S4.E29">
            <MathFork>
              <Math xml:id="S4.E29.m3" tex="\displaystyle B_{T}(i)=1" text="B _ T * i = 1" fragid="S4.E29.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">B</XMTok>
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S4.E29.m3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="S4.E29.m3.1" font="italic" fragid="S4.E29.m3.1">i</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle B_{T}(i)" xml:id="S4.E29.m1" text="B _ T * i" fragid="S4.E29.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">B</XMTok>
                          <XMTok role="UNKNOWN" font="italic">T</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.E29.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E29.m1.1" font="italic" fragid="S4.E29.m1.1">i</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=1" xml:id="S4.E29.m2" text="absent = 1" fragid="S4.E29.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <!-- %**** ieee˙daa.tex Line 300 **** -->
        <p>where <Math mode="inline" xml:id="S4.SS1.p2.m2" tex="F_{t}" text="F _ t" fragid="S4.SS1.p2.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">F</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> is a variable indicating that <Math mode="inline" xml:id="S4.SS1.p2.m3" tex="t" text="t" fragid="S4.SS1.p2.m3"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math> is the boundary of the super state. If <Math mode="inline" xml:id="S4.SS1.p2.m4" tex="F_{t}=1" text="F _ t = 1" fragid="S4.SS1.p2.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">F</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>, <Math mode="inline" xml:id="S4.SS1.p2.m5" tex="z_{s(t)}\neq z_{s(t+1)}" text="z _ (s * t) not-equals z _ (s * (t + 1))" fragid="S4.SS1.p2.m5"><XMath><XMApp><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p2.m5.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p2.m5.1" font="italic" fragid="S4.SS1.p2.m5.1">t</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p2.m5.2"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p2.m5.2" fragid="S4.SS1.p2.m5.2"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMApp></XMath></Math>. The variable <Math mode="inline" xml:id="S4.SS1.p2.m6" tex="B_{t}(i)" text="B _ t * i" fragid="S4.SS1.p2.m6"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p2.m6.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p2.m6.1" font="italic" fragid="S4.SS1.p2.m6.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> in (<ref labelref="LABEL:eq:1" href="#S4.E25" title="(25) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">25</text></ref>) represents the probability that the latent super state <Math mode="inline" xml:id="S4.SS1.p2.m7" tex="z_{s(t)}=i" text="z _ (s * t) = i" fragid="S4.SS1.p2.m7"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p2.m7.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p2.m7.1" font="italic" fragid="S4.SS1.p2.m7.1">t</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> and that it transitions into a different super state at the next time step. Probability <Math mode="inline" xml:id="S4.SS1.p2.m8" tex="B_{t}(i)" text="B _ t * i" fragid="S4.SS1.p2.m8"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p2.m8.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p2.m8.1" font="italic" fragid="S4.SS1.p2.m8.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is obtained by marginalizing over all super states <Math mode="inline" xml:id="S4.SS1.p2.m9" tex="j" text="j" fragid="S4.SS1.p2.m9"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math> at time step <Math mode="inline" xml:id="S4.SS1.p2.m10" tex="t+1" text="t + 1" fragid="S4.SS1.p2.m10"><XMath><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>. Variable <Math mode="inline" xml:id="S4.SS1.p2.m11" tex="B_{t}^{*}(j)" text="(B _ t) ^ * * j" fragid="S4.SS1.p2.m11"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMTok meaning="times" role="MULOP">*</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p2.m11.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p2.m11.1" font="italic" fragid="S4.SS1.p2.m11.1">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> in (<ref labelref="LABEL:eq:2" href="#S4.E27" title="(27) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">27</text></ref>) represents the probability that the latent super state becomes <Math mode="inline" xml:id="S4.SS1.p2.m12" tex="j" text="j" fragid="S4.SS1.p2.m12"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math> from time step <Math mode="inline" xml:id="S4.SS1.p2.m13" tex="t+1" text="t + 1" fragid="S4.SS1.p2.m13"><XMath><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>. This probability can be obtained by marginalizing over the duration variable in (<ref labelref="LABEL:eq:4" href="#S4.E28" title="(28) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">28</text></ref>). Probability <Math mode="inline" xml:id="S4.SS1.p2.m14" tex="P(y_{t+1:t+d}\mid z_{s(t+1)}=i,D_{t+1}=d)" fragid="S4.SS1.p2.m14"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p2.m14.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p2.m14.1" fragid="S4.SS1.p2.m14.1"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> in (<ref labelref="LABEL:eq:4" href="#S4.E28" title="(28) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">28</text></ref>) shows the emission probability of observed data <Math mode="inline" xml:id="S4.SS1.p2.m15" tex="y_{t+1:t+d}" text="y _ (t + 1 colon t + d)" fragid="S4.SS1.p2.m15"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp></XMath></Math> given the condition that the duration <Math mode="inline" xml:id="S4.SS1.p2.m16" tex="D_{t+1}" text="D _ (t + 1)" fragid="S4.SS1.p2.m16"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math> of <Math mode="inline" xml:id="S4.SS1.p2.m17" tex="z_{s(t+1)}" text="z _ (s * (t + 1))" fragid="S4.SS1.p2.m17"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p2.m17.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p2.m17.1" fragid="S4.SS1.p2.m17.1"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math> is <Math mode="inline" xml:id="S4.SS1.p2.m18" tex="d" text="d" fragid="S4.SS1.p2.m18"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>.
In the HDP-HSMM, all time steps with the same super state <Math mode="inline" xml:id="S4.SS1.p2.m19" tex="z" text="z" fragid="S4.SS1.p2.m19"><XMath><XMTok role="UNKNOWN" font="italic">z</XMTok></XMath></Math> share the same emission distribution. Therefore, the likelihood of a super state <Math mode="inline" xml:id="S4.SS1.p2.m20" tex="z_{s(t+1)}" text="z _ (s * (t + 1))" fragid="S4.SS1.p2.m20"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p2.m20.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p2.m20.1" fragid="S4.SS1.p2.m20.1"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>, i.e., <Math mode="inline" xml:id="S4.SS1.p2.m21" tex="P(y_{t+1:t+d}\mid z_{t+1},D_{t+1}=d)" fragid="S4.SS1.p2.m21"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>, can be calculated easily.
<!-- %“begin–align˝ 
     %P(y˙–t + 1 : t + d˝ “mid z˙–t + 1˝, D˙–t + 1˝ = d) = “prod˙–k = 1˝^–d˝
     %P(y˙–t + k˝ “mid “theta˙–z˙–t + 1˝˝). “label–eq:hsmm-5˝
     %“end–align˝--></p>
      </para>
      <para xml:id="S4.SS1.p3" fragid="S4.SS1.p3">
        <p>Surprisingly, in HDP-HLM, the exact same procedure of calculating backward messages as that of HDP-HSMM can be used.
We obtain a message passing algorithm for HDP-HLM by replacing a super state <Math mode="inline" xml:id="S4.SS1.p3.m1" tex="z_{s}" text="z _ s" fragid="S4.SS1.p3.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> in HDP-HSMM with latent word <Math mode="inline" xml:id="S4.SS1.p3.m2" tex="z_{s}" text="z _ s" fragid="S4.SS1.p3.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> in HDP-HLM. Only the likelihood of the latent word <Math mode="inline" xml:id="S4.SS1.p3.m3" tex="w_{s}" text="w _ s" fragid="S4.SS1.p3.m3"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math>, i.e., <Math mode="inline" xml:id="S4.SS1.p3.m4" tex="P(y_{t+1:t+d}\mid z_{s(t+1)}=i,D_{t+1}=d)" fragid="S4.SS1.p3.m4"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p3.m4.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p3.m4.1" fragid="S4.SS1.p3.m4.1"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>, is different between the two message passing algorithms.
The likelihood of the occurrence of latent word <Math mode="inline" xml:id="S4.SS1.p3.m5" tex="z_{s(t+1)}=i" text="z _ (s * (t + 1)) = i" fragid="S4.SS1.p3.m5"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMDual><XMRef idref="S4.SS1.p3.m5.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p3.m5.1" fragid="S4.SS1.p3.m5.1"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> then becomes</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx8" fragid="S7.EGx8">
          <equation xml:id="S4.Ex3" fragid="S4.Ex3">
            <MathFork>
              <Math xml:id="S4.Ex3.m3" tex="\displaystyle P(y_{t+1:t+d}\mid z_{s(t+1)}=i,D_{t+1}=d)" fragid="S4.Ex3.m3">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMRef idref="S4.Ex3.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.Ex3.m3.1" fragid="S4.Ex3.m3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle P(y_{t+1:t+d}" xml:id="S4.Ex3.m1" fragid="S4.Ex3.m1">
                    <XMath>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mid z_{s(t+1)}=i,D_{t+1}=d)" xml:id="S4.Ex3.m2" fragid="S4.Ex3.m2">
                    <XMath>
                      <XMTok name="mid" role="VERTBAR">∣</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">z</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMDual>
                            <XMRef idref="S4.Ex3.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S4.Ex3.m2.1" fragid="S4.Ex3.m2.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(30)" refnum="30" xml:id="S4.E30" labels="LABEL:eq:5" fragid="S4.E30">
            <MathFork>
              <Math xml:id="S4.E30.m3" tex="\displaystyle=\sum_{r\in R^{(L_{i},d)}}\prod_{k=1}^{L_{i}}P(r_{k}\mid\omega_{w%&#10;_{ik}})\prod_{m=1}^{r_{k}}{P(y_{t+m+\sum_{k^{\prime}=1}^{k-1}r_{k^{\prime}}}%&#10;\mid\theta_{w_{ik}})}." fragid="S4.E30.m3">
                <XMath>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">R</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S4.E30.m3.2"/>
                            <XMRef idref="S4.E30.m3.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E30.m3.2" fragid="S4.E30.m3.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E30.m3.1" font="italic" fragid="S4.E30.m3.1">d</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                      <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                      <XMTok role="UNKNOWN" font="italic">L</XMTok>
                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                      <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">m</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok role="UNKNOWN" font="italic">m</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                              <XMApp>
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post10"/>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="italic">r</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post10"/>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                      <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok role="PERIOD">.</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\sum_{r\in R^{(L_{i},d)}}\prod_{k=1}^{L_{i}}P(r_{k}\mid\omega_{w%&#10;_{ik}})\prod_{m=1}^{r_{k}}{P(y_{t+m+\sum_{k^{\prime}=1}^{k-1}r_{k^{\prime}}}%&#10;\mid\theta_{w_{ik}})}." xml:id="S4.E30.m2" fragid="S4.E30.m2">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok role="UNKNOWN" font="italic">r</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">R</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S4.E30.m2.2"/>
                                <XMRef idref="S4.E30.m2.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S4.E30.m2.2" fragid="S4.E30.m2.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="italic">L</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S4.E30.m2.1" font="italic" fragid="S4.E30.m2.1">d</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">r</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">w</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok role="UNKNOWN" font="italic">m</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">r</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok role="UNKNOWN" font="italic">m</XMTok>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post10"/>
                                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                      <XMTok name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post10"/>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="italic">w</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(31)" refnum="31" xml:id="S4.E31" fragid="S4.E31">
            <MathFork>
              <Math xml:id="S4.E31.m3" tex="\displaystyle R^{(L_{i},d)}=\left\{r\mid|r|=L_{i},\sum_{k=1}^{|r|}r_{k}=d\right\}" text="R ^ (open-interval@(L _ i, d)) = conditional-set@(r, formulae@(absolute-value@(r) = L _ i, ((sum _ (k = 1)) ^ (absolute-value@(r)))@(r _ k) = d))" fragid="S4.E31.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">R</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.E31.m3.2"/>
                          <XMRef idref="S4.E31.m3.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S4.E31.m3.2" fragid="S4.E31.m3.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok role="UNKNOWN" xml:id="S4.E31.m3.1" font="italic" fragid="S4.E31.m3.1">d</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="conditional-set"/>
                        <XMRef idref="S4.E31.m3.5"/>
                        <XMRef idref="S4.E31.m3.6"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN">{</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S4.E31.m3.5" font="italic" fragid="S4.E31.m3.5">r</XMTok>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMDual xml:id="S4.E31.m3.6" fragid="S4.E31.m3.6">
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="S4.E31.m3.6.1"/>
                            <XMRef idref="S4.E31.m3.6.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S4.E31.m3.6.1" fragid="S4.E31.m3.6.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="S4.E31.m3.4"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="S4.E31.m3.4" font="italic" fragid="S4.E31.m3.4">r</XMTok>
                                  <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">L</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S4.E31.m3.6.2" fragid="S4.E31.m3.6.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMApp scriptpos="mid">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                                  <XMApp scriptpos="mid">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="S4.E31.m3.3"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="S4.E31.m3.3" font="italic" fragid="S4.E31.m3.3">r</XMTok>
                                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="CLOSE">}</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle R^{(L_{i},d)}" xml:id="S4.E31.m1" text="R ^ (open-interval@(L _ i, d))" fragid="S4.E31.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">R</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S4.E31.m1.2"/>
                            <XMRef idref="S4.E31.m1.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E31.m1.2" fragid="S4.E31.m1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E31.m1.1" font="italic" fragid="S4.E31.m1.1">d</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\left\{r\mid|r|=L_{i},\sum_{k=1}^{|r|}r_{k}=d\right\}" xml:id="S4.E31.m2" text="absent = conditional-set@(r, formulae@(absolute-value@(r) = L _ i, ((sum _ (k = 1)) ^ (absolute-value@(r)))@(r _ k) = d))" fragid="S4.E31.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="conditional-set"/>
                            <XMRef idref="S4.E31.m2.3"/>
                            <XMRef idref="S4.E31.m2.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN">{</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E31.m2.3" font="italic" fragid="S4.E31.m2.3">r</XMTok>
                            <XMTok name="mid" role="VERTBAR">∣</XMTok>
                            <XMDual xml:id="S4.E31.m2.4" fragid="S4.E31.m2.4">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="S4.E31.m2.4.1"/>
                                <XMRef idref="S4.E31.m2.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S4.E31.m2.4.1" fragid="S4.E31.m2.4.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="S4.E31.m2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="S4.E31.m2.2" font="italic" fragid="S4.E31.m2.2">r</XMTok>
                                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">L</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S4.E31.m2.4.2" fragid="S4.E31.m2.4.2">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMApp scriptpos="mid">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                                      <XMApp scriptpos="mid">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="absolute-value"/>
                                          <XMRef idref="S4.E31.m2.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                          <XMTok role="UNKNOWN" xml:id="S4.E31.m2.1" font="italic" fragid="S4.E31.m2.1">r</XMTok>
                                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE">}</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" xml:id="S4.SS1.p3.m6" tex="|x|" text="absolute-value@(x)" fragid="S4.SS1.p3.m6"><XMath><XMDual><XMApp><XMTok meaning="absolute-value"/><XMRef idref="S4.SS1.p3.m6.1"/></XMApp><XMWrap><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p3.m6.1" font="italic" fragid="S4.SS1.p3.m6.1">x</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok></XMWrap></XMDual></XMath></Math> indicates the number of elements in vector <Math mode="inline" xml:id="S4.SS1.p3.m7" tex="x" text="x" fragid="S4.SS1.p3.m7"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math>, and <Math mode="inline" xml:id="S4.SS1.p3.m8" tex="r=(r_{i},r_{2},\ldots,r_{L_{i}})" text="r = vector@(r _ i, r _ 2, ldots, r _ L _ i)" fragid="S4.SS1.p3.m8"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S4.SS1.p3.m8.2"/><XMRef idref="S4.SS1.p3.m8.3"/><XMRef idref="S4.SS1.p3.m8.1"/><XMRef idref="S4.SS1.p3.m8.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS1.p3.m8.2" fragid="S4.SS1.p3.m8.2"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S4.SS1.p3.m8.3" fragid="S4.SS1.p3.m8.3"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S4.SS1.p3.m8.1" fragid="S4.SS1.p3.m8.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S4.SS1.p3.m8.4" fragid="S4.SS1.p3.m8.4"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">r</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is an <Math mode="inline" xml:id="S4.SS1.p3.m9" tex="L_{i}" text="L _ i" fragid="S4.SS1.p3.m9"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>-partition of duration <Math mode="inline" xml:id="S4.SS1.p3.m10" tex="d" text="d" fragid="S4.SS1.p3.m10"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>.
By substituting (<ref labelref="LABEL:eq:5" href="#S4.E30" title="(30) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">30</text></ref>) into (<ref labelref="LABEL:eq:4" href="#S4.E28" title="(28) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">28</text></ref>), we can obtain a formula to calculate the backward message of HDP-HLM.</p>
      </para>
      <para xml:id="S4.SS1.p4" fragid="S4.SS1.p4">
        <p>The calculation of (<ref labelref="LABEL:eq:5" href="#S4.E30" title="(30) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">30</text></ref>) looks complicated at first glance. However, the
value of (<ref labelref="LABEL:eq:5" href="#S4.E30" title="(30) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">30</text></ref>) can be efficiently calculated using dynamic programming. If we define forward message <Math mode="inline" xml:id="S4.SS1.p4.m1" tex="\alpha_{t}(k)" text="alpha _ t * k" fragid="S4.SS1.p4.m1"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p4.m1.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p4.m1.1" font="italic" fragid="S4.SS1.p4.m1.1">k</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> as the probability that the <Math mode="inline" xml:id="S4.SS1.p4.m2" tex="k" text="k" fragid="S4.SS1.p4.m2"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-th latent letter in the relevant latent word <Math mode="inline" xml:id="S4.SS1.p4.m3" tex="w_{i}" text="w _ i" fragid="S4.SS1.p4.m3"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> transits to the next latent letter at time <Math mode="inline" xml:id="S4.SS1.p4.m4" tex="t" text="t" fragid="S4.SS1.p4.m4"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math> after emitting observations, forward message <Math mode="inline" xml:id="S4.SS1.p4.m5" tex="a_{t}(k)" text="a _ t * k" fragid="S4.SS1.p4.m5"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p4.m5.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p4.m5.1" font="italic" fragid="S4.SS1.p4.m5.1">k</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> can be recursively calculated as follows:</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx9" fragid="S7.EGx9">
          <equation frefnum="(32)" refnum="32" xml:id="S4.E32" fragid="S4.E32">
            <MathFork>
              <Math xml:id="S4.E32.m3" tex="\displaystyle\alpha_{t}(k)=\sum_{d^{\prime}=1}^{t-k+1}P(d^{\prime}\mid\omega_{%&#10;w_{ik}})\prod_{t^{\prime}=0}^{d^{\prime}-1}P(y_{t-t^{\prime}}\mid\theta_{w_{ik%&#10;}})\alpha_{t-d^{\prime}-1}(k-1)" fragid="S4.E32.m3">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                    <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" xml:id="S4.E32.m3.1" font="italic" fragid="S4.E32.m3.1">k</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                      <XMTok name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                      <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                    <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\alpha_{t}(k)" xml:id="S4.E32.m1" text="alpha _ t * k" fragid="S4.E32.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.E32.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E32.m1.1" font="italic" fragid="S4.E32.m1.1">k</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\sum_{d^{\prime}=1}^{t-k+1}P(d^{\prime}\mid\omega_{w_{ik}})\prod%&#10;_{t^{\prime}=0}^{d^{\prime}-1}P(y_{t-t^{\prime}}\mid\theta_{w_{ik}})\alpha_{t-%&#10;d^{\prime}-1}(k-1)" xml:id="S4.E32.m2" fragid="S4.E32.m2">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">w</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                          <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMTok name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">w</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMTok name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(33)" refnum="33" xml:id="S4.E33" fragid="S4.E33">
            <MathFork>
              <Math xml:id="S4.E33.m3" tex="\displaystyle\alpha_{0}(0)=1" text="alpha _ 0 * 0 = 1" fragid="S4.E33.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S4.E33.m3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok meaning="0" role="NUMBER" xml:id="S4.E33.m3.1" fragid="S4.E33.m3.1">0</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\alpha_{0}(0)" xml:id="S4.E33.m1" text="alpha _ 0 * 0" fragid="S4.E33.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok>
                          <XMTok meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.E33.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E33.m1.1" fragid="S4.E33.m1.1">0</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=1" xml:id="S4.E33.m2" text="absent = 1" fragid="S4.E33.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>By applying the calculation formula shown above, backward messages <Math mode="inline" xml:id="S4.SS1.p4.m6" tex="B_{t}(i)" text="B _ t * i" fragid="S4.SS1.p4.m6"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p4.m6.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p4.m6.1" font="italic" fragid="S4.SS1.p4.m6.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> and <Math mode="inline" xml:id="S4.SS1.p4.m7" tex="B_{t}^{*}(i)" text="(B _ t) ^ * * i" fragid="S4.SS1.p4.m7"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMTok meaning="times" role="MULOP">*</XMTok></XMApp><XMDual><XMRef idref="S4.SS1.p4.m7.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="S4.SS1.p4.m7.1" font="italic" fragid="S4.SS1.p4.m7.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> can be calculated. Using the calculation procedure for backward messages, the forward sampling procedure proposed in the HDP-HSMM can be employed. The backward filtering forward sampling procedure enables the blocked Gibbs sampler to directly sample latent words from observation data without explicitly sampling latent letters in HDP-HLM.</p>
      </para>
      <para xml:id="S4.SS1.p5" fragid="S4.SS1.p5">
        <p>In the forward sampling procedure, super state <Math mode="inline" xml:id="S4.SS1.p5.m1" tex="z_{s}" text="z _ s" fragid="S4.SS1.p5.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> and its duration <Math mode="inline" xml:id="S4.SS1.p5.m2" tex="D_{s}" text="D _ s" fragid="S4.SS1.p5.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> are sampled iteratively using backward messages as follows.</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx10" fragid="S7.EGx10">
          <equation xml:id="S4.Ex4" fragid="S4.Ex4">
            <MathFork>
              <Math xml:id="S4.Ex4.m3" tex="\displaystyle P(z_{s}=i|y_{1:T},z_{s-1}=j,F_{D^{\text{sum}}_{s}}=1)=" fragid="S4.Ex4.m3">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">F</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMText>sum</XMText>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle P(z_{s}=i|y_{1:T},z_{s-1}=j,F_{D^{\text{sum}}_{s}}=1)=" xml:id="S4.Ex4.m2" fragid="S4.Ex4.m2">
                    <XMath>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">F</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMText>sum</XMText>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(34)" refnum="34" xml:id="S4.E34" fragid="S4.E34">
            <MathFork>
              <Math xml:id="S4.E34.m3" tex="\displaystyle~{}~{}~{}~{}P(z_{s}=i|z_{s-1}=j)B_{D^{\text{sum}}_{s}}(i)P(y_{D^{%&#10;\text{sum}}_{s}}|z_{s}=i)" fragid="S4.E34.m3">
                <XMath>
                  <XMTok role="UNKNOWN" rpadding="9.9pt"> </XMTok>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                    <XMTok role="UNKNOWN" font="italic">B</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                        <XMText>sum</XMText>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMText>sum</XMText>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle~{}~{}~{}~{}P(z_{s}=i|z_{s-1}=j)B_{D^{\text{sum}}_{s}}(i)P(y_{D^{%&#10;\text{sum}}_{s}}|z_{s}=i)" xml:id="S4.E34.m2" fragid="S4.E34.m2">
                    <XMath>
                      <XMTok role="UNKNOWN" rpadding="9.9pt"> </XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">j</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                        <XMTok role="UNKNOWN" font="italic">B</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">D</XMTok>
                            <XMText>sum</XMText>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMText>sum</XMText>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex5" fragid="S4.Ex5">
            <MathFork>
              <Math xml:id="S4.Ex5.m3" tex="\displaystyle P(D_{s}=d|y_{1:T},z_{s}=i,F_{D^{\text{sum}}_{s}}=1)=P(D_{s}=d)\times" fragid="S4.Ex5.m3">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="UNKNOWN" font="italic">T</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">z</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">F</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMText>sum</XMText>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="italic">D</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle P(D_{s}=d|y_{1:T},z_{s}=i,F_{D^{\text{sum}}_{s}}=1)=P(D_{s}=d)\times" xml:id="S4.Ex5.m2" fragid="S4.Ex5.m2">
                    <XMath>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">z</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">F</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMText>sum</XMText>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="italic">D</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok meaning="times" role="MULOP">×</XMTok>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(35)" refnum="35" xml:id="S4.E35" fragid="S4.E35">
            <MathFork>
              <Math xml:id="S4.E35.m3" tex="\displaystyle~{}~{}~{}~{}\frac{P(y_{D^{\text{sum}}_{s}+1:D^{\text{sum}}_{s}+d}%&#10;|D_{s}=d,z_{s}=i,F_{D^{\text{sum}}_{s}}=1)B_{D^{\text{sum}}_{s}+d}(i)}{B^{*}_{%&#10;D^{\text{sum}}_{s}}(i)}" text="  * ([P(y:+Dsums1+Dsumsd|Ds=d,zs=i,FDsums=1)B+Dsumsd(i)] / ((B ^ *) _ (D ^ [sum]) _ s * i))" fragid="S4.E35.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN" rpadding="9.9pt"> </XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                      <XMArg>
                        <XMTok role="UNKNOWN" font="italic">P</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            <XMApp>
                              <XMTok name="colon" role="METARELOP">:</XMTok>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                    <XMText>sum</XMText>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                    <XMText>sum</XMText>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">D</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">z</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">F</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                <XMText>sum</XMText>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">B</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                <XMText>sum</XMText>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMArg>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">B</XMTok>
                            <XMTok meaning="times" role="MULOP">*</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="italic">D</XMTok>
                              <XMText>sum</XMText>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.E35.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="S4.E35.m3.1" font="italic" fragid="S4.E35.m3.1">i</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle~{}~{}~{}~{}\frac{P(y_{D^{\text{sum}}_{s}+1:D^{\text{sum}}_{s}+d}%&#10;|D_{s}=d,z_{s}=i,F_{D^{\text{sum}}_{s}}=1)B_{D^{\text{sum}}_{s}+d}(i)}{B^{*}_{%&#10;D^{\text{sum}}_{s}}(i)}" xml:id="S4.E35.m2" text="  * ([P(y:+Dsums1+Dsumsd|Ds=d,zs=i,FDsums=1)B+Dsumsd(i)] / ((B ^ *) _ (D ^ [sum]) _ s * i))" fragid="S4.E35.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" rpadding="9.9pt"> </XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                          <XMArg>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                <XMApp>
                                  <XMTok name="colon" role="METARELOP">:</XMTok>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                        <XMText>sum</XMText>
                                      </XMApp>
                                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                    </XMApp>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                        <XMText>sum</XMText>
                                      </XMApp>
                                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                    </XMApp>
                                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">z</XMTok>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">F</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                    <XMText>sum</XMText>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">B</XMTok>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                    <XMText>sum</XMText>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMArg>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">B</XMTok>
                                <XMTok meaning="times" role="MULOP">*</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="italic">D</XMTok>
                                  <XMText>sum</XMText>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S4.E35.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S4.E35.m2.1" font="italic" fragid="S4.E35.m2.1">i</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" xml:id="S4.SS1.p5.m3" tex="D^{\text{sum}}_{s}=\sum_{s^{\prime}&lt;s}D_{s^{\prime}}" text="(D ^ [sum]) _ s = (sum _ (s ^ prime less s))@(D _ (s ^ prime))" fragid="S4.SS1.p5.m3"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="less-than" role="RELOP">&lt;</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>.
For further details, please refer to the original paper, in which the HDP-HSMM were introduced <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>.</p>
      </para>
    </subsection>
    <subsection refnum="4.2" xml:id="S4.SS2" fragid="S4.SS2">
      <title><tag close=" ">4.2</tag>Sampling a letter sequence for a latent word: <Math mode="inline" xml:id="S4.SS2.m1" tex="w_{i}" text="w _ i" fragid="S4.SS2.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math></title>
      <para xml:id="S4.SS2.p1" fragid="S4.SS2.p1">
        <p>The sampled <Math mode="inline" xml:id="S4.SS2.p1.m1" tex="z_{s}" text="z _ s" fragid="S4.SS2.p1.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> is only an index of a latent word. Concrete letter sequences <Math mode="inline" xml:id="S4.SS2.p1.m2" tex="w_{i}" text="w _ i" fragid="S4.SS2.p1.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> for each latent word <Math mode="inline" xml:id="S4.SS2.p1.m3" tex="i" text="i" fragid="S4.SS2.p1.m3"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> should be sampled according to the correspondence of each sub-sequence of time series data <Math mode="inline" xml:id="S4.SS2.p1.m4" tex="\bm{y}^{k}=(y^{k}_{1},y^{k}_{2},\ldots,y^{k}_{T^{k}})" text="y ^ k = vector@((y ^ k) _ 1, (y ^ k) _ 2, ldots, (y ^ k) _ (T ^ k))" fragid="S4.SS2.p1.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S4.SS2.p1.m4.2"/><XMRef idref="S4.SS2.p1.m4.3"/><XMRef idref="S4.SS2.p1.m4.1"/><XMRef idref="S4.SS2.p1.m4.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS2.p1.m4.2" fragid="S4.SS2.p1.m4.2"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S4.SS2.p1.m4.3" fragid="S4.SS2.p1.m4.3"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S4.SS2.p1.m4.1" fragid="S4.SS2.p1.m4.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S4.SS2.p1.m4.4" fragid="S4.SS2.p1.m4.4"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> to each latent word.
When a latent word <Math mode="inline" xml:id="S4.SS2.p1.m5" tex="z_{s}" text="z _ s" fragid="S4.SS2.p1.m5"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> is given, the generative model of the observation in the range of a latent word <Math mode="inline" xml:id="S4.SS2.p1.m6" tex="z_{s}" text="z _ s" fragid="S4.SS2.p1.m6"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMath></Math> can be regarded as an HDP-HSMM whose super states correspond to latent letters. Therefore, in the proposed model, each sub-sequence of observation data corresponding to a latent word can be considered an observed sequence generated by an HDP-HSMM.
If only a single sub-sequence of observations corresponds to a latent word, a latent letter sequence could be sampled using an ordinal sampling procedure in the HDP-HSMM. However, observations containing the same latent word have to share the same latent letter sequence <Math mode="inline" xml:id="S4.SS2.p1.m7" tex="w" text="w" fragid="S4.SS2.p1.m7"><XMath><XMTok role="UNKNOWN" font="italic">w</XMTok></XMath></Math>. Therefore, latent letter sequences for observations with the same latent word are simultaneously sampled, given that they have the same latent letter sequence.
We employ an approximate sampling procedure based on sampling importance resampling (SIR) <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="p_robotics" title="p_robotics">p_robotics</ref>]</cite>.</p>
      </para>
      <para xml:id="S4.SS2.p2" fragid="S4.SS2.p2">
        <p>If we define the observations sharing the same latent word as <Math mode="inline" xml:id="S4.SS2.p2.m1" tex="\bm{y}^{1:k}=\{\bm{y}^{1},\bm{y}^{2},\ldots,\bm{y}^{k}\}" text="y ^ (1 colon k) = set@(y ^ 1, y ^ 2, ldots, y ^ k)" fragid="S4.SS2.p2.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS2.p2.m1.2"/><XMRef idref="S4.SS2.p2.m1.3"/><XMRef idref="S4.SS2.p2.m1.1"/><XMRef idref="S4.SS2.p2.m1.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS2.p2.m1.2" fragid="S4.SS2.p2.m1.2"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S4.SS2.p2.m1.3" fragid="S4.SS2.p2.m1.3"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S4.SS2.p2.m1.1" fragid="S4.SS2.p2.m1.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S4.SS2.p2.m1.4" fragid="S4.SS2.p2.m1.4"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMath></Math> and the shared latent letter sequence as <Math mode="inline" xml:id="S4.SS2.p2.m2" tex="w" text="w" fragid="S4.SS2.p2.m2"><XMath><XMTok role="UNKNOWN" font="italic">w</XMTok></XMath></Math>, the posterior probability <Math mode="inline" xml:id="S4.SS2.p2.m3" tex="P(w\mid\bm{y}^{1:k})" fragid="S4.SS2.p2.m3"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> becomes</p>
        <equationgroup class="ltx_eqn_align" xml:id="S7.EGx11" fragid="S7.EGx11">
          <equation frefnum="(36)" refnum="36" xml:id="S4.E36" labels="LABEL:eq:6" fragid="S4.E36">
            <MathFork>
              <Math xml:id="S4.E36.m3" tex="\displaystyle P(w\mid\bm{y}^{1:k})\propto P(w)P(\bm{y}^{1:k}\mid w)" fragid="S4.E36.m3">
                <XMath>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" font="italic">w</XMTok>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" font="italic">w</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok role="UNKNOWN" font="italic">P</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                      <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok name="mid" role="VERTBAR">∣</XMTok>
                    <XMTok role="UNKNOWN" font="italic">w</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle P(w\mid\bm{y}^{1:k})" xml:id="S4.E36.m1" fragid="S4.E36.m1">
                    <XMath>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\propto P(w)P(\bm{y}^{1:k}\mid w)" xml:id="S4.E36.m2" fragid="S4.E36.m2">
                    <XMath>
                      <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S4.E36.m2.1" font="italic" fragid="S4.E36.m2.1">w</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                          <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR">∣</XMTok>
                        <XMTok role="UNKNOWN" font="italic">w</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation frefnum="(37)" refnum="37" xml:id="S4.E37" labels="LABEL:eq:8" fragid="S4.E37">
            <MathFork>
              <Math xml:id="S4.E37.m3" tex="\displaystyle=\underbrace{P(w\mid\bm{y}^{j})}_{sampling}\underbrace{P(\bm{y}^{%&#10;j})\prod_{i\neq j}^{k}P(\bm{y}^{i}\mid w)}_{weight}" text="absent = (underbrace@([P(w∣yj)])) _ (s * a * m * p * l * i * n * g) * (underbrace@([P(yj)∏≠ijkP(yi∣w)])) _ (w * e * i * g * h * t)" fragid="S4.E37.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok name="underbrace" role="UNDERACCENT">⏟</XMTok>
                          <XMArg>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" font="italic">w</XMTok>
                              <XMTok name="mid" role="VERTBAR">∣</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                                <XMTok role="UNKNOWN" font="italic">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMArg>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">a</XMTok>
                          <XMTok role="UNKNOWN" font="italic">m</XMTok>
                          <XMTok role="UNKNOWN" font="italic">p</XMTok>
                          <XMTok role="UNKNOWN" font="italic">l</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">n</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                        <XMApp scriptpos="mid">
                          <XMTok name="underbrace" role="UNDERACCENT">⏟</XMTok>
                          <XMArg>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                                <XMTok role="UNKNOWN" font="italic">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                            <XMApp scriptpos="mid">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid9"/>
                              <XMApp scriptpos="mid">
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid9"/>
                                <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                <XMApp>
                                  <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">j</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              </XMApp>
                              <XMTok name="mid" role="VERTBAR">∣</XMTok>
                              <XMTok role="UNKNOWN" font="italic">w</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMArg>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">w</XMTok>
                          <XMTok role="UNKNOWN" font="italic">e</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMTok role="UNKNOWN" font="italic">h</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"/>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=\underbrace{P(w\mid\bm{y}^{j})}_{sampling}\underbrace{P(\bm{y}^{%&#10;j})\prod_{i\neq j}^{k}P(\bm{y}^{i}\mid w)}_{weight}" xml:id="S4.E37.m2" text="absent = (underbrace@([P(w∣yj)])) _ (s * a * m * p * l * i * n * g) * (underbrace@([P(yj)∏≠ijkP(yi∣w)])) _ (w * e * i * g * h * t)" fragid="S4.E37.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                            <XMApp scriptpos="mid">
                              <XMTok name="underbrace" role="UNDERACCENT">⏟</XMTok>
                              <XMArg>
                                <XMTok role="UNKNOWN" font="italic">P</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">w</XMTok>
                                  <XMTok name="mid" role="VERTBAR">∣</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMArg>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">a</XMTok>
                              <XMTok role="UNKNOWN" font="italic">m</XMTok>
                              <XMTok role="UNKNOWN" font="italic">p</XMTok>
                              <XMTok role="UNKNOWN" font="italic">l</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">n</XMTok>
                              <XMTok role="UNKNOWN" font="italic">g</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid7"/>
                            <XMApp scriptpos="mid">
                              <XMTok name="underbrace" role="UNDERACCENT">⏟</XMTok>
                              <XMArg>
                                <XMTok role="UNKNOWN" font="italic">P</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">j</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                                <XMApp scriptpos="mid">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid9"/>
                                  <XMApp scriptpos="mid">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid9"/>
                                    <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                    <XMApp>
                                      <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">j</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">P</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold italic">y</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  </XMApp>
                                  <XMTok name="mid" role="VERTBAR">∣</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">w</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMArg>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">w</XMTok>
                              <XMTok role="UNKNOWN" font="italic">e</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">g</XMTok>
                              <XMTok role="UNKNOWN" font="italic">h</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" xml:id="S4.SS2.p2.m4" tex="P(\bm{y}^{j})" text="P * y ^ j" fragid="S4.SS2.p2.m4"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">P</XMTok><XMDual><XMRef idref="S4.SS2.p2.m4.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S4.SS2.p2.m4.1" fragid="S4.SS2.p2.m4.1"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> in (<ref labelref="LABEL:eq:8" href="#S4.E37" title="(37) ‣ 4.2 Sampling a letter sequence for a latent word: wi ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">37</text></ref>), representing the likelihood of the observation, can be calculated using the backward filtering procedure in the HDP-HSMM. Probability <Math mode="inline" xml:id="S4.SS2.p2.m5" tex="P(\bm{y}^{i}\mid w)" fragid="S4.SS2.p2.m5"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> can also be calculated in the same way as (<ref labelref="LABEL:eq:5" href="#S4.E30" title="(30) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">30</text></ref>) if <Math mode="inline" xml:id="S4.SS2.p2.m6" tex="w" text="w" fragid="S4.SS2.p2.m6"><XMath><XMTok role="UNKNOWN" font="italic">w</XMTok></XMath></Math> is given. The HDP-HSMM also provides a sampling procedure for <Math mode="inline" xml:id="S4.SS2.p2.m7" tex="P(w\mid\bm{y}^{j})" fragid="S4.SS2.p2.m7"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>. Therefore, if we consider <Math mode="inline" xml:id="S4.SS2.p2.m8" tex="P(w\mid\bm{y}^{j})" fragid="S4.SS2.p2.m8"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> as the proposed distribution and <Math mode="inline" xml:id="S4.SS2.p2.m9" tex="P(\bm{y}^{j})\prod_{i\neq j}^{k}P(\bm{y}^{i}\mid w)" fragid="S4.SS2.p2.m9"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok mathstyle="text" meaning="product" name="prod" role="SUMOP" scriptpos="post">∏</XMTok><XMApp><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> as a weight, the SIR procedure can be employed <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="p_robotics" title="p_robotics">p_robotics</ref>]</cite>.
Specifically, after a set of <Math mode="inline" xml:id="S4.SS2.p2.m10" tex="w" text="w" fragid="S4.SS2.p2.m10"><XMath><XMTok role="UNKNOWN" font="italic">w</XMTok></XMath></Math> are sampled from the proposed distribution <Math mode="inline" xml:id="S4.SS2.p2.m11" tex="P(w\mid\bm{y}^{j})\ j=1,2,\ldots,k" fragid="S4.SS2.p2.m11"><XMath><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="bold italic">y</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" rpadding="5.0pt" stretchy="false">)</XMTok></XMWrap><XMTok role="UNKNOWN" font="italic">j</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>, a final sample is drawn from the set with a probability proportional to each sample’s weight.
Using this procedure, the proposed model can approximately sample a latent letter sequence <Math mode="inline" xml:id="S4.SS2.p2.m12" tex="w_{i}" text="w _ i" fragid="S4.SS2.p2.m12"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> for the <Math mode="inline" xml:id="S4.SS2.p2.m13" tex="i" text="i" fragid="S4.SS2.p2.m13"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>-th latent word.</p>
      </para>
    </subsection>
    <subsection refnum="4.3" xml:id="S4.SS3" fragid="S4.SS3">
      <title><tag close=" ">4.3</tag>Sampling model parameters</title>
      <para xml:id="S4.SS3.p1" fragid="S4.SS3.p1">
        <p>After sampling latent words <Math mode="inline" xml:id="S4.SS3.p1.m1" tex="\{z_{s}\}" text="set@(z _ s)" fragid="S4.SS3.p1.m1"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m1.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m1.1" fragid="S4.SS3.p1.m1.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> for each observation data and sampling letter sequences for the latent words, other parameters can be updated.
Parameters of the language model, i.e., <Math mode="inline" xml:id="S4.SS3.p1.m2" tex="\{\pi^{LM}_{i}\}" text="set@((pi ^ (L * M)) _ i)" fragid="S4.SS3.p1.m2"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m2.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m2.1" fragid="S4.SS3.p1.m2.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> and <Math mode="inline" xml:id="S4.SS3.p1.m3" tex="\beta^{LM}" text="beta ^ (L * M)" fragid="S4.SS3.p1.m3"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math>, can be updated on the basis of latent word sequences.
Parameters of the word model, i.e., <Math mode="inline" xml:id="S4.SS3.p1.m4" tex="\{\pi^{WM}_{j}\}" text="set@((pi ^ (W * M)) _ j)" fragid="S4.SS3.p1.m4"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m4.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m4.1" fragid="S4.SS3.p1.m4.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> and <Math mode="inline" xml:id="S4.SS3.p1.m5" tex="\beta^{WM}" text="beta ^ (W * M)" fragid="S4.SS3.p1.m5"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMath></Math>, can be updated on the basis of sampled letter sequences for latent words.
Parameters for the acoustic model, i.e., <Math mode="inline" xml:id="S4.SS3.p1.m6" tex="\{\omega_{j}\}" text="set@(omega _ j)" fragid="S4.SS3.p1.m6"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m6.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m6.1" fragid="S4.SS3.p1.m6.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> and <Math mode="inline" xml:id="S4.SS3.p1.m7" tex="\{\theta_{j}\}" text="set@(theta _ j)" fragid="S4.SS3.p1.m7"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m7.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m7.1" fragid="S4.SS3.p1.m7.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math>, can be updated if each hidden state <Math mode="inline" xml:id="S4.SS3.p1.m8" tex="x_{t}" text="x _ t" fragid="S4.SS3.p1.m8"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> is determined for each <Math mode="inline" xml:id="S4.SS3.p1.m9" tex="y_{t}" text="y _ t" fragid="S4.SS3.p1.m9"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math>. During the SIR process for sampling a letter sequence, <Math mode="inline" xml:id="S4.SS3.p1.m10" tex="\{\bar{w}^{m}_{s}\}" text="set@(((bar@(w)) ^ m) _ s)" fragid="S4.SS3.p1.m10"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m10.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m10.1" fragid="S4.SS3.p1.m10.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> in Algorithm 1 are subsidiarily obtained. To accelerate the mixing rate, the subsidiary sampling results <Math mode="inline" xml:id="S4.SS3.p1.m11" tex="\{\bar{w}^{m}_{s}\}" text="set@(((bar@(w)) ^ m) _ s)" fragid="S4.SS3.p1.m11"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S4.SS3.p1.m11.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S4.SS3.p1.m11.1" fragid="S4.SS3.p1.m11.1"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> obtained in the SIR are used for updating the acoustic model parameters.
These parameters can be sampled in the same way as the HDP-HSMM. For more details, we refer to the original paper in which the HDP-HSMM were introduced <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="johnson2013" title="johnson2013">johnson2013</ref>]</cite>.
Finally, the overall sampling procedure is obtained, as described in Algorithm <ref labelref="LABEL:alg:bgibbs" href="#algorithm1" title="4.3 Sampling model parameters ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4.3</text></ref>.</p>
      </para>
      <float class="ltx_float_algorithm" placement="tb" refnum="1" xml:id="algorithm1" labels="LABEL:alg:bgibbs" fragid="algorithm1">
        <toccaption><tag close=" ">1</tag>Blocked Gibbs sampler for HDP-HLM</toccaption>
        <caption><tag close=" ">1</tag>Blocked Gibbs sampler for HDP-HLM</caption>
        <itemize>
          <item frefnum="•" refnum="1" xml:id="I1.i1" fragid="I1.i1">
            <tag>•</tag>
            <para xml:id="I1.i1.p1" fragid="I1.i1.p1">
              <p>Initialize all parameters.</p>
            </para>
          </item>
          <item frefnum="•" refnum="2" xml:id="I1.i2" fragid="I1.i2">
            <tag>•</tag>
            <para xml:id="I1.i2.p1" fragid="I1.i2.p1">
              <p>Observe <Math mode="inline" xml:id="I1.i2.p1.m1" tex="M" text="M" fragid="I1.i2.p1.m1"><XMath><XMTok role="UNKNOWN" font="italic">M</XMTok></XMath></Math> time series data <Math mode="inline" xml:id="I1.i2.p1.m2" tex="\{y^{m}_{1:T_{m}}\}_{m\in\{1,2,\ldots,M\}}" text="(set@((y ^ m) _ (1 colon T _ m))) _ (m element-of set@(1, 2, ldots, M))" fragid="I1.i2.p1.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.i2.p1.m2.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.i2.p1.m2.5" fragid="I1.i2.p1.m2.5"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.i2.p1.m2.1"/><XMRef idref="I1.i2.p1.m2.2"/><XMRef idref="I1.i2.p1.m2.3"/><XMRef idref="I1.i2.p1.m2.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok meaning="1" role="NUMBER" xml:id="I1.i2.p1.m2.1" fragid="I1.i2.p1.m2.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="I1.i2.p1.m2.2" fragid="I1.i2.p1.m2.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="I1.i2.p1.m2.3" fragid="I1.i2.p1.m2.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="I1.i2.p1.m2.4" font="italic" fragid="I1.i2.p1.m2.4">M</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.</p>
            </para>
          </item>
          <item frefnum="•" refnum="3" xml:id="I1.i3" fragid="I1.i3">
            <tag>•</tag>
            <para xml:id="I1.i3.p1" fragid="I1.i3.p1">
              <p><text font="bold">repeat</text></p>
              <itemize>
                <item frefnum="–" refnum="1" xml:id="I1.I1.i1" fragid="I1.I1.i1">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i1.p1" fragid="I1.I1.i1.p1">
                    <p><text font="bold">for</text> <Math mode="inline" xml:id="I1.I1.i1.p1.m1" tex="m=1" text="m = 1" fragid="I1.I1.i1.p1.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> to <Math mode="inline" xml:id="I1.I1.i1.p1.m2" tex="M" text="M" fragid="I1.I1.i1.p1.m2"><XMath><XMTok role="UNKNOWN" font="italic">M</XMTok></XMath></Math> <text font="bold">do</text></p>
                    <itemize>
                      <item frefnum="*" refnum="1" xml:id="I1.I1.I1.i1" fragid="I1.I1.I1.i1">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i1.p1" fragid="I1.I1.I1.i1.p1">
                          <p>// Backward filtering procedure</p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="2" xml:id="I1.I1.I1.i2" fragid="I1.I1.I1.i2">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i2.p1" fragid="I1.I1.I1.i2.p1">
                          <p>For each <Math mode="inline" xml:id="I1.I1.I1.i2.p1.m1" tex="{i\in\{1,2,\ldots,N\}}" text="i element-of set@(1, 2, ldots, N)" fragid="I1.I1.I1.i2.p1.m1"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.I1.i2.p1.m1.1"/><XMRef idref="I1.I1.I1.i2.p1.m1.2"/><XMRef idref="I1.I1.I1.i2.p1.m1.3"/><XMRef idref="I1.I1.I1.i2.p1.m1.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok meaning="1" role="NUMBER" xml:id="I1.I1.I1.i2.p1.m1.1" fragid="I1.I1.I1.i2.p1.m1.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="I1.I1.I1.i2.p1.m1.2" fragid="I1.I1.I1.i2.p1.m1.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="I1.I1.I1.i2.p1.m1.3" fragid="I1.I1.I1.i2.p1.m1.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.I1.i2.p1.m1.4" font="italic" fragid="I1.I1.I1.i2.p1.m1.4">N</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, initialize messages <Math mode="inline" xml:id="I1.I1.I1.i2.p1.m2" tex="B_{T}(i)=1" text="B _ T * i = 1" fragid="I1.I1.I1.i2.p1.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok></XMApp><XMDual><XMRef idref="I1.I1.I1.i2.p1.m2.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.I1.i2.p1.m2.1" font="italic" fragid="I1.I1.I1.i2.p1.m2.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>.</p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="3" xml:id="I1.I1.I1.i3" fragid="I1.I1.I1.i3">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i3.p1" fragid="I1.I1.I1.i3.p1">
                          <p><text font="bold">for</text> <Math mode="inline" xml:id="I1.I1.I1.i3.p1.m1" tex="t=T" text="t = T" fragid="I1.I1.I1.i3.p1.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok></XMApp></XMath></Math> to <Math mode="inline" xml:id="I1.I1.I1.i3.p1.m2" tex="1" text="1" fragid="I1.I1.I1.i3.p1.m2"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math> <text font="bold">do</text></p>
                          <itemize>
                            <item frefnum="⋅" refnum="1" xml:id="I1.I1.I1.I1.i1" fragid="I1.I1.I1.I1.i1">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I1.i1.p1" fragid="I1.I1.I1.I1.i1.p1">
                                <p>For each <Math mode="inline" xml:id="I1.I1.I1.I1.i1.p1.m1" tex="{i\in\{1,2,\ldots,N\}}" text="i element-of set@(1, 2, ldots, N)" fragid="I1.I1.I1.I1.i1.p1.m1"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.I1.I1.i1.p1.m1.1"/><XMRef idref="I1.I1.I1.I1.i1.p1.m1.2"/><XMRef idref="I1.I1.I1.I1.i1.p1.m1.3"/><XMRef idref="I1.I1.I1.I1.i1.p1.m1.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok meaning="1" role="NUMBER" xml:id="I1.I1.I1.I1.i1.p1.m1.1" fragid="I1.I1.I1.I1.i1.p1.m1.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="I1.I1.I1.I1.i1.p1.m1.2" fragid="I1.I1.I1.I1.i1.p1.m1.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="I1.I1.I1.I1.i1.p1.m1.3" fragid="I1.I1.I1.I1.i1.p1.m1.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.I1.I1.i1.p1.m1.4" font="italic" fragid="I1.I1.I1.I1.i1.p1.m1.4">N</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, compute backward messages <Math mode="inline" xml:id="I1.I1.I1.I1.i1.p1.m2" tex="B_{t-1}(i)" text="B _ (t - 1) * i" fragid="I1.I1.I1.I1.i1.p1.m2"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="I1.I1.I1.I1.i1.p1.m2.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.I1.I1.i1.p1.m2.1" font="italic" fragid="I1.I1.I1.I1.i1.p1.m2.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> and <Math mode="inline" xml:id="I1.I1.I1.I1.i1.p1.m3" tex="B_{t-1}^{*}(i)" text="(B _ (t - 1)) ^ * * i" fragid="I1.I1.I1.I1.i1.p1.m3"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">B</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok meaning="times" role="MULOP">*</XMTok></XMApp><XMDual><XMRef idref="I1.I1.I1.I1.i1.p1.m3.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.I1.I1.i1.p1.m3.1" font="italic" fragid="I1.I1.I1.I1.i1.p1.m3.1">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> using (<ref labelref="LABEL:eq:1" href="#S4.E25" title="(25) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">25</text></ref>)–(<ref labelref="LABEL:eq:4" href="#S4.E28" title="(28) ‣ 4.1 Inference of latent words: zs ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">28</text></ref>).
<!-- %**** ieee˙daa.tex Line 375 **** --></p>
                              </para>
                            </item>
                          </itemize>
                        </para>
                      </item>
                      <item frefnum="*" refnum="4" xml:id="I1.I1.I1.i4" fragid="I1.I1.I1.i4">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i4.p1" fragid="I1.I1.I1.i4.p1">
                          <p><text font="bold">end</text> <text font="bold">for</text></p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="5" xml:id="I1.I1.I1.i5" fragid="I1.I1.I1.i5">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i5.p1" fragid="I1.I1.I1.i5.p1">
                          <p>// Forward sampling procedure</p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="6" xml:id="I1.I1.I1.i6" fragid="I1.I1.I1.i6">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i6.p1" fragid="I1.I1.I1.i6.p1">
                          <p>Initialize <Math mode="inline" xml:id="I1.I1.I1.i6.p1.m1" tex="s=1" text="s = 1" fragid="I1.I1.I1.i6.p1.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="I1.I1.I1.i6.p1.m2" tex="D^{\text{sum}}_{s}=0" text="(D ^ [sum]) _ s = 0" fragid="I1.I1.I1.i6.p1.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post6"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp></XMath></Math></p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="7" xml:id="I1.I1.I1.i7" fragid="I1.I1.I1.i7">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i7.p1" fragid="I1.I1.I1.i7.p1">
                          <p><text font="bold">while</text> <Math mode="inline" xml:id="I1.I1.I1.i7.p1.m1" tex="D^{\text{sum}_{s}}&lt;T_{m}" text="D ^ ([sum] _ s) less T _ m" fragid="I1.I1.I1.i7.p1.m1"><XMath><XMApp><XMTok meaning="less-than" role="RELOP">&lt;</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMText>sum</XMText><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMApp></XMath></Math> <text font="bold">do</text></p>
                          <itemize>
                            <item frefnum="⋅" refnum="1" xml:id="I1.I1.I1.I2.i1" fragid="I1.I1.I1.I2.i1">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I2.i1.p1" fragid="I1.I1.I1.I2.i1.p1">
                                <p>// Sampling a super state representing a latent word</p>
                              </para>
                            </item>
                            <item frefnum="⋅" refnum="2" xml:id="I1.I1.I1.I2.i2" fragid="I1.I1.I1.I2.i2">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I2.i2.p1" fragid="I1.I1.I1.I2.i2.p1">
                                <p><Math mode="inline" xml:id="I1.I1.I1.I2.i2.p1.m1" tex="z_{s}\sim p(z_{s}\mid y^{m}_{1:T_{m}},z_{s-1},F_{D^{\text{sum}}_{s}}=1)" fragid="I1.I1.I1.I2.i2.p1.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post8"/><XMTok role="UNKNOWN" font="italic">T</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">F</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post8"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post8"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math></p>
                              </para>
                            </item>
                            <item frefnum="⋅" refnum="3" xml:id="I1.I1.I1.I2.i3" fragid="I1.I1.I1.I2.i3">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I2.i3.p1" fragid="I1.I1.I1.I2.i3.p1">
                                <p>// Sampling duration of the super state</p>
                              </para>
                            </item>
                            <item frefnum="⋅" refnum="4" xml:id="I1.I1.I1.I2.i4" fragid="I1.I1.I1.I2.i4">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I2.i4.p1" fragid="I1.I1.I1.I2.i4.p1">
                                <p><Math mode="inline" xml:id="I1.I1.I1.I2.i4.p1.m1" tex="D_{s}\sim p(D_{s}|z_{s},F_{D^{\text{sum}}_{s}}=1)" fragid="I1.I1.I1.I2.i4.p1.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">z</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">F</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post8"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post8"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math></p>
                              </para>
                            </item>
                            <item frefnum="⋅" refnum="5" xml:id="I1.I1.I1.I2.i5" fragid="I1.I1.I1.I2.i5">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I2.i5.p1" fragid="I1.I1.I1.I2.i5.p1">
                                <p><Math mode="inline" xml:id="I1.I1.I1.I2.i5.p1.m1" tex="D^{\text{sum}}_{s+1}\leftarrow D^{\text{sum}}_{s}+D_{s}" text="(D ^ [sum]) _ (s + 1) leftarrow (D ^ [sum]) _ s + D _ s" fragid="I1.I1.I1.I2.i5.p1.m1"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp></XMApp></XMath></Math></p>
                              </para>
                            </item>
                            <item frefnum="⋅" refnum="6" xml:id="I1.I1.I1.I2.i6" fragid="I1.I1.I1.I2.i6">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I2.i6.p1" fragid="I1.I1.I1.I2.i6.p1">
                                <p><Math mode="inline" xml:id="I1.I1.I1.I2.i6.p1.m1" tex="s\leftarrow s+1" text="s leftarrow s + 1" fragid="I1.I1.I1.I2.i6.p1.m1"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math></p>
                              </para>
                            </item>
                          </itemize>
                        </para>
                      </item>
                      <item frefnum="*" refnum="8" xml:id="I1.I1.I1.i8" fragid="I1.I1.I1.i8">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i8.p1" fragid="I1.I1.I1.i8.p1">
                          <p><text font="bold">end</text> <text font="bold">while</text></p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="9" xml:id="I1.I1.I1.i9" fragid="I1.I1.I1.i9">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i9.p1" fragid="I1.I1.I1.i9.p1">
                          <p><Math mode="inline" xml:id="I1.I1.I1.i9.p1.m1" tex="S^{m}\leftarrow s-1" text="S ^ m leftarrow s - 1" fragid="I1.I1.I1.i9.p1.m1"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="italic">S</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math></p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="10" xml:id="I1.I1.I1.i10" fragid="I1.I1.I1.i10">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i10.p1" fragid="I1.I1.I1.i10.p1">
                          <p>// Sampling a tentative latent letter sequences</p>
                        </para>
                      </item>
                      <item frefnum="*" refnum="11" xml:id="I1.I1.I1.i11" fragid="I1.I1.I1.i11">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i11.p1" fragid="I1.I1.I1.i11.p1">
                          <p><text font="bold">for</text> <Math mode="inline" xml:id="I1.I1.I1.i11.p1.m1" tex="s=1" text="s = 1" fragid="I1.I1.I1.i11.p1.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> to <Math mode="inline" xml:id="I1.I1.I1.i11.p1.m2" tex="S^{m}" text="S ^ m" fragid="I1.I1.I1.i11.p1.m2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="italic">S</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMath></Math> <text font="bold">do</text></p>
                          <itemize>
                            <item frefnum="⋅" refnum="1" xml:id="I1.I1.I1.I3.i1" fragid="I1.I1.I1.I3.i1">
                              <tag>⋅</tag>
                              <para xml:id="I1.I1.I1.I3.i1.p1" fragid="I1.I1.I1.I3.i1.p1">
                                <p><Math mode="inline" xml:id="I1.I1.I1.I3.i1.p1.m1" tex="\bar{w}^{m}_{s}\sim P(w|y^{m}_{D^{\text{sum}}_{s-1}+1:D^{\text{sum}}_{s}},\{%&#10;\pi_{j}^{WM},\omega_{j},\theta_{j}\}_{j=1,2,\ldots,J})" fragid="I1.I1.I1.I3.i1.p1.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMApp><XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok><XMTok role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post8"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post8"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post8"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post8"/><XMTok role="UNKNOWN" font="italic">D</XMTok><XMText>sum</XMText></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post7"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="I1.I1.I1.I3.i1.p1.m1.1"/><XMRef idref="I1.I1.I1.I3.i1.p1.m1.2"/><XMRef idref="I1.I1.I1.I3.i1.p1.m1.3"/><XMRef idref="I1.I1.I1.I3.i1.p1.m1.4"/></XMApp><XMWrap><XMTok meaning="1" role="NUMBER" xml:id="I1.I1.I1.I3.i1.p1.m1.1" fragid="I1.I1.I1.I3.i1.p1.m1.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="I1.I1.I1.I3.i1.p1.m1.2" fragid="I1.I1.I1.I3.i1.p1.m1.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="I1.I1.I1.I3.i1.p1.m1.3" fragid="I1.I1.I1.I3.i1.p1.m1.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.I1.I3.i1.p1.m1.4" font="italic" fragid="I1.I1.I1.I3.i1.p1.m1.4">J</XMTok></XMWrap></XMDual></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math></p>
                              </para>
                            </item>
                          </itemize>
                        </para>
                      </item>
                      <item frefnum="*" refnum="12" xml:id="I1.I1.I1.i12" fragid="I1.I1.I1.i12">
                        <tag>*</tag>
                        <para xml:id="I1.I1.I1.i12.p1" fragid="I1.I1.I1.i12.p1">
                          <p><text font="bold">end</text> <text font="bold">for</text></p>
                        </para>
                      </item>
                    </itemize>
                  </para>
                </item>
                <item frefnum="–" refnum="2" xml:id="I1.I1.i2" fragid="I1.I1.i2">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i2.p1" fragid="I1.I1.i2.p1">
                    <p><text font="bold">end</text> <text font="bold">for</text></p>
                  </para>
                </item>
                <item frefnum="–" refnum="3" xml:id="I1.I1.i3" fragid="I1.I1.i3">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i3.p1" fragid="I1.I1.i3.p1">
                    <p>// Update model parameters</p>
                  </para>
                </item>
                <item frefnum="–" refnum="4" xml:id="I1.I1.i4" fragid="I1.I1.i4">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i4.p1" fragid="I1.I1.i4.p1">
                    <p>Sample acoustic model parameters <Math mode="inline" xml:id="I1.I1.i4.p1.m1" tex="\{\omega_{j},\theta_{j}\}" text="set@(omega _ j, theta _ j)" fragid="I1.I1.i4.p1.m1"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.i4.p1.m1.1"/><XMRef idref="I1.I1.i4.p1.m1.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.I1.i4.p1.m1.1" fragid="I1.I1.i4.p1.m1.1"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok name="omega" role="UNKNOWN" font="italic">ω</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="I1.I1.i4.p1.m1.2" fragid="I1.I1.i4.p1.m1.2"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> on the basis of tentatively sampled latent letter sequences <Math mode="inline" xml:id="I1.I1.i4.p1.m2" tex="\{\bar{w}^{m}_{s}\}" text="set@(((bar@(w)) ^ m) _ s)" fragid="I1.I1.i4.p1.m2"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.i4.p1.m2.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.I1.i4.p1.m2.1" fragid="I1.I1.i4.p1.m2.1"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post5"/><XMApp><XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">s</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math>.</p>
                  </para>
                </item>
                <item frefnum="–" refnum="5" xml:id="I1.I1.i5" fragid="I1.I1.i5">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i5.p1" fragid="I1.I1.i5.p1">
                    <p>Sample language model parameter <Math mode="inline" xml:id="I1.I1.i5.p1.m1" tex="\{\pi_{i}^{LM}\},\beta^{LM}" text="list@(set@((pi _ i) ^ (L * M)), beta ^ (L * M))" fragid="I1.I1.i5.p1.m1"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="I1.I1.i5.p1.m1.1"/><XMRef idref="I1.I1.i5.p1.m1.2"/></XMApp><XMWrap><XMDual xml:id="I1.I1.i5.p1.m1.1" fragid="I1.I1.i5.p1.m1.1"><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.i5.p1.m1.1.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.I1.i5.p1.m1.1.1" fragid="I1.I1.i5.p1.m1.1.1"><XMTok role="SUPERSCRIPTOP" scriptpos="post5"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMApp xml:id="I1.I1.i5.p1.m1.2" fragid="I1.I1.i5.p1.m1.2"><XMTok role="SUPERSCRIPTOP" scriptpos="post5"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMWrap></XMDual></XMath></Math> on the basis of sampled super states , i.e., latent words.</p>
                  </para>
                </item>
                <item frefnum="–" refnum="6" xml:id="I1.I1.i6" fragid="I1.I1.i6">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i6.p1" fragid="I1.I1.i6.p1">
                    <p>Sample a word inventory <Math mode="inline" xml:id="I1.I1.i6.p1.m1" tex="\{w_{i}\}_{i=1,2,\ldots,N}" text="(set@(w _ i)) _ (i = list@(1, 2, ldots, N))" fragid="I1.I1.i6.p1.m1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.i6.p1.m1.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.I1.i6.p1.m1.5" fragid="I1.I1.i6.p1.m1.5"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="I1.I1.i6.p1.m1.1"/><XMRef idref="I1.I1.i6.p1.m1.2"/><XMRef idref="I1.I1.i6.p1.m1.3"/><XMRef idref="I1.I1.i6.p1.m1.4"/></XMApp><XMWrap><XMTok meaning="1" role="NUMBER" xml:id="I1.I1.i6.p1.m1.1" fragid="I1.I1.i6.p1.m1.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="I1.I1.i6.p1.m1.2" fragid="I1.I1.i6.p1.m1.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="I1.I1.i6.p1.m1.3" fragid="I1.I1.i6.p1.m1.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.i6.p1.m1.4" font="italic" fragid="I1.I1.i6.p1.m1.4">N</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math> using SIR procedure (see (<ref labelref="LABEL:eq:8" href="#S4.E37" title="(37) ‣ 4.2 Sampling a letter sequence for a latent word: wi ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">37</text></ref>)).</p>
                  </para>
                </item>
                <item frefnum="–" refnum="7" xml:id="I1.I1.i7" fragid="I1.I1.i7">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I1.I1.i7.p1" fragid="I1.I1.i7.p1">
                    <p>Sample a word model <Math mode="inline" xml:id="I1.I1.i7.p1.m1" tex="\{\pi_{i}^{WM}\},\beta^{WM}" text="list@(set@((pi _ i) ^ (W * M)), beta ^ (W * M))" fragid="I1.I1.i7.p1.m1"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="I1.I1.i7.p1.m1.1"/><XMRef idref="I1.I1.i7.p1.m1.2"/></XMApp><XMWrap><XMDual xml:id="I1.I1.i7.p1.m1.1" fragid="I1.I1.i7.p1.m1.1"><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.i7.p1.m1.1.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.I1.i7.p1.m1.1.1" fragid="I1.I1.i7.p1.m1.1.1"><XMTok role="SUPERSCRIPTOP" scriptpos="post5"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok name="pi" role="UNKNOWN" font="italic">π</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMApp xml:id="I1.I1.i7.p1.m1.2" fragid="I1.I1.i7.p1.m1.2"><XMTok role="SUPERSCRIPTOP" scriptpos="post5"/><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp></XMWrap></XMDual></XMath></Math> on the basis of sampled word inventory <Math mode="inline" xml:id="I1.I1.i7.p1.m2" tex="\{w_{i}\}_{i=1,2,\ldots,N}" text="(set@(w _ i)) _ (i = list@(1, 2, ldots, N))" fragid="I1.I1.i7.p1.m2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="I1.I1.i7.p1.m2.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="I1.I1.i7.p1.m2.5" fragid="I1.I1.i7.p1.m2.5"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="I1.I1.i7.p1.m2.1"/><XMRef idref="I1.I1.i7.p1.m2.2"/><XMRef idref="I1.I1.i7.p1.m2.3"/><XMRef idref="I1.I1.i7.p1.m2.4"/></XMApp><XMWrap><XMTok meaning="1" role="NUMBER" xml:id="I1.I1.i7.p1.m2.1" fragid="I1.I1.i7.p1.m2.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="I1.I1.i7.p1.m2.2" fragid="I1.I1.i7.p1.m2.2">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="I1.I1.i7.p1.m2.3" fragid="I1.I1.i7.p1.m2.3">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="I1.I1.i7.p1.m2.4" font="italic" fragid="I1.I1.i7.p1.m2.4">N</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.</p>
                  </para>
                </item>
              </itemize>
            </para>
          </item>
          <item frefnum="•" refnum="4" xml:id="I1.i4" fragid="I1.i4">
            <tag>•</tag>
            <para xml:id="I1.i4.p1" fragid="I1.i4.p1">
              <p><text font="bold">until</text> a predetermined exit condition is satisfied.</p>
            </para>
          </item>
        </itemize>
      </float>
      <!-- %**** ieee˙daa.tex Line 400 **** -->
    </subsection>
    <subsection refnum="4.4" xml:id="S4.SS4" fragid="S4.SS4">
      <title><tag close=" ">4.4</tag>NPB-DAA</title>
      <para xml:id="S4.SS4.p1" fragid="S4.SS4.p1">
        <p>Based on the generative model, HDP-HLM, and its inference algorithm shown in Algorithm <ref labelref="LABEL:alg:bgibbs" href="#algorithm1" title="4.3 Sampling model parameters ‣ 4 Inference algorithm ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4.3</text></ref>, the proposed NPB-DAA is obtained, finally.
By assuming HDP-HLM as a generative model of observed time series data, and by inferring latent variables of the model, we can analyze latent double articulation structure, i.e., hierarchically organized latent words and phonemes, of the data in an unsupervised manner. We call the novel unsupervised double articulation analyzer NPB-DAA.</p>
      </para>
    </subsection>
  </section>
  <section refnum="5" xml:id="S5" labels="LABEL:sec5" fragid="S5">
    <title><tag close=" ">5</tag>Experiment 1: Synthetic data</title>
    <para xml:id="S5.p1" fragid="S5.p1">
      <p>We conducted an experiment using a synthetic dataset that explicitly has a double articulation structure to validate our proposed method.</p>
    </para>
    <subsection refnum="5.1" xml:id="S5.SS1" fragid="S5.SS1">
      <title><tag close=" ">5.1</tag>Conditions</title>
      <para xml:id="S5.SS1.p1" fragid="S5.SS1.p1">
        <p>To validate the ability of our proposed method to infer a latent double articulation structure in time series data, we applied the proposed NPB-DAA based on the HDP-HLM to synthetic time series data.
The conventional DAA was employed as a comparative method.
The time series data are generated using five letters <Math mode="inline" xml:id="S5.SS1.p1.m1" tex="\{j\}_{j\in J}=\{1,2,3,4,5\}" text="(set@(j)) _ (j element-of J) = set@(1, 2, 3, 4, 5)" fragid="S5.SS1.p1.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S5.SS1.p1.m1.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok role="UNKNOWN" xml:id="S5.SS1.p1.m1.1" font="italic" fragid="S5.SS1.p1.m1.1">j</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMTok role="UNKNOWN" font="italic">J</XMTok></XMApp></XMApp><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S5.SS1.p1.m1.2"/><XMRef idref="S5.SS1.p1.m1.3"/><XMRef idref="S5.SS1.p1.m1.4"/><XMRef idref="S5.SS1.p1.m1.5"/><XMRef idref="S5.SS1.p1.m1.6"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m1.2" fragid="S5.SS1.p1.m1.2">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS1.p1.m1.3" fragid="S5.SS1.p1.m1.3">2</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m1.4" fragid="S5.SS1.p1.m1.4">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="4" role="NUMBER" xml:id="S5.SS1.p1.m1.5" fragid="S5.SS1.p1.m1.5">4</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m1.6" fragid="S5.SS1.p1.m1.6">5</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMath></Math> and four words <Math mode="inline" xml:id="S5.SS1.p1.m2" tex="\{w\}_{w\in W}=\{[1,3,5],[3,2],[4,1,5,2],[1,5]\}" text="(set@(w)) _ (w element-of W) = set@(list@(1, 3, 5), closed-interval@(3, 2), list@(4, 1, 5, 2), closed-interval@(1, 5))" fragid="S5.SS1.p1.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S5.SS1.p1.m2.1"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok role="UNKNOWN" xml:id="S5.SS1.p1.m2.1" font="italic" fragid="S5.SS1.p1.m2.1">w</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok></XMApp></XMApp><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S5.SS1.p1.m2.13"/><XMRef idref="S5.SS1.p1.m2.14"/><XMRef idref="S5.SS1.p1.m2.15"/><XMRef idref="S5.SS1.p1.m2.16"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMDual xml:id="S5.SS1.p1.m2.13" fragid="S5.SS1.p1.m2.13"><XMApp><XMTok meaning="list"/><XMRef idref="S5.SS1.p1.m2.2"/><XMRef idref="S5.SS1.p1.m2.3"/><XMRef idref="S5.SS1.p1.m2.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m2.2" fragid="S5.SS1.p1.m2.2">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m2.3" fragid="S5.SS1.p1.m2.3">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m2.4" fragid="S5.SS1.p1.m2.4">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m2.14" fragid="S5.SS1.p1.m2.14"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m2.5"/><XMRef idref="S5.SS1.p1.m2.6"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m2.5" fragid="S5.SS1.p1.m2.5">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS1.p1.m2.6" fragid="S5.SS1.p1.m2.6">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m2.15" fragid="S5.SS1.p1.m2.15"><XMApp><XMTok meaning="list"/><XMRef idref="S5.SS1.p1.m2.7"/><XMRef idref="S5.SS1.p1.m2.8"/><XMRef idref="S5.SS1.p1.m2.9"/><XMRef idref="S5.SS1.p1.m2.10"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="4" role="NUMBER" xml:id="S5.SS1.p1.m2.7" fragid="S5.SS1.p1.m2.7">4</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m2.8" fragid="S5.SS1.p1.m2.8">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m2.9" fragid="S5.SS1.p1.m2.9">5</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS1.p1.m2.10" fragid="S5.SS1.p1.m2.10">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m2.16" fragid="S5.SS1.p1.m2.16"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m2.11"/><XMRef idref="S5.SS1.p1.m2.12"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m2.11" fragid="S5.SS1.p1.m2.11">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m2.12" fragid="S5.SS1.p1.m2.12">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMath></Math> where <Math mode="inline" xml:id="S5.SS1.p1.m3" tex="J" text="J" fragid="S5.SS1.p1.m3"><XMath><XMTok role="UNKNOWN" font="italic">J</XMTok></XMath></Math> is a set of letters and <Math mode="inline" xml:id="S5.SS1.p1.m4" tex="W" text="W" fragid="S5.SS1.p1.m4"><XMath><XMTok role="UNKNOWN" font="italic">W</XMTok></XMath></Math> is a set of words. The four words were generated randomly.
The sequence <Math mode="inline" xml:id="S5.SS1.p1.m5" tex="w_{i}=[w_{i1},w_{i2},\ldots,w_{iL_{i}}]" text="w _ i = list@(w _ (i * 1), w _ (i * 2), ldots, w _ (i * L _ i))" fragid="S5.SS1.p1.m5"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="S5.SS1.p1.m5.2"/><XMRef idref="S5.SS1.p1.m5.3"/><XMRef idref="S5.SS1.p1.m5.1"/><XMRef idref="S5.SS1.p1.m5.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="S5.SS1.p1.m5.2" fragid="S5.SS1.p1.m5.2"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m5.3" fragid="S5.SS1.p1.m5.3"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S5.SS1.p1.m5.1" fragid="S5.SS1.p1.m5.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m5.4" fragid="S5.SS1.p1.m5.4"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMApp></XMath></Math> represents a word that is generated by combining <Math mode="inline" xml:id="S5.SS1.p1.m6" tex="\{w_{i1},w_{i2},\ldots,w_{iL_{i}}\}" text="set@(w _ (i * 1), w _ (i * 2), ldots, w _ (i * L _ i))" fragid="S5.SS1.p1.m6"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S5.SS1.p1.m6.2"/><XMRef idref="S5.SS1.p1.m6.3"/><XMRef idref="S5.SS1.p1.m6.1"/><XMRef idref="S5.SS1.p1.m6.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="S5.SS1.p1.m6.2" fragid="S5.SS1.p1.m6.2"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m6.3" fragid="S5.SS1.p1.m6.3"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S5.SS1.p1.m6.1" fragid="S5.SS1.p1.m6.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m6.4" fragid="S5.SS1.p1.m6.4"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math> sequentially where <Math mode="inline" xml:id="S5.SS1.p1.m7" tex="w_{ik}" text="w _ (i * k)" fragid="S5.SS1.p1.m7"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math> denotes the <Math mode="inline" xml:id="S5.SS1.p1.m8" tex="k" text="k" fragid="S5.SS1.p1.m8"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-th letter of <Math mode="inline" xml:id="S5.SS1.p1.m9" tex="w_{i}" text="w _ i" fragid="S5.SS1.p1.m9"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>. The durations of the letters were assumed to follow Poisson distributions and their parameters were drawn from a Gamma distribution whose parameters were <Math mode="inline" xml:id="S5.SS1.p1.m10" tex="\alpha=50,\beta=10" text="formulae@(alpha = 50, beta = 10)" fragid="S5.SS1.p1.m10"><XMath><XMDual><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p1.m10.1"/><XMRef idref="S5.SS1.p1.m10.2"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p1.m10.1" fragid="S5.SS1.p1.m10.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMTok meaning="50" role="NUMBER">50</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m10.2" fragid="S5.SS1.p1.m10.2"><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMTok meaning="10" role="NUMBER">10</XMTok></XMApp></XMWrap></XMDual></XMath></Math>. The emission distribution was assumed to be a Gaussian distribution whose parameters were <Math mode="inline" xml:id="S5.SS1.p1.m11" tex="\mu=5i,\sigma^{2}\in\{0.1,0.5,1.0\}" text="formulae@(mu = 5 * i, sigma ^ 2 element-of set@(0.1, 0.5, 1.0))" fragid="S5.SS1.p1.m11"><XMath><XMDual><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p1.m11.4"/><XMRef idref="S5.SS1.p1.m11.5"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p1.m11.4" fragid="S5.SS1.p1.m11.4"><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="5" role="NUMBER">5</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m11.5" fragid="S5.SS1.p1.m11.5"><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="S5.SS1.p1.m11.1"/><XMRef idref="S5.SS1.p1.m11.2"/><XMRef idref="S5.SS1.p1.m11.3"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok meaning="0.1" role="NUMBER" xml:id="S5.SS1.p1.m11.1" fragid="S5.SS1.p1.m11.1">0.1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="0.5" role="NUMBER" xml:id="S5.SS1.p1.m11.2" fragid="S5.SS1.p1.m11.2">0.5</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1.0" role="NUMBER" xml:id="S5.SS1.p1.m11.3" fragid="S5.SS1.p1.m11.3">1.0</XMTok><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMWrap></XMDual></XMath></Math>, where <Math mode="inline" xml:id="S5.SS1.p1.m12" tex="i" text="i" fragid="S5.SS1.p1.m12"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> represents the index of latent letters. The variance of the emission distribution was changed in stages, and the inference results were compared. Forty time series data items were generated from 20 types of latent word sequences. Sixteen of them were pairs of words in <Math mode="inline" xml:id="S5.SS1.p1.m13" tex="W" text="W" fragid="S5.SS1.p1.m13"><XMath><XMTok role="UNKNOWN" font="italic">W</XMTok></XMath></Math>, e.g., <Math mode="inline" xml:id="S5.SS1.p1.m14" tex="([1,3,5],[1,5])" text="open-interval@(list@(1, 3, 5), closed-interval@(1, 5))" fragid="S5.SS1.p1.m14"><XMath><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="S5.SS1.p1.m14.6"/><XMRef idref="S5.SS1.p1.m14.7"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMDual xml:id="S5.SS1.p1.m14.6" fragid="S5.SS1.p1.m14.6"><XMApp><XMTok meaning="list"/><XMRef idref="S5.SS1.p1.m14.1"/><XMRef idref="S5.SS1.p1.m14.2"/><XMRef idref="S5.SS1.p1.m14.3"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m14.1" fragid="S5.SS1.p1.m14.1">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m14.2" fragid="S5.SS1.p1.m14.2">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m14.3" fragid="S5.SS1.p1.m14.3">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m14.7" fragid="S5.SS1.p1.m14.7"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m14.4"/><XMRef idref="S5.SS1.p1.m14.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m14.4" fragid="S5.SS1.p1.m14.4">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m14.5" fragid="S5.SS1.p1.m14.5">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> , and <Math mode="inline" xml:id="S5.SS1.p1.m15" tex="([3,2],[3,2])" text="open-interval@(closed-interval@(3, 2), closed-interval@(3, 2))" fragid="S5.SS1.p1.m15"><XMath><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="S5.SS1.p1.m15.5"/><XMRef idref="S5.SS1.p1.m15.6"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMDual xml:id="S5.SS1.p1.m15.5" fragid="S5.SS1.p1.m15.5"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m15.1"/><XMRef idref="S5.SS1.p1.m15.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m15.1" fragid="S5.SS1.p1.m15.1">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS1.p1.m15.2" fragid="S5.SS1.p1.m15.2">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m15.6" fragid="S5.SS1.p1.m15.6"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m15.3"/><XMRef idref="S5.SS1.p1.m15.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m15.3" fragid="S5.SS1.p1.m15.3">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS1.p1.m15.4" fragid="S5.SS1.p1.m15.4">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>. Four of them were three-word sentences, e.g., <Math mode="inline" xml:id="S5.SS1.p1.m16" tex="([3,2],[1,3,5],[1,5])" text="vector@(closed-interval@(3, 2), list@(1, 3, 5), closed-interval@(1, 5))" fragid="S5.SS1.p1.m16"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S5.SS1.p1.m16.8"/><XMRef idref="S5.SS1.p1.m16.9"/><XMRef idref="S5.SS1.p1.m16.10"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMDual xml:id="S5.SS1.p1.m16.8" fragid="S5.SS1.p1.m16.8"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m16.1"/><XMRef idref="S5.SS1.p1.m16.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m16.1" fragid="S5.SS1.p1.m16.1">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS1.p1.m16.2" fragid="S5.SS1.p1.m16.2">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m16.9" fragid="S5.SS1.p1.m16.9"><XMApp><XMTok meaning="list"/><XMRef idref="S5.SS1.p1.m16.3"/><XMRef idref="S5.SS1.p1.m16.4"/><XMRef idref="S5.SS1.p1.m16.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m16.3" fragid="S5.SS1.p1.m16.3">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS1.p1.m16.4" fragid="S5.SS1.p1.m16.4">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m16.5" fragid="S5.SS1.p1.m16.5">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p1.m16.10" fragid="S5.SS1.p1.m16.10"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS1.p1.m16.6"/><XMRef idref="S5.SS1.p1.m16.7"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS1.p1.m16.6" fragid="S5.SS1.p1.m16.6">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS1.p1.m16.7" fragid="S5.SS1.p1.m16.7">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>. A sequence of latent words is represented by <Math mode="inline" xml:id="S5.SS1.p1.m17" tex="(w_{1},w_{2},\ldots,w_{n})" text="vector@(w _ 1, w _ 2, ldots, w _ n)" fragid="S5.SS1.p1.m17"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S5.SS1.p1.m17.2"/><XMRef idref="S5.SS1.p1.m17.3"/><XMRef idref="S5.SS1.p1.m17.1"/><XMRef idref="S5.SS1.p1.m17.4"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S5.SS1.p1.m17.2" fragid="S5.SS1.p1.m17.2"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m17.3" fragid="S5.SS1.p1.m17.3"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="S5.SS1.p1.m17.1" fragid="S5.SS1.p1.m17.1">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p1.m17.4" fragid="S5.SS1.p1.m17.4"><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>. Two observations were generated from each word sequence.</p>
      </para>
      <para xml:id="S5.SS1.p2" fragid="S5.SS1.p2">
        <p>We set the parameters of the NPB-DAA as follows: the hyperparameters for the latent language model were <Math mode="inline" xml:id="S5.SS1.p2.m1" tex="\gamma^{LM}=1.0,\alpha^{LM}=10.0" text="formulae@(gamma ^ (L * M) = 1.0, alpha ^ (L * M) = 10.0)" fragid="S5.SS1.p2.m1"><XMath><XMDual><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p2.m1.1"/><XMRef idref="S5.SS1.p2.m1.2"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p2.m1.1" fragid="S5.SS1.p2.m1.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p2.m1.2" fragid="S5.SS1.p2.m1.2"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, and the maximum number of words was six for weak-limit approximation. The hyperparameters for the latent word model were <Math mode="inline" xml:id="S5.SS1.p2.m2" tex="\gamma^{WM}=10.0,\alpha^{WM}=10.0" text="formulae@(gamma ^ (W * M) = 10.0, alpha ^ (W * M) = 10.0)" fragid="S5.SS1.p2.m2"><XMath><XMDual><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p2.m2.1"/><XMRef idref="S5.SS1.p2.m2.2"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p2.m2.1" fragid="S5.SS1.p2.m2.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p2.m2.2" fragid="S5.SS1.p2.m2.2"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, and the maximum number of letters was seven for weak-limit approximation. The hyperparameters of the duration distributions were set to <Math mode="inline" xml:id="S5.SS1.p2.m3" tex="\alpha=50" text="alpha = 50" fragid="S5.SS1.p2.m3"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMTok meaning="50" role="NUMBER">50</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S5.SS1.p2.m4" tex="\beta=10" text="beta = 10" fragid="S5.SS1.p2.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMTok meaning="10" role="NUMBER">10</XMTok></XMApp></XMath></Math>, and those of the emission distributions were set to <Math mode="inline" xml:id="S5.SS1.p2.m5" tex="\mu_{0}=0,\sigma^{2}_{0}=1.0,\kappa_{0}=0.01,\nu_{0}=1" text="formulae@(mu _ 0 = 0, formulae@((sigma ^ 2) _ 0 = 1.0, formulae@(kappa _ 0 = 0.01, nu _ 0 = 1)))" fragid="S5.SS1.p2.m5"><XMath><XMDual><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p2.m5.1"/><XMRef idref="S5.SS1.p2.m5.2"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p2.m5.1" fragid="S5.SS1.p2.m5.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p2.m5.2" fragid="S5.SS1.p2.m5.2"><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p2.m5.2.1"/><XMRef idref="S5.SS1.p2.m5.2.2"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p2.m5.2.1" fragid="S5.SS1.p2.m5.2.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS1.p2.m5.2.2" fragid="S5.SS1.p2.m5.2.2"><XMApp><XMTok meaning="formulae"/><XMRef idref="S5.SS1.p2.m5.2.2.1"/><XMRef idref="S5.SS1.p2.m5.2.2.2"/></XMApp><XMWrap><XMApp xml:id="S5.SS1.p2.m5.2.2.1" fragid="S5.SS1.p2.m5.2.2.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="0.01" role="NUMBER">0.01</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S5.SS1.p2.m5.2.2.2" fragid="S5.SS1.p2.m5.2.2.2"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="nu" role="UNKNOWN" font="italic">ν</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMWrap></XMDual></XMWrap></XMDual></XMWrap></XMDual></XMath></Math>. The Gibbs Sampling procedure was iterated 100 times.</p>
      </para>
      <para xml:id="S5.SS1.p3" fragid="S5.SS1.p3">
        <p>For the comparative model and conventional DAA, we set the hyperparameters of the sticky HDP-HMM to be as similar to those of the NPB-DAA as possible.</p>
      </para>
    </subsection>
    <subsection refnum="5.2" xml:id="S5.SS2" fragid="S5.SS2">
      <title><tag close=" ">5.2</tag>Results</title>
      <para xml:id="S5.SS2.p1" fragid="S5.SS2.p1">
        <p>The average log-likelihood is shown in Fig. <ref labelref="LABEL:fig:llk" href="#S5.F4" title="Figure 4 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4</text></ref>, where error bars represent the standard deviation of 30 trials. These results show that the proposed inference procedure worked appropriately, gradually sampling more probable latent variables as the iterations increased.
<!-- %**** ieee˙daa.tex Line 425 **** --></p>
      </para>
      <para xml:id="S5.SS2.p2" fragid="S5.SS2.p2">
        <p>In contrast with ordinal speech recognition tasks, the target task (language acquisition and double articulation analysis) is an unsupervised learning task. Specifically, it is a clustering task. Therefore, it is difficult to evaluate the methods’ performance from the viewpoint of precision and recall because the estimated index of a cluster and the label corresponding to the ground truth data are usually different. We evaluated the obtained result using the adjusted rand index (ARI), which quantifies the performance of a clustering task  <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="ari" title="ari">ari</ref>]</cite>.</p>
      </para>
      <para xml:id="S5.SS2.p3" fragid="S5.SS2.p3">
        <p>Table <ref labelref="LABEL:exp1_ari_letter" href="#S5.T2" title="Table 2 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">2</text></ref> shows the ARI for estimated latent letters, and
Table <ref labelref="LABEL:exp1_ari_word" href="#S5.T2" title="Table 2 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">2</text></ref> shows the ARI for estimated latent words. Although
the ARI for the latent letters obtained by conventional DAA decreases when the variance <Math mode="inline" xml:id="S5.SS2.p3.m1" tex="\sigma^{2}" text="sigma ^ 2" fragid="S5.SS2.p3.m1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> increases, that of NPB-DAA did not decrease as much. As the ARIs for latent words show, the performance of word segmentation by conventional DAA was poor, even when the ARI for latent letters was larger than <Math mode="inline" xml:id="S5.SS2.p3.m2" tex="0.8" text="0.8" fragid="S5.SS2.p3.m2"><XMath><XMTok meaning="0.8" role="NUMBER">0.8</XMTok></XMath></Math>. In contrast, the ARI for latent words estimated by NPB-DAA was over <Math mode="inline" xml:id="S5.SS2.p3.m3" tex="0.5" text="0.5" fragid="S5.SS2.p3.m3"><XMath><XMTok meaning="0.5" role="NUMBER">0.5</XMTok></XMath></Math> in all stages.
This shows that the NPB-DAA can mitigate the ill effects of phoneme recognition errors in the word segmentation task, and obtained knowledge about words can improve phoneme recognition performance.
Fig. <ref labelref="LABEL:fig:aritime" href="#S5.F5" title="Figure 5 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">5</text></ref> shows the change in ARI through iterations in the case of <Math mode="inline" xml:id="S5.SS2.p3.m4" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.SS2.p3.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>. This shows that the ARI also increased gradually while log likelihood increases, as in Fig. <ref labelref="LABEL:fig:llk" href="#S5.F4" title="Figure 4 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4</text></ref>.</p>
      </para>
      <para xml:id="S5.SS2.p4" fragid="S5.SS2.p4">
        <p>An example of estimated latent variables is shown in Fig.  <ref labelref="LABEL:fig:state1" href="#S5.F6" title="Figure 6 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">6</text></ref>, which shows the results for time series data generated from the latent word sequence <Math mode="inline" xml:id="S5.SS2.p4.m1" tex="([3,2],[1,3,5],[1,5])" text="vector@(closed-interval@(3, 2), list@(1, 3, 5), closed-interval@(1, 5))" fragid="S5.SS2.p4.m1"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S5.SS2.p4.m1.8"/><XMRef idref="S5.SS2.p4.m1.9"/><XMRef idref="S5.SS2.p4.m1.10"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMDual xml:id="S5.SS2.p4.m1.8" fragid="S5.SS2.p4.m1.8"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS2.p4.m1.1"/><XMRef idref="S5.SS2.p4.m1.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS2.p4.m1.1" fragid="S5.SS2.p4.m1.1">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.SS2.p4.m1.2" fragid="S5.SS2.p4.m1.2">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS2.p4.m1.9" fragid="S5.SS2.p4.m1.9"><XMApp><XMTok meaning="list"/><XMRef idref="S5.SS2.p4.m1.3"/><XMRef idref="S5.SS2.p4.m1.4"/><XMRef idref="S5.SS2.p4.m1.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS2.p4.m1.3" fragid="S5.SS2.p4.m1.3">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.SS2.p4.m1.4" fragid="S5.SS2.p4.m1.4">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS2.p4.m1.5" fragid="S5.SS2.p4.m1.5">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.SS2.p4.m1.10" fragid="S5.SS2.p4.m1.10"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.SS2.p4.m1.6"/><XMRef idref="S5.SS2.p4.m1.7"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.SS2.p4.m1.6" fragid="S5.SS2.p4.m1.6">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.SS2.p4.m1.7" fragid="S5.SS2.p4.m1.7">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>. The input time series data is shown at very top of the figure. The top of each panel shows the true latent letters or latent words, whereas the panel beneath shows the inferred results. The vertical axes represent the iteration of the Gibbs sampling. In Fig. <ref labelref="LABEL:fig:state1" href="#S5.F6" title="Figure 6 ‣ 5.2 Results ‣ 5 Experiment 1: Synthetic data ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">6</text></ref>, the figure in the middle shows a latent word sequence estimated using the proposed method, and the figure at the bottom shows the estimated boundaries of the latent words. These results show that the inference procedure works consistently and can estimate an adequate boundary for the latent words given the data.</p>
      </para>
      <figure frefnum="Figure 4" placement="tb" refnum="4" xml:id="S5.F4" labels="LABEL:fig:llk" fragid="S5.F4">
        <graphics candidates="llk_s1.0_.eps" graphic="llk_s1.0_.eps" options="width=411.939pt" xml:id="S5.F4.g1" class="ltx_centering" fragid="S5.F4.g1" imagesrc="x101.png" imagewidth="642" imageheight="489"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>Log-likelihood profile through Gibbs sampling (<Math mode="inline" xml:id="S5.F4.m1" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.F4.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>)</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 4</tag>Log-likelihood profile through Gibbs sampling (<Math mode="inline" xml:id="S5.F4.m2" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.F4.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>)</caption>
      </figure>
      <figure frefnum="Figure 5" placement="tb" refnum="5" xml:id="S5.F5" labels="LABEL:fig:aritime" fragid="S5.F5">
        <graphics candidates="ARITIME_s1.0.eps" graphic="ARITIME_s1.0.eps" options="width=390.258pt" xml:id="S5.F5.g1" class="ltx_centering" fragid="S5.F5.g1" imagesrc="x102.png" imagewidth="606" imageheight="417"/>
        <toccaption class="ltx_centering"><tag close=" ">5</tag>ARI profile through Gibbs sampling (<Math mode="inline" xml:id="S5.F5.m1" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.F5.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>)</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 5</tag>ARI profile through Gibbs sampling (<Math mode="inline" xml:id="S5.F5.m2" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.F5.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>)</caption>
        <!-- %**** ieee˙daa.tex Line 450 **** -->
      </figure>
      <figure frefnum="Figure 6" placement="tb!p" refnum="6" xml:id="S5.F6" labels="LABEL:fig:state1" fragid="S5.F6">
        <graphics candidates="s1_15.eps" graphic="s1_15.eps" options="width=433.62pt" xml:id="S5.F6.g1" class="ltx_centering" fragid="S5.F6.g1" imagesrc="x103.png" imagewidth="677" imageheight="1451"/>
        <!-- %“includegraphics[width=“linewidth,trim=0 0 0 0mm] –img/s1˙15/ts2.eps˝ 
     %%  “begin–minipage˝–0.32“linewidth˝
     %“vspace–-10mm˝
     %“includegraphics[width=“linewidth,trim=0 0 0 1cm] –img/s1˙15/sample˙letters˙15.eps˝
     %% “end–minipage˝
     %% “begin–minipage˝–0.32“linewidth˝
     %“centering
     %“includegraphics[width=“linewidth,trim=0 0 0 1cm]–img/s1˙15/sample˙states˙15.eps˝
     %% “end–minipage˝
     %% “begin–minipage˝–0.32“linewidth˝
     %“centering
     %“includegraphics[width=“linewidth,trim=0 0 0 1cm]–img/s1˙15/state˙boundary˙15.eps˝
     %“end–minipage˝-->
        <toccaption class="ltx_centering"><tag close=" ">6</tag>Example of inference results for sample data <Math mode="inline" xml:id="S5.F6.m1" tex="([3,2],[1,3,5],[1,5])" text="vector@(closed-interval@(3, 2), list@(1, 3, 5), closed-interval@(1, 5))" fragid="S5.F6.m1"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S5.F6.m1.8"/><XMRef idref="S5.F6.m1.9"/><XMRef idref="S5.F6.m1.10"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMDual xml:id="S5.F6.m1.8" fragid="S5.F6.m1.8"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.F6.m1.1"/><XMRef idref="S5.F6.m1.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.F6.m1.1" fragid="S5.F6.m1.1">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.F6.m1.2" fragid="S5.F6.m1.2">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.F6.m1.9" fragid="S5.F6.m1.9"><XMApp><XMTok meaning="list"/><XMRef idref="S5.F6.m1.3"/><XMRef idref="S5.F6.m1.4"/><XMRef idref="S5.F6.m1.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.F6.m1.3" fragid="S5.F6.m1.3">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.F6.m1.4" fragid="S5.F6.m1.4">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.F6.m1.5" fragid="S5.F6.m1.5">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.F6.m1.10" fragid="S5.F6.m1.10"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.F6.m1.6"/><XMRef idref="S5.F6.m1.7"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.F6.m1.6" fragid="S5.F6.m1.6">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.F6.m1.7" fragid="S5.F6.m1.7">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> and <Math mode="inline" xml:id="S5.F6.m2" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.F6.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>: (top) observation data, (upper middle) latent letters, (lower middle) latent words, and (bottom) the boundaries of latent words. Different colors denote different states.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 6</tag>Example of inference results for sample data <Math mode="inline" xml:id="S5.F6.m3" tex="([3,2],[1,3,5],[1,5])" text="vector@(closed-interval@(3, 2), list@(1, 3, 5), closed-interval@(1, 5))" fragid="S5.F6.m3"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="S5.F6.m3.8"/><XMRef idref="S5.F6.m3.9"/><XMRef idref="S5.F6.m3.10"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMDual xml:id="S5.F6.m3.8" fragid="S5.F6.m3.8"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.F6.m3.1"/><XMRef idref="S5.F6.m3.2"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.F6.m3.1" fragid="S5.F6.m3.1">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="2" role="NUMBER" xml:id="S5.F6.m3.2" fragid="S5.F6.m3.2">2</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.F6.m3.9" fragid="S5.F6.m3.9"><XMApp><XMTok meaning="list"/><XMRef idref="S5.F6.m3.3"/><XMRef idref="S5.F6.m3.4"/><XMRef idref="S5.F6.m3.5"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.F6.m3.3" fragid="S5.F6.m3.3">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="3" role="NUMBER" xml:id="S5.F6.m3.4" fragid="S5.F6.m3.4">3</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.F6.m3.5" fragid="S5.F6.m3.5">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S5.F6.m3.10" fragid="S5.F6.m3.10"><XMApp><XMTok meaning="closed-interval"/><XMRef idref="S5.F6.m3.6"/><XMRef idref="S5.F6.m3.7"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="S5.F6.m3.6" fragid="S5.F6.m3.6">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="5" role="NUMBER" xml:id="S5.F6.m3.7" fragid="S5.F6.m3.7">5</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> and <Math mode="inline" xml:id="S5.F6.m4" tex="\sigma^{2}=1.0" text="sigma ^ 2 = 1.0" fragid="S5.F6.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp></XMath></Math>: (top) observation data, (upper middle) latent letters, (lower middle) latent words, and (bottom) the boundaries of latent words. Different colors denote different states.</caption>
      </figure>
      <!-- %**** ieee˙daa.tex Line 475 **** -->
      <table frefnum="Table 2" placement="bt" refnum="2" xml:id="S5.T2" labels="LABEL:exp1_ari_letter LABEL:exp1_ari_word" fragid="S5.T2">
        <toccaption><tag close=" ">1</tag>ARI for estimated latent letters</toccaption>
        <caption><tag close=": ">Table 1</tag>ARI for estimated latent letters</caption>
        <tabular vattach="middle" class="ltx_centering ltx_guessed_headers">
          <thead>
            <tr>
              <td align="center" border="l r t" thead="column row">
                <Math mode="inline" xml:id="S5.T2.m1" tex="\sigma^{2}" text="sigma ^ 2" fragid="S5.T2.m1">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post10"/>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMath>
                </Math>
              </td>
              <td align="center" border="r t" thead="column">0.1</td>
              <td align="center" border="r t" thead="column">0.5</td>
              <td align="center" border="r t" thead="column">1.0</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" border="l r t" thead="row">
                <inline-block>
                  <p>Conventional DAA</p>
                  <p>(sticky HDP-HMM)</p>
                </inline-block>
              </td>
              <td align="center" border="r t">0.845</td>
              <td align="center" border="r t">0.832</td>
              <td align="center" border="r t">0.649</td>
            </tr>
            <tr>
              <td align="center" border="b l r t" thead="row">NPB-DAA</td>
              <td align="center" border="b r t">
                <text framed="underline">0.984</text>
              </td>
              <td align="center" border="b r t">
                <text framed="underline">0.895</text>
              </td>
              <td align="center" border="b r t">
                <text framed="underline">0.938</text>
              </td>
            </tr>
          </tbody>
        </tabular>
        <!-- %“end–table˝ 
     %“begin–table˝[bt]-->
        <toccaption><tag close=" ">2</tag>ARI for estimated latent words</toccaption>
        <caption><tag close=": ">Table 2</tag>ARI for estimated latent words</caption>
        <tabular vattach="middle" class="ltx_centering ltx_guessed_headers">
          <thead>
            <tr>
              <td align="center" border="l r t" thead="column row">
                <Math mode="inline" xml:id="S5.T2.m2" tex="\sigma^{2}" text="sigma ^ 2" fragid="S5.T2.m2">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post10"/>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMath>
                </Math>
              </td>
              <td align="center" border="r t" thead="column">
                <Math mode="inline" xml:id="S5.T2.m3" tex="0.1" text="0.1" fragid="S5.T2.m3">
                  <XMath>
                    <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                  </XMath>
                </Math>
              </td>
              <td align="center" border="r t" thead="column">
                <Math mode="inline" xml:id="S5.T2.m4" tex="0.5" text="0.5" fragid="S5.T2.m4">
                  <XMath>
                    <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                  </XMath>
                </Math>
              </td>
              <td align="center" border="r t" thead="column">
                <Math mode="inline" xml:id="S5.T2.m5" tex="1.0" text="1.0" fragid="S5.T2.m5">
                  <XMath>
                    <XMTok meaning="1.0" role="NUMBER">1.0</XMTok>
                  </XMath>
                </Math>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" border="l r t" thead="row">
                <inline-block>
                  <p>Conventional DAA</p>
                  <p>(sticky HDP-HMM + NPYLM)</p>
                </inline-block>
              </td>
              <td align="center" border="r t">0.122</td>
              <td align="center" border="r t">0.107</td>
              <td align="center" border="r t">0.125</td>
            </tr>
            <tr>
              <td align="center" border="b l r t" thead="row">NPB-DAA</td>
              <td align="center" border="b r t">
                <text framed="underline">0.594</text>
              </td>
              <td align="center" border="b r t">
                <text framed="underline">0.509</text>
              </td>
              <td align="center" border="b r t">
                <text framed="underline">0.618</text>
              </td>
            </tr>
          </tbody>
        </tabular>
      </table>
      <para xml:id="S5.SS2.p5" fragid="S5.SS2.p5">
        <p>These results show that the proposed method is a more effective machine learning method for estimating a latent double articulation structure embedded in time series data.</p>
      </para>
    </subsection>
  </section>
  <section refnum="6" xml:id="S6" labels="LABEL:sec6" fragid="S6">
    <title><tag close=" ">6</tag>Experiment 2: Continuous Japanese Vowel Speech Signal</title>
    <para xml:id="S6.p1" fragid="S6.p1">
      <p>In the second experiment, we evaluated our proposed method using Japanese vowel speech signals to test the applicability of the proposed method to actual human continuous speech signal.</p>
    </para>
    <subsection refnum="6.1" xml:id="S6.SS1" fragid="S6.SS1">
      <title><tag close=" ">6.1</tag>Conditions</title>
      <para xml:id="S6.SS1.p1" fragid="S6.SS1.p1">
        <p>We prepared 60 audio data items. We asked a female Japanese speaker to read 30 artificial sentences aloud two times at a natural speed and recorded her voice.
The 30 sentences were prepared using five words {aioi, aue, ao, ie, uo}, which consisted of five Japanese vowels {a, i, u, e, o}. By reordering the five words, we prepared 25 two-word sentences, e.g., “ao aioi,” “uo aue,” and “aioi aioi,” and five three-word sentences, i.e., “uo aue ie,” “ie ie uo,” “aue ao ie,” “ao ie ao,” and “aioi uo ie.” The set of two-word sentences consisted of all types of word pairs (<Math mode="inline" xml:id="S6.SS1.p1.m1" tex="5\times 5=25" text="5 * 5 = 25" fragid="S6.SS1.p1.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="5" role="NUMBER">5</XMTok><XMTok meaning="5" role="NUMBER">5</XMTok></XMApp><XMTok meaning="25" role="NUMBER">25</XMTok></XMApp></XMath></Math>). The set of three-word sentences were generated randomly.</p>
      </para>
      <!-- %In this experiment, two kinds of feature extraction methods were used and compared for the proposed method and the conventional DAA. One was mel-frequency cepstrum coefficients (MFCCs) which is historically used in the field of speech recognition, and the other was feature vectors extracted by deep sparse autoencoder (DSAE) which is an unsupervised deep learning method. We call the former one –“it MFCC˝ conditoin, and the later one –“it DSAE˝ condition in this section. 
     %In the –“it MFCC˝ condition,-->
      <para xml:id="S6.SS1.p2" fragid="S6.SS1.p2">
        <p>The recorded data were encoded into <Math mode="inline" xml:id="S6.SS1.p2.m1" tex="13" text="13" fragid="S6.SS1.p2.m1"><XMath><XMTok meaning="13" role="NUMBER">13</XMTok></XMath></Math>-dimensional mel-frequency cepstrum coefficient (MFCC) time series data using the HMM Toolkit (HTK) <note mark="1" role="footnote">Hidden Markov Model Toolkit: http://htk.eng.cam.ac.uk/</note>. The frame size and shift were set to <Math mode="inline" xml:id="S6.SS1.p2.m2" tex="25" text="25" fragid="S6.SS1.p2.m2"><XMath><XMTok meaning="25" role="NUMBER">25</XMTok></XMath></Math> and <Math mode="inline" xml:id="S6.SS1.p2.m3" tex="10" text="10" fragid="S6.SS1.p2.m3"><XMath><XMTok meaning="10" role="NUMBER">10</XMTok></XMath></Math> ms, respectively. Twelve-dimensional MFCC data was obtained as input data by eliminating power information from the original 13-dimensional MFCC data. As a result, 12-dimensional time series data at a frame rate of <Math mode="inline" xml:id="S6.SS1.p2.m4" tex="100" text="100" fragid="S6.SS1.p2.m4"><XMath><XMTok meaning="100" role="NUMBER">100</XMTok></XMath></Math> Hz were obtained.
<!-- %**** ieee˙daa.tex Line 525 **** --></p>
      </para>
      <!-- %In the –“it DSAE˝ condition, $3$-dimensional low-dimentional feature vectors were extracted from the extracted $13$-dimensional MFCCs using DSAE. DSAE is piled up using many sparse autoencoders (SAEs). 
     %The autoencoder (AE) is an unsupervised learnig method using a neural network. The network structure of the AE is a doublelayer completely undirected graphm and  trained to reduce reconstruction errors. An SAE is an AE whose objective function has penalty terms introducing a property to the activation pattern of the hidden layer. For more detail about the DSAE used in this experiment, please refer to “cite–liu˙iv14,liu˙cit14,Ng˙SAE˝.
     %The DSAE was trained to reduce reconstruction errors for the MFCCs.  For each layer of the neural network, hyperbolic tangent function was used as an activation function. We used five SAEs to build the DSAE, and the variation in dimensions was $13 “rightarrow 80 “rightarrow 50 “rightarrow 30 “rightarrow 10 “rightarrow 3$.-->
      <para xml:id="S6.SS1.p3" fragid="S6.SS1.p3">
        <p>The hyperparameters for the latent language model were set to <Math mode="inline" xml:id="S6.SS1.p3.m1" tex="\gamma^{LM}=10.0" text="gamma ^ (L * M) = 10.0" fragid="S6.SS1.p3.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S6.SS1.p3.m2" tex="\alpha^{LM}=10.0" text="alpha ^ (L * M) = 10.0" fragid="S6.SS1.p3.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp></XMath></Math>, and the maximum number of words was set to seven for weak-limit approximation. The hyperparameters for the latent word model were <Math mode="inline" xml:id="S6.SS1.p3.m3" tex="\gamma^{WM}=10.0" text="gamma ^ (W * M) = 10.0" fragid="S6.SS1.p3.m3"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="gamma" role="UNKNOWN" font="italic">γ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S6.SS1.p3.m4" tex="\alpha^{WM}=10.0" text="alpha ^ (W * M) = 10.0" fragid="S6.SS1.p3.m4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">M</XMTok></XMApp></XMApp><XMTok meaning="10.0" role="NUMBER">10.0</XMTok></XMApp></XMath></Math>, and the maximum number of letters was seven for weak-limit approximation. <!-- %A Poisson distribution with hyperparameters $“alpha = 30$ and $“beta = 10$ was used to model the distributions of the length of words. -->The hyperparameters of the duration distributions were set to <Math mode="inline" xml:id="S6.SS1.p3.m5" tex="\alpha=200" text="alpha = 200" fragid="S6.SS1.p3.m5"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMTok meaning="200" role="NUMBER">200</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S6.SS1.p3.m6" tex="\beta=10" text="beta = 10" fragid="S6.SS1.p3.m6"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="beta" role="UNKNOWN" font="italic">β</XMTok><XMTok meaning="10" role="NUMBER">10</XMTok></XMApp></XMath></Math>, and those of the emission distributions were set to <Math mode="inline" xml:id="S6.SS1.p3.m7" tex="\mu_{0}=0,\sigma^{2}_{0}=1.0,\kappa_{0}=0.01," text="formulae@(mu _ 0 = 0, formulae@((sigma ^ 2) _ 0 = 1.0, kappa _ 0 = 0.01))" fragid="S6.SS1.p3.m7"><XMath><XMDual punctuation=","><XMApp><XMTok meaning="formulae"/><XMRef idref="S6.SS1.p3.m7.1"/><XMRef idref="S6.SS1.p3.m7.2"/></XMApp><XMWrap><XMApp xml:id="S6.SS1.p3.m7.1" fragid="S6.SS1.p3.m7.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="mu" role="UNKNOWN" font="italic">μ</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMDual xml:id="S6.SS1.p3.m7.2" fragid="S6.SS1.p3.m7.2"><XMApp><XMTok meaning="formulae"/><XMRef idref="S6.SS1.p3.m7.2.1"/><XMRef idref="S6.SS1.p3.m7.2.2"/></XMApp><XMWrap><XMApp xml:id="S6.SS1.p3.m7.2.1" fragid="S6.SS1.p3.m7.2.1"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="1.0" role="NUMBER">1.0</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="S6.SS1.p3.m7.2.2" fragid="S6.SS1.p3.m7.2.2"><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="kappa" role="UNKNOWN" font="italic">κ</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="0.01" role="NUMBER">0.01</XMTok></XMApp></XMWrap></XMDual></XMWrap></XMDual></XMath></Math> and <Math mode="inline" xml:id="S6.SS1.p3.m8" tex="\nu_{0}=17=(" fragid="S6.SS1.p3.m8"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok name="nu" role="UNKNOWN" font="italic">ν</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok meaning="17" role="NUMBER">17</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="OPEN" stretchy="false">(</XMTok></XMath></Math>dimension<Math mode="inline" xml:id="S6.SS1.p3.m9" tex="+5)" fragid="S6.SS1.p3.m9"><XMath><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok meaning="5" role="NUMBER">5</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMath></Math>.</p>
      </para>
      <para xml:id="S6.SS1.p4" fragid="S6.SS1.p4">
        <p>For the conventional DAA, we set the hyperparameters of the sticky HDP-HMM to be as similar to those of the NPB-DAA as possible. The hyperparameters for the NPYLM used in the conventional DAA were set to <Math mode="inline" xml:id="S6.SS1.p4.m1" tex="\alpha=0.1" text="alpha = 0.1" fragid="S6.SS1.p4.m1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMTok meaning="0.1" role="NUMBER">0.1</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S6.SS1.p4.m2" tex="d=0.1" text="d = 0.1" fragid="S6.SS1.p4.m2"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="0.1" role="NUMBER">0.1</XMTok></XMApp></XMath></Math>. The Gibbs sampling procedure was iterated 100 times. With different random number seeds, 20 trials were performed.</p>
      </para>
      <para xml:id="S6.SS1.p5" fragid="S6.SS1.p5">
        <p>As a baseline method, we employed an open-source continuous speech recognition engine, Julius,<note mark="2" role="footnote">Open-Source Large Vocabulary CSR Engine Julius: http://julius.sourceforge.jp/. The Linux binary <text font="sansserif">dictation-kit-v4.3.1-linux.tgz</text> was used in this experiment. The software encodes the recorded data into 36-dimensional MFCC data including dynamic features and uses them for speech recognition. </note> which is widely used in Japanese speech recognition tasks. Julius’s acoustic model is trained by using a large number of speech data in a supervised manner. We prepared four conditions for Julius. The first one was called “Julius (phoneme + NPYLM).” In this condition, we used Julius as a phoneme recognition system by preparing a phoneme dictionary containing five Japanese vowels {a, i, u, e, o}.<note mark="3" role="footnote">In addition, Julius’s dictionary also contains silB and silE to represent silence because of its system requirements.</note> After encoding continuous speech signals into phoneme sequences using Julius as a phoneme recognizer, unsupervised morphological analysis based on the NPYLM was conducted to discover words and a language model. The second condition was called “Julius (phoneme + latticelm).” In this condition, we also used latticelm, which is an unsupervised morphological analyzer for lattice output from an ASR system. The method was proposed by Neubig et al. as an extension of Mochihashi’s NPYLM <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Neubig2012" title="Neubig2012">Neubig2012</ref>]</cite>. In this condition, the latticelm software<note mark="4" role="footnote">latticelm: http://www.phontron.com/latticelm/index.html</note> developed by Neubig et al. was used.</p>
      </para>
      <para xml:id="S6.SS1.p6" fragid="S6.SS1.p6">
        <p>In the third and fourth conditions, called “Julius (monophone + word dictionary)” and “Julius (triphone + word dictionary),” respectively. we prepared a complete word dictionary that contained all of the words that appeared in the target speech signal, i.e.,{aioi, aue, ao, ie, uo}, for Julius. This condition provides almost an upper bound for the performance of our task.
Except for in “Julius (triphone + word dictionary),” Julius uses a monophone-based acoustic model contained in the dictation kit. The acoustic model is trained in a supervised manner using a large number of labeled speech data. “Julius (triphone + word dictionary)” used a triphone-based acoustic model for comparison.</p>
      </para>
    </subsection>
    <subsection refnum="6.2" xml:id="S6.SS2" fragid="S6.SS2">
      <title><tag close=" ">6.2</tag>Results</title>
      <para xml:id="S6.SS2.p1" fragid="S6.SS2.p1">
        <p>We provided word and letter ground truth labels to all frames of the speech signal data and evaluated the relationship between the truth labels and estimated latent letter and word indices.</p>
      </para>
      <table frefnum="Table 3" placement="bt" refnum="3" xml:id="S6.T3" labels="LABEL:tbl:exp2_ari" fragid="S6.T3">
        <toccaption><tag close=" ">3</tag>ARI for estimated latent letters and words</toccaption>
        <caption><tag close=": ">Table 3</tag>ARI for estimated latent letters and words</caption>
        <tabular vattach="middle" class="ltx_centering">
          <tbody>
            <tr>
              <td align="center" border="l rr t">Method</td>
              <td align="center" border="r t">
                <inline-block>
                  <p>Letter ARI</p>
                </inline-block>
              </td>
              <td align="center" border="rr t">
                <inline-block>
                  <p>Word ARI</p>
                </inline-block>
              </td>
              <td align="center" border="r t">AM</td>
              <td align="center" border="r t">LM</td>
            </tr>
            <tr>
              <td align="center" border="l rr tt">NPB-DAA (MAP)</td>
              <td align="center" border="r tt">
                <text font="bold">0.599</text>
              </td>
              <td align="center" border="rr tt">
                <text font="bold">0.497</text>
              </td>
              <td border="r tt"/>
              <td border="r tt"/>
            </tr>
            <tr>
              <td align="center" border="l rr t">NPB-DAA</td>
              <td align="center" border="r t">0.574</td>
              <td align="center" border="rr t">0.385</td>
              <td border="r t"/>
              <td border="r t"/>
            </tr>
            <tr>
              <td align="center" border="l rr t">Conventional DAA</td>
              <td align="center" border="r t">0.584</td>
              <td align="center" border="rr t">0.072</td>
              <td border="r t"/>
              <td border="r t"/>
            </tr>
            <tr>
              <td align="center" border="l rr tt">
                <inline-block>
                  <p>Julius (phoneme dictionary</p>
                  <p>+ NPYLM)</p>
                </inline-block>
              </td>
              <td align="center" border="r tt">0.483</td>
              <td align="center" border="rr tt">0.315</td>
              <td align="center" border="r tt">✓</td>
              <td border="r tt"/>
            </tr>
            <tr>
              <td align="center" border="l rr t">
                <inline-block>
                  <p>Julius (phoneme dictionary</p>
                  <p>+ latticelm)</p>
                </inline-block>
              </td>
              <td align="center" border="r t">0.524</td>
              <td align="center" border="rr t">0.426</td>
              <td align="center" border="r t">✓</td>
              <td border="r t"/>
            </tr>
            <tr>
              <td align="center" border="l rr tt t">
                <inline-block>
                  <p>Julius (monophone</p>
                  <p>+ word dictionary)</p>
                </inline-block>
              </td>
              <td align="center" border="r tt t">0.565</td>
              <td align="center" border="rr tt t">0.548</td>
              <td align="center" border="r tt t">✓</td>
              <td align="center" border="r tt t">✓</td>
            </tr>
            <tr>
              <td align="center" border="b l rr t">
                <inline-block>
                  <p>Julius (triphone</p>
                  <p>+ word dictionary)</p>
                </inline-block>
              </td>
              <td align="center" border="b r t">0.516</td>
              <td align="center" border="b rr t">0.636</td>
              <td align="center" border="b r t">✓</td>
              <td align="center" border="b r t">✓</td>
            </tr>
          </tbody>
        </tabular>
      </table>
      <para xml:id="S6.SS2.p2" fragid="S6.SS2.p2">
        <p>The results are shown in Table <ref labelref="LABEL:tbl:exp2_ari" href="#S6.T3" title="Table 3 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">3</text></ref>. Check marks in the AM and LM columns indicate that the method used a pretrained acoustic model and given true language model, respectively.
We see that “NPB-DAA (MAP)” outperformed the conventional DAA. The results of “NPB-DAA” and “Conventional DAA” show the ARI averaged over 20 trials. In contrast, “NPB-DAA (MAP)” obtained the maximum a posteriori probability (MAP) of the 20 trials.
An advantage of the NPB-DAA is that the method can calculate the posterior probability of a given dataset after the learning phase because the NPB-DAA is derived from a generative model, i.e., HDP-HLM, which integrates the language and acoustic models. In contrast with the conventional DAA and similar methods that do not have appropriate generative models, the NPB-DAA can obtain an appropriate learning result by referring to the probability. The rows with MAP in Table <ref labelref="LABEL:tbl:exp2_ari" href="#S6.T3" title="Table 3 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">3</text></ref> show that this probability is an adequate criterion for selecting a learning result.
<!-- %**** ieee˙daa.tex Line 575 **** 
     %Fig.~“ref–fig:correration˝ shows the relationship between ARI and log likelihood in the condition--></p>
      </para>
      <para xml:id="S6.SS2.p3" fragid="S6.SS2.p3">
        <p>The results show that the NPB-DAA outperformed not only the conventional DAA but also Julius-based word discovery systems whose acoustic models were trained in supervised manner.
One reason is that the acoustic models of the DAAs were trained only from the female participant’s speech signals, in contrast, Julius’s acoustic model was trained by the speech signals of many speakers.
In other words, NPB-DAA acquired speaker-dependent acoustic model in contrast with that Julius used speaker-independent acoustic model.
This adaptation of acoustic model to the speaker must have increased the NPB-DAA’s performance.</p>
      </para>
      <para xml:id="S6.SS2.p4" fragid="S6.SS2.p4">
        <p>The results show that a naive application of the NPYLM to recognized phoneme sequences results in poor word acquisition performance, especially in conventional DAA. Because the theory of the NPYLM does not presume that letter sequences have recognition errors, the existence of phoneme recognition error deteriorates word segmentation performance. The methods that simply apply an NPYLM to obtained phoneme sequences, i.e., the conventional DAA and Julius (phoneme dictionary + NPYLM), output bad results in the word ARI compared with those of the letter ARI. However, latticelm, which presumes phoneme recognition errors to some extent, could not dramatically improve the performance of word acquisition in our experimental setting.</p>
      </para>
      <para xml:id="S6.SS2.p5" fragid="S6.SS2.p5">
        <p>In contrast, “Julius (triphone + word dictionary)” improved its word ARI performance with respect to letter ARI performance. “Julius (monophone + word dictionary)” also kept its performance high with respect to the word recognition task compared with the phoneme recognition task.
We note that the word error rate was 28.9 % and the phoneme error rate was 23.9 % in Julius (monophone + word dictionary).</p>
      </para>
      <para xml:id="S6.SS2.p6" fragid="S6.SS2.p6">
        <p>In the research field of ASR, it is widely known that a good language model improves word and phoneme recognition performance. The NPB-DAA could not improve the performance of word ARI with respect to letter ARI performance. However, it obtained an adequate language model and prevented the score of the word ARI from becoming far worse than that of the letter ARI. To achieve such an error-proof word acquisition, the direct inference of latent words are important in NPB-DAA. In the inference procedure described in Section <ref labelref="LABEL:sec3" href="#S3" title="3 Generative model ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">3</text></ref>, latent words are sampled directly without sampling latent letters while marginalizing all possible latent letter sequences. This achieves an effect similar to that of a given language model in the inference process</p>
      </para>
      <para xml:id="S6.SS2.p7" fragid="S6.SS2.p7">
        <p>Typical examples of the estimation results are shown in Table <ref labelref="LABEL:tbl:DAAresult" href="#S6.T4" title="Table 4 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4</text></ref> for NPB-DAA and conventional DAA. Each number in parentheses represents an estimated phoneme label, each space represents a phoneme boundary, each number in bold style represents a sampled index of a word, and “<Math mode="inline" xml:id="S6.SS2.p7.m1" tex="/" text="/" fragid="S6.SS2.p7.m1"><XMath><XMTok mathstyle="inline" meaning="divide" role="MULOP">/</XMTok></XMath></Math>” represents a boundary between successive words. For example, “ao ie” was divided into two words, i.e., “5 0 1” and “6 3 4 6,” in the NPB-DAA results, and their word indices were 3 and 4. In Table <ref labelref="LABEL:tbl:DAAresult" href="#S6.T4" title="Table 4 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4</text></ref>, the sampled letters corresponding to the word “ie” are underlined. Although conventional DAA could not estimate “ie” as a single word, the NPB-DAA could estimate “ie” to be a single word: “4.” In the conventional DAA results, several phoneme recognition errors can be found. The errors completely deteriorated the following chunking process, i.e., unsupervised morphological analysis using a NPYLM, as past research has frequently pointed out.
As shown in Table <ref labelref="LABEL:tbl:DAAresult" href="#S6.T4" title="Table 4 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">4</text></ref>, NPB-DAA had some phoneme recognition errors. However, in the NPB-DAA, latent words are sampled on the basis of the marginalized phoneme distribution before sampling concrete phoneme sequences. This property of the sampling procedure seemed to improve the performance of NPB-DAA.</p>
      </para>
      <table frefnum="Table 4" placement="tb" refnum="4" xml:id="S6.T4" labels="LABEL:tbl:DAAresult" fragid="S6.T4">
        <toccaption><tag close=" ">4</tag>Example word discovery results </toccaption>
        <caption><tag close=": ">Table 4</tag>Example word discovery results </caption>
        <tabular vattach="middle" class="ltx_centering ltx_guessed_headers">
          <thead>
            <tr>
              <td align="center" border="l r t" thead="column">Vowel sequence</td>
              <td align="center" border="r t" thead="column">Estimated NPB-DAA results</td>
              <td align="center" border="r t" thead="column">Estimated conventional DAA results</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" border="l r tt">ao ie</td>
              <td align="center" border="r tt"><text font="bold">3</text> (5 0 1) / <text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text></td>
              <td align="center" border="r tt"><text font="bold">226</text> (2 0 3 4 <text class="ltx_ulem_uline">1 5 4 1</text>)</td>
            </tr>
            <tr>
              <td align="center" border="l r">ao ie ao</td>
              <td align="center" border="r"><text font="bold">3</text> (5 0 1) / <text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text> / <text font="bold">3</text> (5 0 1) / <text font="bold">0</text> (6 4 6)</td>
              <td align="center" border="r"><text font="bold">494</text> (3) / <text font="bold">675</text> (2 3 0) / <text font="bold">374</text> ( <text class="ltx_ulem_uline">1 5 4 1</text> 2 0 1)</td>
            </tr>
            <tr>
              <td align="center" border="l r">aue ie</td>
              <td align="center" border="r"><text font="bold">6</text> (6 5 1 2 6 4) / <text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text></td>
              <td align="center" border="r"><text font="bold">329</text> (2 3 8 4 <text class="ltx_ulem_uline">5 4 1</text>)</td>
            </tr>
            <tr>
              <td align="center" border="l r">ie ie</td>
              <td align="center" border="r"><text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text> / <text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text></td>
              <td align="center" border="r"><text font="bold">389</text> ( <text class="ltx_ulem_uline">5 4 1 4</text> <text class="ltx_ulem_uline">1 5 4 1</text>)</td>
            </tr>
            <tr>
              <td align="center" border="l r">ie uo</td>
              <td align="center" border="r"><text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text> / <text font="bold">5</text> (5 1 2) / <text font="bold">3</text> (5 0 1) / <text font="bold">0</text> (0 6)</td>
              <td align="center" border="r"><text font="bold">401</text> ( <text class="ltx_ulem_uline">5 4 1</text> 8 0 1)</td>
            </tr>
            <tr>
              <td align="center" border="b l r">ie aioi</td>
              <td align="center" border="b r"><text class="ltx_ulem_uline"><text font="bold">4</text> (6 3 4 6)</text> / <text font="bold">1</text> (5 6 4 6 3 6 1) / <text font="bold">4</text> (6 3 4 6)</td>
              <td align="center" border="b r"><text font="bold">813</text> ( <text class="ltx_ulem_uline">5 4 1</text> 2 4 5) / <text font="bold">602</text> (4 3 0 3 4 5)</td>
            </tr>
          </tbody>
        </tabular>
      </table>
      <para xml:id="S6.SS2.p8" fragid="S6.SS2.p8">
        <p>An example of the estimated latent variables is shown in Fig.  <ref labelref="LABEL:fig:npb_example_inference" href="#S6.F7" title="Figure 7 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">7</text></ref>, which shows the results for time series data corresponding to a vowel sequence, “ao ie ao.” The input time series data, i.e., 12-dimensional MFCC time series data, are shown at the top of the figures. The middle and the bottom figures show the inference process. The top of each figure shows the true latent letters or latent words, whereas the bottom shows the inferred result. The vertical axes represent the number of Gibbs sampling iterations. This shows that the inference procedure worked for human vowel sequence data, and could estimate an adequate unit for each word.</p>
      </para>
      <figure frefnum="Figure 7" placement="tb" refnum="7" xml:id="S6.F7" labels="LABEL:fig:npb_example_inference" fragid="S6.F7">
        <graphics candidates="ao_ie_ao2.eps" graphic="ao_ie_ao2.eps" options="width=433.62pt" xml:id="S6.F7.g1" class="ltx_centering" fragid="S6.F7.g1" imagesrc="x104.png" imagewidth="676" imageheight="1205"/>
        <toccaption class="ltx_centering"><tag close=" ">7</tag>Example of inference results for “ao ie ao.” MFCC feature vectors are plotted in the top panel. The middle and bottom panels show the inference results of latent letters and latent words, respectively. Different colors denotes different states. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 7</tag>Example of inference results for “ao ie ao.” MFCC feature vectors are plotted in the top panel. The middle and bottom panels show the inference results of latent letters and latent words, respectively. Different colors denotes different states. </caption>
      </figure>
      <!-- %**** ieee˙daa.tex Line 625 **** 
     %“begin–figure˝[tb]
     %“centering
     %“includegraphics[width=0.9“linewidth]–profile/noimage.eps˝
     %“caption–Relationship between posterior probability and adjusted rand index. ˝
     %“label–fig:correration˝
     %“end–figure˝-->
    </subsection>
  </section>
  <section refnum="7" xml:id="S7" labels="LABEL:sec7" fragid="S7">
    <title><tag close=" ">7</tag>Conclusion</title>
    <para xml:id="S7.p1" fragid="S7.p1">
      <p>In this paper, we proposed NPB-DAA for direct and simultaneous acquisition of language and acoustic models from continuous speech signals in an unsupervised manner. For this purpose, we proposed an integrative generative model called the HDP-HLM by extending HDP-HSMM. Based on the generative model, we derived an inference procedure by extending the blocked Gibbs sampler originally proposed for HDP-HSMM. The method is expected to enable a developmental robot to simultaneously obtain language and acoustic models directly from continuous speech signals. To evaluate the performance of the proposed method, two experiments were performed. In the first experiment, the proposed method was applied to synthetic data, and it was shown that the method can successfully infer latent words embedded in time series data in an unsupervised manner. In the second experiment, we applied the proposed method to actual human Japanese vowel sequences. The result showed that the proposed method outperformed a conventional two-stage sequential method, conventional DAA, and a baseline ASR method.</p>
    </para>
    <para xml:id="S7.p2" fragid="S7.p2">
      <p>One of the most important challenges in our future work is to achieve complete human language acquisition from speech signals. We did not achieve complete language acquisition from speech signals that includes consonants as well as vowels in this study. Language acquisition from more natural speech signals like child-directed speech by human parents are also part of our future work. To achieve these aims, we still have two main problems: feature extraction and computational cost.</p>
    </para>
    <para xml:id="S7.p3" fragid="S7.p3">
      <p>To address these problems, more sophisticated feature extraction methods are needed. Deep learning has gained attention recently because of its impressive feature extraction performance. Integrating a deep learning method into the NPB-DAA should improve its performance.</p>
    </para>
    <para xml:id="S7.p4" fragid="S7.p4">
      <p>Computational cost is another problem. Even though the size of the
dataset used in the Experiment 2 was very small, it took approximately 240
minutes for 100 iterations using an Intel Xeon CPU E5-2650 v2 2.60 GHz, 8 cores <Math mode="inline" xml:id="S7.p4.m1" tex="\times" text="*" fragid="S7.p4.m1"><XMath><XMTok meaning="times" role="MULOP">×</XMTok></XMath></Math> 16
CPU. In particular, the computational cost of the blocked Gibbs sampler was <Math mode="inline" xml:id="S7.p4.m2" tex="O(TL_{max}d_{max}^{3}N_{max}^{2})" text="O * T * L _ (m * a * x) * (d _ (m * a * x)) ^ 3 * (N _ (m * a * x)) ^ 2" fragid="S7.p4.m2"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">O</XMTok><XMDual><XMRef idref="S7.p4.m2.1"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="S7.p4.m2.1" fragid="S7.p4.m2.1"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">T</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp><XMTok meaning="3" role="NUMBER">3</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">N</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S7.p4.m3" tex="L_{max}" text="L _ (m * a * x)" fragid="S7.p4.m3"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp></XMath></Math> is the maximum number of latent letters for a word, <Math mode="inline" xml:id="S7.p4.m4" tex="d_{max}" text="d _ (m * a * x)" fragid="S7.p4.m4"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp></XMath></Math> is the maximum duration of a word, and <Math mode="inline" xml:id="S7.p4.m5" tex="N_{max}" text="N _ (m * a * x)" fragid="S7.p4.m5"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post2"/><XMTok role="UNKNOWN" font="italic">N</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp></XMath></Math>is the maximum number of words.
To apply the proposed method to a larger dataset, improving its computational cost will be necessary.
<!-- %**** ieee˙daa.tex Line 650 **** --></p>
    </para>
    <para xml:id="S7.p5" fragid="S7.p5">
      <p>Currently, the accuracy of the language acquisition is still limited, as shown in Table <ref labelref="LABEL:tbl:exp2_ari" href="#S6.T3" title="Table 3 ‣ 6.2 Results ‣ 6 Experiment 2: Continuous Japanese Vowel Speech Signal ‣ Nonparametic Bayesian Double Articulation Analyzer for Direct Language Acquisition from Continuous Speech Signals"><text class="ltx_ref_tag">3</text></ref>. In this paper, we focused on a language acquisition method based on distributional cues and proposed a mathematical model for language acquisition. Obviously, distributional cues are not enough for more accurate language acquisition. As suggested by several computational and robotic studies, making use of co-occurrence cues improves the accuracy of language acquisition <cite class="ltx_citemacro_cite">[<ref class="ltx_missing_citation" idref="Nakamura2014" title="Nakamura2014">Nakamura2014</ref>, <ref class="ltx_missing_citation" idref="Akira2015" title="Akira2015">Akira2015</ref>, <ref class="ltx_missing_citation" idref="Taguchi2011" title="Taguchi2011">Taguchi2011</ref>]</cite>. The proposed HDP-HLM is a fully probabilistic generative model. Therefore, introducing other factors into consideration is relatively easier than for other heuristic models. This is also advantage of our approach. Combining prosodic and co-occurrence cues into the NPB-DAA, and obtaining a more accurate and more plausible constructive developmental language acquisition model is also a direction for future research.
<!-- %“section*–Acknowledgment˝ 
     %The authors would like to thank Kaede  who are an undergraduate student and Hajime Fukuda who was a graduate student at Ritsumeikan University. They helped us develop the experimental instruments for obtaining our preliminary results.--></p>
    </para>
  </section>
  <bibliography bibstyle="IEEEtran" citestyle="numbers" files="aistats14" xml:id="bib" fragid="bib">
    <title>References</title>
    <biblist xml:id="Document.L1" fragid="L1"/>
  </bibliography>
  <!-- %“begin–IEEEbiography˝[–“includegraphics[width=1in,height=1.25in,clip,keepaspectratio]–˝˝] 
     %–Tadahiro~Taniguchi˝ received ME and PhD degrees from Kyoto University in 2003 and 2006, respectively. From April 2005 to March 2006, he was a Japan Society for the Promotion of Science (JSPS) research fellow (DC2) in the Department of Mechanical Engineering and Science, Graduate School of Engineering, Kyoto University. From April 2006 to March 2007, he was a JSPS research fellow (PD) in the same department. From April 2007 to March 2008, he was a JSPS research fellow in the Department of Systems Science, Graduate School of Informatics, Kyoto University. From April 2008 to March 2010, he was an assistant professor at the Department of Human and Computer Intelligence, Ritsumeikan University. Since April 2010, he has been an associate professor in the same department. He has been engaged in research on machine learning, emergent systems, and semiotics.
     %“end–IEEEbiography˝
     %“begin–IEEEbiography˝[–“includegraphics[width=1in,height=1.25in,clip,keepaspectratio]–˝˝]
     %–Shogo~Nagasaka˝ received BE and ME degree in information science and engineering from Ritsumeikan University in 2012 and 2014, respectively. His current research interests include time series analysis, machine learning, and emergent systems.
     %“end–IEEEbiography˝
     %“begin–IEEEbiography˝[–“includegraphics[width=1in,height=1.25in,clip,keepaspectratio]–˝˝]
     %–Ryo~Nakashima˝ received a BE degree in information science and
     %engineering from Ritsumeikan University in 2014. His current research
     %interests include machine learning and language acquisition.
     %“end–IEEEbiography˝-->
</document>
